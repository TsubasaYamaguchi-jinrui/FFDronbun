[["index.html", "Fission-fusion dynamics in B1 troop 本稿の目的", " Fission-fusion dynamics in B1 troop Tsubasa Yamaguchi 2023-12-11 本稿の目的 宮城県金華山島B1群では、2019年以降第一位オス「タイヨウ(TY)」と第二位オス「イツモ(IT)」が群れを頻繁に出入りするというニホンザルでは特異な行動が観察され、それに伴って群れの離合集散が頻繁に生じている可能性が報告されている(Yamaguchi &amp; Kazahari, 2022; 山口飛翔, 2020, 2022, 2023a, 2023b)。しかし、こうした報告は全て事例報告に基づくものであり、群れの離合集散が実際にオスの出入りによるものなのかを知るためには、それ以外の要因の影響も考慮したうえで定量的に分析を行うことが必要である。そこで本稿では、オスとメスの出欠データをそのほかの要因（メスの属性、オスとの親密度、オスからメスへの攻撃頻度など）と共に定量的に分析することで、B1群で生じている群れの離合集散動態の要因を明らかにすることを目的とする。本稿はこちらからみられる。 図0.1: B1群で観察された離合集散事例（Yamaguchi &amp; Kazahari, 2022） References Yamaguchi, T., &amp; Kazahari, N. (2022). Fission–fusion dynamics in a wild group of japanese macaques (macaca fuscata) on kinkazan island caused by the repeated separation of an alpha male being followed by females. Primates, 63(6), 575–582. 山口飛翔. (2020). 金華山の野生ニホンザル・交尾期における第一位オスの特異な行動. 宮城県のニホンザル, 34, 1–25. 山口飛翔. (2022). 金華山のサル・2020 年交尾期における B₁ 群中心オスの動向. 宮城県のニホンザル, 35, 1–12. 山口飛翔. (2023a). 金華山のサル・B₁ 群の第一位オス 「タイヨウ」 の略歴. 宮城県のニホンザル, 36, 1–5. 山口飛翔. (2023b). 金華山のサル・d 群に 2 日間以上追随した B₁ 群の特異な集団. 宮城県のニホンザル, 36, 6–13. "],["01_library.html", "0. パッケージの読み込み", " 0. パッケージの読み込み 本稿はRの基本操作とtidyverseパッケージによるデータハンドリングができることを前提としている。tidyverseパッケージを用いたデータ処理については、以下の書籍などを参照。 R for Data Science (Wickham &amp; Grolemund, 2016) 電子書籍, 日本語 R Graphics Coocbook 2nd Edition (Chang, 2018) 電子書籍, 日本語 RユーザのためのRstudio[実践]入門~tidyverseによるモダンな分析フローの世界 改訂2版 (松村 et al., 2021) 出版社サイト 使用するパッケージは以下のとおりである。 ## データハンドリング library(tidyverse) library(readxl) library(knitr) library(easystats) library(DT) library(scales) ## モデリング library(brms) library(rstan) library(rstanarm) library(cmdstanr) library(ggeffects) library(DHARMa) library(DHARMa.helpers) ## ネットワーク分析 library(sna) library(ANTs) library(asnipe) library(aninet) library(vegan) library(igraph) library(tidygraph) library(ggraph) ## グラフや表関連 library(ggforce) library(ggbeeswarm) library(plotly) library(bayesplot) library(viridis) library(ggnewscale) library(GGally) library(flextable) library(ggrepel) library(patchwork) library(kableExtra) library(ggsci) library(lemon) library(ggsignif) # ## フォント関連 library(extrafont) require(systemfonts) require(fontregisterer) # ベイズモデルの設定 rstan_options(auto_write = TRUE) options(mc.cores = parallel::detectCores()) References Chang, W. (2018). R graphics cookbook: Practical recipes for visualizing data. “O’Reilly Media, Inc.” Wickham, H., &amp; Grolemund, G. (2016). R for data science: Import, tidy, transform, visualize, and model data. “O’Reilly Media, Inc.” 松村優哉., 湯谷啓明., 紀ノ定保礼., &amp; 前田和. (2021). RユーザのためのRstudio[実践]入門 tidyverseによるモダンな分析フローの世界 改訂2版. 技術評論社. "],["02_Basicdata.html", "1 データの読み込み 1.1 Daily data の読み込み 1.2 個体追跡データの読み込み 1.3 群れの詳細な出欠データを読み込む 1.4 オスの攻撃データを読み込む", " 1 データの読み込み 以下、基本的なデータの読み込みを行う。なお、本論文で使用するのはた8つの期間（2018交尾期、2019非交尾期、2019交尾期、2020非交尾期、2020交尾期、2021非交尾期、2021交尾期、2022非交尾期）のデータである。 1.1 Daily data の読み込み 以下、日ベースのデータについてデータフレームを作成する。 なお、**には観察年の下2桁と交尾期(m)/非交尾期(nm)が入る。 base_**: 追跡時間や気温についての情報。 female_**: 各メスの確認の有無と発情の有無、年齢など（分派集団で確認された個体も含む） male_**: 各オスの確認の有無 female_all: 全期間をまとめたメスの確認状況 male_all: 全期間をまとめたオスの確認状況 1.2 個体追跡データの読み込み 以下では、個体追跡の生データとして、以下のデータシートを読み込む。 focal_18m: 2018年交尾期の個体追跡データ focal_19m: 2019年交尾期の個体追跡データ focal_20m: 2020年交尾期の個体追跡データ focal_21m: 2021年交尾期の個体追跡データ focal_19nm: 2019年非交尾期の個体追跡データ focal_21nm: 2021年非交尾期の個体追跡データ focal_22nm: 2022年非交尾期の個体追跡データ focal_combined: 全個体追跡データを結合したもの 1.3 群れの詳細な出欠データを読み込む 1日に2つ以上の集団を確認した日を含めて、群れ個体の詳細な出欠データを読み込む。 5歳以上のメスと群れオスの確認状況のデータが記録されている(2018年度は6歳以上のメス)。 以下のデータを読み込んで加工する。 なお、**には観察年の下2桁と交尾期(m)/非交尾期(nm)が入る。 group_**: 観察した各集団における個体の確認状況と観察時間 group_all: 全てのデータを結合 1.4 オスの攻撃データを読み込む 以下、全生起サンプリングによって収集した生データを読み込む。 agg_m**: 各交尾期のデータ aggression_all: 全交尾期のデータ "],["03_CSI_female.html", "2 メス同士のCSIの算出 2.1 CSIの定義 2.2 データの加工 2.3 CSIの算出(全期間) 2.4 CSIの算出(2018交尾期～2019交尾期) 2.5 CSIの算出(Tam生存前まで) 2.6 CSIの算出(調査期間ごと)", " 2 メス同士のCSIの算出 2.1 CSIの定義 ここでは、TYとのCSIを算出する。 CSIの算出式は以下の通り。なお、\\(i = 1,2,3,...,N\\)はメスのIDを表す。\\(P_i\\)の算出の際には互いに毛づくろいしているポイントは除いた。対象としたのは2018年時点で6歳以上だった非発情の個体である。 \\(G_{ij}\\): メスiとメスjの毛づくろい時間割合 (iとjが毛づくろいしたポイント数/iとj総ポイント数) \\(P_{i}\\): メスiとメスjの近接時間割合 (3m以内にいとjがいたポイント数/iまたはjが地上採食または休息したポイント数) \\(\\overline{G}: \\frac{1}{N} \\sum^{N}_{i=1}G_{i}\\) \\(\\overline{P}: \\frac{1}{N} \\sum^{N}_{i=1}P_{i}\\) \\[ CSI_{i} = \\frac{\\left(\\frac{G_{i}}{\\overline{G}} +\\frac{P_{i}}{\\overline{P}}\\right)}{2} \\;\\;(i = 1,2,\\dots,N) \\] 使用するのは2018年交尾期、2019年交尾期、2019年非交尾期、2021年非交尾期、2022年非交尾期のデータである。 2.2 データの加工 交尾期のデータについて、追跡個体が発情しているかの列を追加し、発情していない日のデータのみを抽出する(focal_18m_b、focal_19m_b)。 focal_18m %&gt;% left_join(female_18m %&gt;% rename(subject = femaleID) %&gt;% select(date, subject, rs2) , by = c(&quot;date&quot;, &quot;subject&quot;)) %&gt;% filter(rs2 == &quot;0&quot;) -&gt; focal_18m_b focal_19m %&gt;% left_join(female_19m %&gt;% rename(subject = femaleID) %&gt;% select(date, subject, rs2) , by = c(&quot;date&quot;, &quot;subject&quot;)) %&gt;% filter(rs2 == &quot;0&quot;) -&gt; focal_19m_b 2.3 CSIの算出(全期間) 算出するメスのIDは、全期間のデータがあった以下の通り。 femaleID &lt;- sort(c(&quot;Kil&quot;,&quot;Mik&quot;,&quot;Koh&quot;,&quot;Aka&quot;,&quot;Ten&quot;,&quot;Ntr&quot;,&quot;Hen&quot;,&quot;Hot&quot;,&quot;Tot&quot;,&quot;Mei&quot;,&quot;Ako&quot;,&quot;Kol&quot;,&quot;Mal&quot;,&quot;Kit&quot;,&quot;Kun&quot;)) 2.3.1 毛づくろい時間割合の算出 focal_all &lt;- bind_rows(focal_18m_b, focal_19m_b, focal_19nm, focal_21nm, focal_22nm) ## 毛づくろい相手を表す列を作成 focal_all %&gt;% mutate(groom = ifelse(groomer == subject,groomee,groomer), groom2 = ifelse(groomer2 == subject,groomee2,groomer2)) -&gt; focal_all_b 各メスの追跡時間(総瞬間サンプリングポイント数)を算出する。 focal_all_b %&gt;% filter(subject %in% femaleID) %&gt;% group_by(subject) %&gt;% summarise(dur = n()) -&gt; focal_duration 対象となるメスと毛づくろいしていたポイントを抽出する。 focal_all_b %&gt;% filter(activity == &quot;G&quot;) %&gt;% filter(subject %in% femaleID) %&gt;% select(date, no_focal, time, subject, groom, groom2) %&gt;% pivot_longer(cols = c(&quot;groom&quot;,&quot;groom2&quot;), names_to = &quot;groom&quot;, values_to = &quot;ID&quot;) %&gt;% filter(ID %in% femaleID) -&gt; groom_pairs 最後に、毛づくろい時間割合を算出してマトリックスにする。 groom_mat &lt;- df.to.mat(groom_pairs, actor = &quot;subject&quot;, receiver = &quot;ID&quot;, sym = T, tob = focal_duration$dur) 2.3.2 近接時間割合の算出 続いて、近接時間割合を算出する。なお、互いに毛づくろいをしていた時間は除く点は注意が必要である。 まず、地上採食・休息・毛づくろいのポイントのみを抽出する。 focal_all_b %&gt;% filter(activity %in% c(&quot;F&quot;,&quot;R&quot;,&quot;G&quot;) &amp; T_G == &quot;G&quot;) %&gt;% select(no_focal, subject, x0_1m:x1_3m, groom, groom2, study_period) %&gt;% replace_na(list(groom = &quot;NA&quot;, groom2 = &quot;NA&quot;)) -&gt; focal_prox 続いて、上記のうち各メス同士が毛づくろいをしていなかったポイント数を算出する(= 分母)。 prox_denom &lt;- matrix(nrow = length(femaleID), ncol = length(femaleID)) for(i in seq_along(femaleID)){ for(j in seq_along(femaleID)){ prox_denom[i,j] &lt;- focal_prox %&gt;% filter(subject == femaleID[i]) %&gt;% filter(groom != femaleID[j] &amp; groom2 != femaleID[j]) %&gt;% nrow() } } ## 転置行列と足す prox_denom2 &lt;- prox_denom + t(prox_denom) ## 対角成分は0にする diag(prox_denom2) &lt;- 0 rownames(prox_denom2) &lt;- femaleID colnames(prox_denom2) &lt;- femaleID 続いて、各メスが毛づくろいをしていなかったポイントのうち近接していたポイント数を算出する。 prox_numer &lt;- matrix(nrow = length(femaleID), ncol = length(femaleID)) for(i in seq_along(femaleID)){ for(j in seq_along(femaleID)){ prox_numer[i,j] &lt;- focal_prox %&gt;% filter(subject == femaleID[i]) %&gt;% filter(groom != femaleID[j] &amp; groom2 != femaleID[j]) %&gt;% filter(str_detect(x0_1m, femaleID[j])|str_detect(x1_3m, femaleID[j])) %&gt;% nrow() } } ## 転置行列と足す prox_numer2 &lt;- prox_numer + t(prox_numer) ## 対角成分は0にする rownames(prox_numer2) &lt;- femaleID colnames(prox_numer2) &lt;- femaleID 最後に、これらを基に近接時間割合を算出する。 prox_mat &lt;- prox_numer2/prox_denom2 diag(prox_mat) &lt;- 0 2.3.3 CSIの算出 最後に、CSIを算出する。ここでは、aninetパッケージのdyadic_csi()関数を用いる。 library(aninet) CSI_female &lt;- dyadic_csi(list(groom_mat, prox_mat)) colnames(CSI_female) &lt;- femaleID rownames(CSI_female) &lt;- femaleID CSIを図示すると以下のようになる。 CSI_female %&gt;% data.frame() %&gt;% rownames_to_column(var = &quot;ID1&quot;) %&gt;% pivot_longer(2:16, names_to = &quot;ID2&quot;, values_to = &quot;CSI&quot;) %&gt;% ggplot(aes(x = ID1, y = ID2))+ geom_tile(aes(fill = CSI))+ scale_fill_gradient2(high = muted(&quot;blue&quot;), low = muted(&quot;red&quot;), mid = &quot;white&quot;, midpoint = 1)+ theme(aspect.ratio = 1)+ labs(x = &quot;&quot;, y = &quot;&quot;) 2.4 CSIの算出(2018交尾期～2019交尾期) 算出するメスのIDは、この期間のデータがあった以下の通り。 femaleID2 &lt;- sort(c(&quot;Kil&quot;,&quot;Mik&quot;,&quot;Koh&quot;,&quot;Aka&quot;,&quot;Tam&quot;,&quot;Ten&quot;,&quot;Ntr&quot;,&quot;Hen&quot;,&quot;Hot&quot;,&quot;Tot&quot;,&quot;Mei&quot;,&quot;Ako&quot;,&quot;Kol&quot;,&quot;Mal&quot;,&quot;Kit&quot;,&quot;Kun&quot;)) 2.4.1 毛づくろい時間割合の算出 focal_fh &lt;- bind_rows(focal_18m_b, focal_19m_b, focal_19nm) ## 毛づくろい相手を表す列を作成 focal_fh %&gt;% mutate(groom = ifelse(groomer == subject,groomee,groomer), groom2 = ifelse(groomer2 == subject,groomee2,groomer2)) -&gt; focal_fh_b 各メスの追跡時間(総瞬間サンプリングポイント数)を算出する。 focal_fh_b %&gt;% filter(subject %in% femaleID2) %&gt;% group_by(subject) %&gt;% summarise(dur = n()) -&gt; focal_duration_fh 対象となるメスと毛づくろいしていたポイントを抽出する。 focal_fh_b %&gt;% filter(activity == &quot;G&quot;) %&gt;% filter(subject %in% femaleID2) %&gt;% select(date, no_focal, time, subject, groom, groom2) %&gt;% pivot_longer(cols = c(&quot;groom&quot;,&quot;groom2&quot;), names_to = &quot;groom&quot;, values_to = &quot;ID&quot;) %&gt;% filter(ID %in% femaleID2) -&gt; groom_pairs_fh 最後に、毛づくろい時間割合を算出してマトリックスにする。 groom_mat_fh &lt;- df.to.mat(groom_pairs_fh, actor = &quot;subject&quot;, receiver = &quot;ID&quot;, sym = T, tob = focal_duration_fh$dur) 2.4.2 近接時間割合の算出 続いて、近接時間割合を算出する。なお、互いに毛づくろいをしていた時間は除く点は注意が必要である。 まず、地上採食・休息・毛づくろいのポイントのみを抽出する。 focal_fh_b %&gt;% filter(activity %in% c(&quot;F&quot;,&quot;R&quot;,&quot;G&quot;) &amp; T_G == &quot;G&quot;) %&gt;% select(no_focal, subject, x0_1m:x1_3m, groom, groom2, study_period) %&gt;% replace_na(list(groom = &quot;NA&quot;, groom2 = &quot;NA&quot;)) -&gt; focal_prox_fh 続いて、上記のうち各メス同士が毛づくろいをしていなかったポイント数を算出する(= 分母)。 prox_denom_fh &lt;- matrix(nrow = length(femaleID2), ncol = length(femaleID2)) for(i in seq_along(femaleID2)){ for(j in seq_along(femaleID2)){ prox_denom_fh[i,j] &lt;- focal_prox_fh %&gt;% filter(subject == femaleID2[i]) %&gt;% filter(groom != femaleID2[j] &amp; groom2 != femaleID2[j]) %&gt;% nrow() } } ## 転置行列と足す prox_denom_fh2 &lt;- prox_denom_fh + t(prox_denom_fh) ## 対角成分は0にする diag(prox_denom_fh2) &lt;- 0 rownames(prox_denom_fh2) &lt;- femaleID2 colnames(prox_denom_fh2) &lt;- femaleID2 続いて、各メスが毛づくろいをしていなかったポイントのうち近接していたポイント数を算出する。 prox_numer_fh &lt;- matrix(nrow = length(femaleID2), ncol = length(femaleID2)) for(i in seq_along(femaleID2)){ for(j in seq_along(femaleID2)){ prox_numer_fh[i,j] &lt;- focal_prox_fh %&gt;% filter(subject == femaleID2[i]) %&gt;% filter(groom != femaleID2[j] &amp; groom2 != femaleID2[j]) %&gt;% filter(str_detect(x0_1m, femaleID2[j])|str_detect(x1_3m, femaleID2[j])) %&gt;% nrow() } } ## 転置行列と足す prox_numer_fh2 &lt;- prox_numer_fh + t(prox_numer_fh) ## 対角成分は0にする rownames(prox_numer_fh2) &lt;- femaleID2 colnames(prox_numer_fh2) &lt;- femaleID2 最後に、これらを基に近接時間割合を算出する。 prox_mat_fh &lt;- prox_numer_fh2/prox_denom_fh2 diag(prox_mat_fh) &lt;- 0 2.4.3 CSIの算出 最後に、CSIを算出する。ここでは、aninetパッケージのdyadic_csi()関数を用いる。 library(aninet) CSI_fh_female &lt;- dyadic_csi(list(groom_mat_fh, prox_mat_fh)) colnames(CSI_fh_female) &lt;- femaleID2 rownames(CSI_fh_female) &lt;- femaleID2 CSIを図示すると以下のようになる。 CSI_fh_female %&gt;% data.frame() %&gt;% rownames_to_column(var = &quot;ID1&quot;) %&gt;% pivot_longer(2:16, names_to = &quot;ID2&quot;, values_to = &quot;CSI&quot;) %&gt;% ggplot(aes(x = ID1, y = ID2))+ geom_tile(aes(fill = CSI))+ scale_fill_gradient2(high = muted(&quot;blue&quot;), low = muted(&quot;red&quot;), mid = &quot;white&quot;, midpoint = 1)+ theme(aspect.ratio = 1)+ labs(x = &quot;&quot;, y = &quot;&quot;) 2.5 CSIの算出(Tam生存前まで) 算出するメスのIDは、この期間のデータがあった以下の通り。 femaleID2 &lt;- sort(c(&quot;Kil&quot;,&quot;Mik&quot;,&quot;Koh&quot;,&quot;Aka&quot;,&quot;Tam&quot;,&quot;Ten&quot;,&quot;Ntr&quot;,&quot;Hen&quot;,&quot;Hot&quot;,&quot;Tot&quot;,&quot;Mei&quot;,&quot;Ako&quot;,&quot;Kol&quot;,&quot;Mal&quot;,&quot;Kit&quot;,&quot;Kun&quot;)) 2.5.1 毛づくろい時間割合の算出 focal_withTam &lt;- bind_rows(focal_18m_b, focal_19m_b, focal_19nm, focal_20m, focal_21nm) %&gt;% mutate(date = as_date(date)) %&gt;% filter(date &lt;= &quot;2021-03-14&quot;) ## 毛づくろい相手を表す列を作成 focal_withTam %&gt;% mutate(groom = ifelse(groomer == subject,groomee,groomer), groom2 = ifelse(groomer2 == subject,groomee2,groomer2)) -&gt; focal_withTam_b 各メスの追跡時間(総瞬間サンプリングポイント数)を算出する。 focal_withTam_b %&gt;% filter(subject %in% femaleID2) %&gt;% group_by(subject) %&gt;% summarise(dur = n()) -&gt; focal_duration_withTam 対象となるメスと毛づくろいしていたポイントを抽出する。 focal_withTam_b %&gt;% filter(activity == &quot;G&quot;) %&gt;% filter(subject %in% femaleID2) %&gt;% select(date, no_focal, time, subject, groom, groom2) %&gt;% pivot_longer(cols = c(&quot;groom&quot;,&quot;groom2&quot;), names_to = &quot;groom&quot;, values_to = &quot;ID&quot;) %&gt;% filter(ID %in% femaleID2) -&gt; groom_pairs_withTam 最後に、毛づくろい時間割合を算出してマトリックスにする。 groom_mat_withTam &lt;- df.to.mat(groom_pairs_withTam, actor = &quot;subject&quot;, receiver = &quot;ID&quot;, sym = T, tob = focal_duration_withTam$dur) 2.5.2 近接時間割合の算出 続いて、近接時間割合を算出する。なお、互いに毛づくろいをしていた時間は除く点は注意が必要である。 まず、地上採食・休息・毛づくろいのポイントのみを抽出する。 focal_withTam_b %&gt;% filter(activity %in% c(&quot;F&quot;,&quot;R&quot;,&quot;G&quot;) &amp; T_G == &quot;G&quot;) %&gt;% select(no_focal, subject, x0_1m:x1_3m, groom, groom2, study_period) %&gt;% replace_na(list(groom = &quot;NA&quot;, groom2 = &quot;NA&quot;)) -&gt; focal_prox_withTam 続いて、上記のうち各メス同士が毛づくろいをしていなかったポイント数を算出する(= 分母)。 prox_denom_withTam &lt;- matrix(nrow = length(femaleID2), ncol = length(femaleID2)) for(i in seq_along(femaleID2)){ for(j in seq_along(femaleID2)){ prox_denom_withTam[i,j] &lt;- focal_prox_withTam %&gt;% filter(subject == femaleID2[i]) %&gt;% filter(groom != femaleID2[j] &amp; groom2 != femaleID2[j]) %&gt;% nrow() } } ## 転置行列と足す prox_denom_withTam2 &lt;- prox_denom_withTam + t(prox_denom_withTam) ## 対角成分は0にする diag(prox_denom_withTam2) &lt;- 0 rownames(prox_denom_withTam2) &lt;- femaleID2 colnames(prox_denom_withTam2) &lt;- femaleID2 続いて、各メスが毛づくろいをしていなかったポイントのうち近接していたポイント数を算出する。 prox_numer_withTam &lt;- matrix(nrow = length(femaleID2), ncol = length(femaleID2)) for(i in seq_along(femaleID2)){ for(j in seq_along(femaleID2)){ prox_numer_withTam[i,j] &lt;- focal_prox_withTam %&gt;% filter(subject == femaleID2[i]) %&gt;% filter(groom != femaleID2[j] &amp; groom2 != femaleID2[j]) %&gt;% filter(str_detect(x0_1m, femaleID2[j])|str_detect(x1_3m, femaleID2[j])) %&gt;% nrow() } } ## 転置行列と足す prox_numer_withTam2 &lt;- prox_numer_withTam + t(prox_numer_withTam) ## 対角成分は0にする rownames(prox_numer_withTam2) &lt;- femaleID2 colnames(prox_numer_withTam2) &lt;- femaleID2 最後に、これらを基に近接時間割合を算出する。 prox_mat_withTam &lt;- prox_numer_withTam2/prox_denom_withTam2 diag(prox_mat_withTam) &lt;- 0 2.5.3 CSIの算出 最後に、CSIを算出する。ここでは、aninetパッケージのdyadic_csi()関数を用いる。 library(aninet) CSI_withTam_female &lt;- dyadic_csi(list(groom_mat_withTam, prox_mat_withTam)) colnames(CSI_withTam_female) &lt;- femaleID2 rownames(CSI_withTam_female) &lt;- femaleID2 CSIを図示すると以下のようになる。 CSI_withTam_female %&gt;% data.frame() %&gt;% rownames_to_column(var = &quot;ID1&quot;) %&gt;% pivot_longer(2:16, names_to = &quot;ID2&quot;, values_to = &quot;CSI&quot;) %&gt;% ggplot(aes(x = ID1, y = ID2))+ geom_tile(aes(fill = CSI))+ scale_fill_gradient2(high = muted(&quot;blue&quot;), low = muted(&quot;red&quot;), mid = &quot;white&quot;, midpoint = 1)+ theme(aspect.ratio = 1)+ labs(x = &quot;&quot;, y = &quot;&quot;) 2.6 CSIの算出(調査期間ごと) 2.6.1 毛づくろい時間割合の算出 各メスの追跡時間(総瞬間サンプリングポイント数)を算出する。 focal_all_b %&gt;% filter(subject %in% femaleID) %&gt;% group_by(subject, study_period) %&gt;% summarise(dur = n()) -&gt; focal_duration_sp 対象となるメスと毛づくろいしていたポイントを抽出する。 focal_all_b %&gt;% filter(activity == &quot;G&quot;) %&gt;% filter(subject %in% femaleID) %&gt;% select(date, no_focal, time, subject, groom, groom2, study_period) %&gt;% pivot_longer(cols = c(&quot;groom&quot;,&quot;groom2&quot;), names_to = &quot;groom&quot;, values_to = &quot;ID&quot;) %&gt;% filter(ID %in% femaleID) -&gt; groom_pairs 最後に、毛づくろい時間割合を算出してマトリックスにする。 groom_mat_sp &lt;- list() sp &lt;- unique(groom_pairs$study_period) for(i in c(1,2,3,5)){ groom_mat_sp[[i]] &lt;- df.to.mat(groom_pairs %&gt;% filter(study_period == sp[i]), actor = &quot;subject&quot;, receiver = &quot;ID&quot;, sym = T, tob = focal_duration_sp %&gt;% filter(study_period == sp[i]) %&gt;%.$dur) } ## 2021非交尾期はホタルがfemaleIDに含まれるメスと毛づくろいをしなかったので、別に求める。 groom_mat_sp[[4]] &lt;- df.to.mat(groom_pairs %&gt;% filter(study_period == sp[4]), actor = &quot;subject&quot;, receiver = &quot;ID&quot;, sym = T, tob = focal_duration_sp %&gt;% filter(study_period == sp[4]) %&gt;% filter(subject != &quot;Hot&quot;) %&gt;% .$dur) ## ホタルの行列を追加 groom_mat_sp[[4]] %&gt;% data.frame() %&gt;% bind_rows(data.frame(row.names = &quot;Hot&quot;)) %&gt;% mutate(Hot = 0L)-&gt; groom_mat_sp4 ## 行名と列名を並べ替え groom_mat_sp4[15,1:15] &lt;- 0 groom_mat_sp[[4]] &lt;- groom_mat_sp4 %&gt;% as.matrix() groom_mat_sp[[4]] &lt;- groom_mat_sp[[4]][sort(rownames(groom_mat_sp[[4]])),sort(colnames(groom_mat_sp[[4]]))] 2.6.2 近接時間割合の算出 続いて、近接時間割合を算出する。なお、互いに毛づくろいをしていた時間は除く点は注意が必要である。 続いて、上記のうち各メス同士が毛づくろいをしていなかったポイント数を算出する(= 分母)。 mat &lt;- matrix(nrow = length(femaleID), ncol = length(femaleID)) prox_denom_sp &lt;- list(mat,mat,mat,mat,mat) prox_denom_sp2 &lt;- list(mat,mat,mat,mat,mat) for(i in seq_along(sp)){ for(j in seq_along(femaleID)){ for(k in seq_along(femaleID)) prox_denom_sp[[i]][j,k] &lt;- focal_prox %&gt;% filter(study_period == sp[i]) %&gt;% filter(subject == femaleID[j]) %&gt;% filter(groom != femaleID[k] &amp; groom2 != femaleID[k]) %&gt;% nrow() diag(prox_denom_sp[[i]]) &lt;- 0 rownames(prox_denom_sp[[i]]) &lt;- femaleID colnames(prox_denom_sp[[i]]) &lt;- femaleID prox_denom_sp2[[i]] &lt;- prox_denom_sp[[i]] + t(prox_denom_sp[[i]]) } } 続いて、各メスが毛づくろいをしていなかったポイントのうち近接していたポイント数を算出する。 prox_numer_sp &lt;- list(mat,mat,mat,mat,mat) prox_numer_sp2 &lt;- list(mat,mat,mat,mat,mat) for(i in seq_along(sp)){ for(j in seq_along(femaleID)){ for(k in seq_along(femaleID)) prox_numer_sp[[i]][j,k] &lt;- focal_prox %&gt;% filter(study_period == sp[i]) %&gt;% filter(subject == femaleID[j]) %&gt;% filter(groom != femaleID[k] &amp; groom2 != femaleID[k]) %&gt;% filter(str_detect(x0_1m, femaleID[k])|str_detect(x1_3m, femaleID[k])) %&gt;% nrow() diag(prox_numer_sp[[i]]) &lt;- 0 rownames(prox_numer_sp[[i]]) &lt;- femaleID colnames(prox_numer_sp[[i]]) &lt;- femaleID prox_numer_sp2[[i]] &lt;- prox_numer_sp[[i]] + t(prox_numer_sp[[i]]) } } 最後に、これらを基に近接時間割合を算出する。 prox_mat_sp &lt;- list(mat,mat,mat,mat,mat) for(i in seq_along(sp)){ prox_mat_sp[[i]] &lt;- prox_numer_sp2[[i]]/prox_denom_sp2[[i]] diag(prox_mat_sp[[i]]) &lt;- 0 } 2.6.3 CSIの算出 最後に、CSIを算出する。ここでは、aninetパッケージのdyadic_csi()関数を用いる。 library(aninet) CSI_sp_female &lt;- list(mat,mat,mat,mat,mat) for(i in seq_along(sp)){ CSI_sp_female[[i]] &lt;- dyadic_csi(list(groom_mat_sp[[i]], prox_mat_sp[[i]])) colnames(CSI_sp_female[[i]]) &lt;- femaleID rownames(CSI_sp_female[[i]]) &lt;- femaleID } CSIを図示すると以下のようになる。 CSI_sp_df &lt;- data.frame() for(i in seq_along(sp)){ CSI_df &lt;- CSI_sp_female[[i]] %&gt;% data.frame() %&gt;% rownames_to_column(var = &quot;ID1&quot;) %&gt;% pivot_longer(2:16, names_to = &quot;ID2&quot;, values_to = &quot;CSI&quot;) %&gt;% mutate(study_period = sp[i]) CSI_sp_df &lt;- bind_rows(CSI_sp_df, CSI_df) } CSI_sp_df %&gt;% ggplot(aes(x = ID1, y = ID2))+ geom_tile(aes(fill = CSI))+ scale_fill_gradient2(high = muted(&quot;blue&quot;), low = muted(&quot;red&quot;), mid = &quot;white&quot;, midpoint = 1)+ theme(aspect.ratio = 1, axis.text.x = element_text(angle = -45, size = 7), axis.text.y = element_text(angle = -45, size = 7))+ labs(x = &quot;&quot;, y = &quot;&quot;)+ facet_rep_wrap(~study_period, repeat.tick.labels = TRUE) 各調査期間のCSIマトリックス間の相関は以下の通り。 # r &lt;- matrix(ncol = 5, nrow = 5) # # for(i in seq_along(sp)){ # for(j in seq_along(sp)){ # result &lt;- mantel(CSI_sp_female[[i]], CSI_sp_female[[j]]) # r[i,j] &lt;- result$statistic # } # } # # rownames(r) &lt;- sp # colnames(r) &lt;- sp # # r "],["04_CSI_TY.html", "3 TY・ITとメスのCSIの計算 3.1 CSIの定義 3.2 TYとメスのCSIの算出 3.3 ITとメスのCSIの算出", " 3 TY・ITとメスのCSIの計算 3.1 CSIの定義 ここでは、TY・ITとのCSIを算出する。 算出方法は Yamaguchi &amp; Kazahari (2022) に従う。CSIの算出式は以下の通り。なお、\\(i = 1,2,3,...,N\\)はメスのIDを表す。\\(P_i\\)の算出の際にはTY/ITと毛づくろいしているポイントは除いた。対象としたのは2018年時点で5歳以上だった非発情の個体である。 \\(G_{i}\\): メスiとTY/ITの毛づくろい時間割合 (TYと毛づくろいしたポイント数/総ポイント数) \\(P_{i}\\): メスiとTY/ITの近接時間割合 (3m以内にTYがいたポイント数/地上採食または休息したポイント数) \\(\\overline{G}: \\frac{1}{N} \\sum^{N}_{i=1}G_{i}\\) \\(\\overline{P}: \\frac{1}{N} \\sum^{N}_{i=1}P_{i}\\) \\[ CSI_{i} = \\frac{\\left(\\frac{G_{i}}{\\overline{G}} +\\frac{P_{i}}{\\overline{P}}\\right)}{2} \\;\\;(i = 1,2,\\dots,N) \\] 使用するのは2018年交尾期、2019年交尾期、2019年非交尾期、2021年非交尾期、2022年非交尾期のデータである。 3.2 TYとメスのCSIの算出 3.2.1 データの読み込みと加工 まずは、TYの出入りがあった2019年交尾期、2021年非交尾期についてTYが確認できた時間帯のデータを読み込む。 TY_19m &lt;- read_excel(&quot;../Data/data/2019mating/2019mating_raw.xlsx&quot;, sheet = &quot;male_presence_long&quot;) %&gt;% filter(maleID == &quot;TY&quot;) %&gt;% mutate_at(5:6, ~make_datetime(year(date), month(date), mday(date), hour(.),minute(.))) %&gt;% mutate(date = as_date(date)) %&gt;% ## 分派集団にいるときは除く filter(groupID != 41 &amp; groupID != 53 &amp; groupID != 54) TY_21nm &lt;- read_excel(&quot;../Data/data/2021nonmating/2021nonmating_raw.xlsx&quot;, sheet = &quot;male_presence_long&quot;) %&gt;% filter(maleID == &quot;TY&quot;) %&gt;% mutate_at(5:6, ~make_datetime(year(date), month(date), mday(date), hour(.),minute(.))) %&gt;% mutate(date = as_date(date)) 上記2つの期間の個体追跡データに、各個体追跡セッション中にTYが確認できていたかを表す列を追加し、TYが確認できたものだけを抽出する(focal_19m_b、focal_21nm_b)。 focal_19m %&gt;% distinct(no_focal, date, start_time, fin_time) %&gt;% left_join(TY_19m %&gt;% select(date, male_presence, first, last), by = &quot;date&quot;) %&gt;% ## 個体追跡セッション中にTYが確認されていたか mutate(TY = ifelse((first &lt;= start_time &amp; last &gt;= fin_time)| (first &gt;= start_time &amp; first &lt;= fin_time)| (last &gt;= start_time &amp; last &lt;= fin_time), 1, 0)) %&gt;% replace_na(list(TY = 0)) -&gt; focal_19m_TY focal_19m %&gt;% left_join(focal_19m_TY %&gt;% select(no_focal, TY), by = &quot;no_focal&quot;) %&gt;% filter(TY == &quot;1&quot;) -&gt; focal_19m_TY_b focal_21nm %&gt;% distinct(no_focal, date, start_time, fin_time) %&gt;% left_join(TY_21nm %&gt;% select(date, male_presence, first, last), by = &quot;date&quot;) %&gt;% ## 個体追跡セッション中にTYが確認されていたか mutate(TY = ifelse((first &lt;= start_time &amp; last &gt;= fin_time)| (first &gt;= start_time &amp; first &lt;= fin_time)| (last &gt;= start_time &amp; last &lt;= fin_time), 1, 0)) %&gt;% replace_na(list(TY = 0)) -&gt; focal_21nm_TY focal_21nm %&gt;% left_join(focal_21nm_TY %&gt;% select(no_focal, TY), by = &quot;no_focal&quot;) %&gt;% filter(TY == &quot;1&quot;) -&gt; focal_21nm_TY_b 交尾期のデータについて、追跡個体が発情しているかの列を追加し、発情していない日のデータのみを抽出する(focal_18m_TY_b、focal_19m_TY_b)。 focal_18m %&gt;% left_join(female_18m %&gt;% rename(subject = femaleID) %&gt;% select(date, subject, rs2) , by = c(&quot;date&quot;, &quot;subject&quot;)) %&gt;% filter(rs2 == &quot;0&quot;) -&gt; focal_18m_TY_b focal_19m_TY_b %&gt;% left_join(female_19m %&gt;% rename(subject = femaleID) %&gt;% select(date, subject, rs2) , by = c(&quot;date&quot;, &quot;subject&quot;)) %&gt;% filter(rs2 == &quot;0&quot;) -&gt; focal_19m_TY_b 3.2.2 CSIの算出(全調査期間) 3.2.2.1 毛づくろい時間割合の算出 算出のためにデータを加工する。 ## 全期間を結合 focal_all_TY &lt;- bind_rows(focal_18m_TY_b, focal_19m_TY_b, focal_19nm, focal_21nm_TY_b, focal_22nm) ## 毛づくろい相手を表す列を追加 focal_all_TY %&gt;% mutate(groom = ifelse(groomer == subject,groomee,groomer), groom2 = ifelse(groomer2 == subject,groomee2,groomer2)) -&gt; focal_all_TY_b 各メスの追跡時間(総瞬間サンプリングポイント数)を算出する。 focal_all_TY_b %&gt;% group_by(subject) %&gt;% summarise(dur = n()) %&gt;% ungroup()-&gt; focal_duration_TY 各個体のTYとの毛づくろい時間を算出する。 focal_all_TY_b %&gt;% filter(groom == &quot;TY&quot;|groom2 == &quot;TY&quot;) %&gt;% group_by(subject) %&gt;% summarise(no_groom = n()) %&gt;% ungroup()-&gt; no_groom_TY 最後に、毛づくろい時間割合を算出する。 left_join(focal_duration_TY, no_groom_TY, by = &quot;subject&quot;) %&gt;% replace_na(list(no_groom = 0)) %&gt;% mutate(prop_groom = no_groom/dur) -&gt; prop_groom_TY 3.2.2.2 近接時間割合 地上採食/地上休息・毛づくろい時にTYが3m以内にいた時間割合を算出する。 まずは、地上採食/地上休息・毛づくろいのデータのみを抽出する。また、TYと毛づくろいしているポイントは除外する。 focal_all_TY_b %&gt;% filter(activity %in% c(&quot;F&quot;,&quot;R&quot;,&quot;G&quot;) &amp; T_G == &quot;G&quot;) %&gt;% select(no_focal, subject, x0_1m:x1_3m, groom, groom2, study_period) %&gt;% replace_na(list(groom = &quot;NA&quot;, groom2 = &quot;NA&quot;)) %&gt;% filter(!(groom == &quot;TY&quot;|groom2 == &quot;TY&quot;)) -&gt; focal_prox_TY 分母を算出する。なお、TYと毛づくろいしていたポイントは分母に含まないものとする。 focal_prox_TY %&gt;% group_by(subject) %&gt;% summarise(dur = n()) %&gt;% ungroup() -&gt; prox_duration_TY TYと3m以内に近接していたポイント数を算出する。 focal_prox_TY %&gt;% filter(str_detect(x0_1m, &quot;TY&quot;)|str_detect(x1_3m, &quot;TY&quot;)) %&gt;% group_by(subject) %&gt;% summarise(no_prox = n()) %&gt;% ungroup() -&gt; no_prox_TY 最後に、近接時間割合を算出する。 left_join(prox_duration_TY, no_prox_TY, by = &quot;subject&quot;) %&gt;% mutate(prop_prox = no_prox/dur) -&gt; prop_prox_TY 3.2.2.3 CSIの算出 それでは、上記のデータを用いてCSIを算出する。 ## 平均毛づくろい時間割合 mean_groom_TY &lt;- mean(prop_groom_TY$prop_groom) ## 平均近接時間割合 mean_prox_TY &lt;- mean(prop_prox_TY$prop_prox) ## CSIの算出 prop_groom_TY %&gt;% left_join(prop_prox_TY, by = &quot;subject&quot;) %&gt;% mutate(CSI_TY = ((prop_groom/mean_groom_TY) + (prop_prox/mean_prox_TY))/2) -&gt; CSI_TY 算出した値が以下の通り。Kitは一日TYに長時間毛づくろいした日があり、それが強く影響したようだ。 CSI_TY %&gt;% mutate(subject = fct_reorder(subject, CSI_TY)) %&gt;% ggplot(aes(x = subject, y = CSI_TY))+ geom_col(color = &quot;black&quot;, fill = &quot;white&quot;, size =0.3)+ theme_classic(base_size=12, base_family = &quot;Arial&quot;)+ xlab(&quot;&quot;)+ ylab(expression(CSI[i]))+ coord_flip(ylim = c(0,5.3)) + scale_y_continuous(breaks = seq(0,5.2, by= 0.5), expand= c(0,0))+ theme(aspect.ratio=1, axis.text.y = element_text(face = &quot;italic&quot;, hjust=0), axis.ticks.y = element_blank(), axis.title.y = element_text(size = 8), axis.title.x = element_text(size = 10.5), plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;), plot.title = element_text(hjust = 0.5)) 3.2.3 CSIの算出(2018交尾期～2019交尾期) 3.2.3.1 毛づくろい時間割合の算出 算出のためにデータを加工する。 ## 期間を結合 focal_fh_TY &lt;- bind_rows(focal_18m_TY_b, focal_19m_TY_b, focal_19nm) ## 毛づくろい相手を表す列を追加 focal_fh_TY %&gt;% mutate(groom = ifelse(groomer == subject,groomee,groomer), groom2 = ifelse(groomer2 == subject,groomee2,groomer2)) -&gt; focal_fh_TY_b 各メスの追跡時間(総瞬間サンプリングポイント数)を算出する。 focal_fh_TY_b %&gt;% group_by(subject) %&gt;% summarise(dur = n()) %&gt;% ungroup() -&gt; focal_duration_fh_TY 各個体のTYとの毛づくろい時間を算出する。 focal_fh_TY_b %&gt;% filter(groom == &quot;TY&quot;|groom2 == &quot;TY&quot;) %&gt;% group_by(subject) %&gt;% summarise(no_groom = n()) %&gt;% ungroup() -&gt; no_groom_fh_TY 最後に、毛づくろい時間割合を算出する。 left_join(focal_duration_fh_TY, no_groom_fh_TY, by = &quot;subject&quot;) %&gt;% replace_na(list(no_groom = 0)) %&gt;% mutate(prop_groom = no_groom/dur) -&gt; prop_groom_fh_TY 3.2.3.2 近接時間割合 地上採食/地上休息・毛づくろい時にTYが3m以内にいた時間割合を算出する。 まずは、地上採食/地上休息・毛づくろいのデータのみを抽出する。また、TYと毛づくろいしているポイントは除外する。 focal_fh_TY_b %&gt;% filter(activity %in% c(&quot;F&quot;,&quot;R&quot;,&quot;G&quot;) &amp; T_G == &quot;G&quot;) %&gt;% select(no_focal, subject, x0_1m:x1_3m, groom, groom2) %&gt;% replace_na(list(groom = &quot;NA&quot;, groom2 = &quot;NA&quot;)) %&gt;% filter(!(groom == &quot;TY&quot;|groom2 == &quot;TY&quot;)) -&gt; focal_prox_fh_TY 分母を算出する。なお、TYと毛づくろいしていたポイントは分母に含まないものとする。 focal_prox_fh_TY %&gt;% group_by(subject) %&gt;% summarise(dur = n()) %&gt;% ungroup() -&gt; prox_duration_fh_TY TYと3m以内に近接していたポイント数を算出する。 focal_prox_fh_TY %&gt;% filter(str_detect(x0_1m, &quot;TY&quot;)|str_detect(x1_3m, &quot;TY&quot;)) %&gt;% group_by(subject) %&gt;% summarise(no_prox = n()) %&gt;% ungroup() -&gt; no_prox_fh_TY 最後に、近接時間割合を算出する。 left_join(prox_duration_fh_TY, no_prox_fh_TY, by = &quot;subject&quot;) %&gt;% mutate(prop_prox = no_prox/dur) -&gt; prop_prox_fh_TY 3.2.3.3 CSIの算出 それでは、上記のデータを用いてCSIを算出する。 ## 平均毛づくろい時間割合 mean_groom_fh_TY &lt;- mean(prop_groom_fh_TY$prop_groom) ## 平均近接時間割合 mean_prox_fh_TY &lt;- mean(prop_prox_fh_TY$prop_prox) ## CSIの算出 prop_groom_fh_TY %&gt;% left_join(prop_prox_fh_TY, by = &quot;subject&quot;) %&gt;% mutate(CSI_TY = ((prop_groom/mean_groom_fh_TY) + (prop_prox/mean_prox_fh_TY))/2) -&gt; CSI_fh_TY 算出した値が以下の通り。 CSI_fh_TY %&gt;% mutate(subject = fct_reorder(subject, CSI_TY)) %&gt;% ggplot(aes(x = subject, y = CSI_TY))+ geom_col(color = &quot;black&quot;, fill = &quot;white&quot;, size =0.3)+ theme_classic(base_size=12, base_family = &quot;Arial&quot;)+ xlab(&quot;&quot;)+ ylab(expression(CSI[i]))+ coord_flip(ylim = c(0,5.3)) + scale_y_continuous(breaks = seq(0,5.2, by= 0.5), expand= c(0,0))+ theme(aspect.ratio=1, axis.text.y = element_text(face = &quot;italic&quot;, hjust=0), axis.ticks.y = element_blank(), axis.title.y = element_text(size = 8), axis.title.x = element_text(size = 10.5), plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;), plot.title = element_text(hjust = 0.5)) 3.2.4 CSIの算出(非交尾期のみ) 3.2.4.1 毛づくろい時間割合の算出 算出のためにデータを加工する。 ## 全期間を結合 focal_nm_TY &lt;- bind_rows(focal_19nm, focal_21nm_TY_b, focal_22nm) ## 毛づくろい相手を表す列を追加 focal_nm_TY %&gt;% mutate(groom = ifelse(groomer == subject,groomee,groomer), groom2 = ifelse(groomer2 == subject,groomee2,groomer2)) -&gt; focal_nm_TY_b 各メスの追跡時間(総瞬間サンプリングポイント数)を算出する。 focal_nm_TY_b %&gt;% group_by(subject) %&gt;% summarise(dur = n()) %&gt;% ungroup() -&gt; focal_duration_nm_TY 各個体のTYとの毛づくろい時間を算出する。 focal_nm_TY_b %&gt;% filter(groom == &quot;TY&quot;|groom2 == &quot;TY&quot;) %&gt;% group_by(subject) %&gt;% summarise(no_groom = n()) %&gt;% ungroup() -&gt; no_groom_nm_TY 最後に、毛づくろい時間割合を算出する。 left_join(focal_duration_nm_TY, no_groom_nm_TY, by = &quot;subject&quot;) %&gt;% replace_na(list(no_groom = 0)) %&gt;% mutate(prop_groom = no_groom/dur) -&gt; prop_groom_nm_TY 3.2.4.2 近接時間割合 地上採食/地上休息・毛づくろい時にTYが3m以内にいた時間割合を算出する。 まずは、地上採食/地上休息・毛づくろいのデータのみを抽出する。また、TYと毛づくろいしているポイントは除外する。 focal_nm_TY_b %&gt;% filter(activity %in% c(&quot;F&quot;,&quot;R&quot;,&quot;G&quot;) &amp; T_G == &quot;G&quot;) %&gt;% select(no_focal, subject, x0_1m:x1_3m, groom, groom2) %&gt;% replace_na(list(groom = &quot;NA&quot;, groom2 = &quot;NA&quot;)) %&gt;% filter(!(groom == &quot;TY&quot;|groom2 == &quot;TY&quot;)) -&gt; focal_prox_nm_TY 分母を算出する。なお、TYと毛づくろいしていたポイントは分母に含まないものとする。 focal_prox_nm_TY %&gt;% group_by(subject) %&gt;% summarise(dur = n()) %&gt;% ungroup() -&gt; prox_duration_nm_TY TYと3m以内に近接していたポイント数を算出する。 focal_prox_nm_TY %&gt;% filter(str_detect(x0_1m, &quot;TY&quot;)|str_detect(x1_3m, &quot;TY&quot;)) %&gt;% group_by(subject) %&gt;% summarise(no_prox = n()) %&gt;% ungroup() -&gt; no_prox_nm_TY 最後に、近接時間割合を算出する。 left_join(prox_duration_nm_TY, no_prox_nm_TY, by = &quot;subject&quot;) %&gt;% mutate(prop_prox = no_prox/dur) -&gt; prop_prox_nm_TY 3.2.4.3 CSIの算出 それでは、上記のデータを用いてCSIを算出する。 ## 平均毛づくろい時間割合 mean_groom_nm_TY &lt;- mean(prop_groom_nm_TY$prop_groom) ## 平均近接時間割合 mean_prox_nm_TY &lt;- mean(prop_prox_nm_TY$prop_prox) ## CSIの算出 prop_groom_nm_TY %&gt;% left_join(prop_prox_nm_TY, by = &quot;subject&quot;) %&gt;% mutate(CSI_TY = ((prop_groom/mean_groom_nm_TY) + (prop_prox/mean_prox_nm_TY))/2) -&gt; CSI_nm_TY 算出した値が以下の通り。 CSI_nm_TY %&gt;% mutate(subject = fct_reorder(subject, CSI_TY)) %&gt;% ggplot(aes(x = subject, y = CSI_TY))+ geom_col(color = &quot;black&quot;, fill = &quot;white&quot;, size =0.3)+ theme_classic(base_size=12, base_family = &quot;Arial&quot;)+ xlab(&quot;&quot;)+ ylab(expression(CSI[i]))+ coord_flip(ylim = c(0,5.3)) + scale_y_continuous(breaks = seq(0,5.2, by= 0.5), expand= c(0,0))+ theme(aspect.ratio=1, axis.text.y = element_text(face = &quot;italic&quot;, hjust=0), axis.ticks.y = element_blank(), axis.title.y = element_text(size = 8), axis.title.x = element_text(size = 10.5), plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;), plot.title = element_text(hjust = 0.5)) 3.2.5 CSIの算出(調査期間ごと) 3.2.5.1 毛づくろい時間割合の算出 各メスの追跡時間(総瞬間サンプリングポイント数)を調査期間ごとに算出する。 focal_all_TY_b %&gt;% group_by(subject, study_period) %&gt;% summarise(dur = n()) %&gt;% ungroup() -&gt; focal_duration_sp_TY 各個体のTYとの毛づくろい時間を算出する。 focal_all_TY_b %&gt;% filter(groom == &quot;TY&quot;|groom2 == &quot;TY&quot;) %&gt;% group_by(subject, study_period) %&gt;% summarise(no_groom = n()) %&gt;% ungroup() -&gt; no_groom_sp_TY 最後に、毛づくろい時間割合を算出する。 left_join(focal_duration_sp_TY, no_groom_sp_TY, by = c(&quot;subject&quot;,&quot;study_period&quot;)) %&gt;% replace_na(list(no_groom = 0)) %&gt;% mutate(prop_groom = no_groom/dur) -&gt; prop_groom_sp_TY 3.2.5.2 近接時間割合 地上採食/地上休息・毛づくろい時にTYが3m以内にいた時間割合を算出する。 調査期間ごとに分母を算出する。なお、TYと毛づくろいしていたポイントは分母に含まないものとする。 focal_prox_TY %&gt;% group_by(subject, study_period) %&gt;% summarise(dur = n()) %&gt;% ungroup() -&gt; prox_duration_sp_TY TYと3m以内に近接していたポイント数を算出する。 focal_prox_TY %&gt;% filter(str_detect(x0_1m, &quot;TY&quot;)|str_detect(x1_3m, &quot;TY&quot;)) %&gt;% group_by(subject, study_period) %&gt;% summarise(no_prox = n()) %&gt;% ungroup() -&gt; no_prox_sp_TY 最後に、近接時間割合を算出する。 left_join(prox_duration_sp_TY, no_prox_sp_TY, by = c(&quot;subject&quot;,&quot;study_period&quot;)) %&gt;% replace_na(list(no_prox = 0)) %&gt;% mutate(prop_prox = no_prox/dur) -&gt; prop_prox_sp_TY 3.2.5.3 CSIの算出 それでは、上記のデータを用いてCSIを算出する。 ## CSIの算出 prop_groom_sp_TY %&gt;% left_join(prop_prox_sp_TY, by = c(&quot;subject&quot;,&quot;study_period&quot;)) %&gt;% group_by(study_period) %&gt;% mutate(mean_groom = mean(prop_groom), mean_prox = mean(prop_prox)) %&gt;% ungroup() %&gt;% mutate(CSI_TY = ((prop_groom/mean_groom) + (prop_prox/mean_prox))/2) -&gt; CSI_sp_TY 算出した値が以下の通り。 CSI_sp_TY %&gt;% ggplot(aes(x = study_period, y = CSI_TY))+ geom_point()+ geom_line(aes(group = subject))+ theme_bw()+ facet_rep_wrap(~subject, repeat.tick.labels = TRUE, scales = &quot;free&quot;)+ ylab(expression(CSI[i])) 3.3 ITとメスのCSIの算出 3.3.1 データの読み込みと加工 まずは、ITの出入りがあった2019年交尾期、2021年非交尾期についてTYが確認できた時間帯のデータを読み込む。 IT_19m &lt;- read_excel(&quot;../Data/data/2019mating/2019mating_raw.xlsx&quot;, sheet = &quot;male_presence_long&quot;) %&gt;% filter(maleID == &quot;IT&quot;) %&gt;% mutate_at(5:6, ~make_datetime(year(date), month(date), mday(date), hour(.),minute(.))) %&gt;% mutate(date = as_date(date)) %&gt;% ## 分派集団にいるときは除く filter(groupID != 41 &amp; groupID != 53 &amp; groupID != 54) IT_21nm &lt;- read_excel(&quot;../Data/data/2021nonmating/2021nonmating_raw.xlsx&quot;, sheet = &quot;male_presence_long&quot;) %&gt;% filter(maleID == &quot;IT&quot;) %&gt;% mutate_at(5:6, ~make_datetime(year(date), month(date), mday(date), hour(.),minute(.))) %&gt;% mutate(date = as_date(date)) 上記2つの期間の個体追跡データに、各個体追跡セッション中にITが確認できていたかを表す列を追加し、ITが確認できたものだけを抽出する(focal_19m_b、focal_21nm_b)。 focal_19m %&gt;% distinct(no_focal, date, start_time, fin_time) %&gt;% left_join(IT_19m %&gt;% select(date, male_presence, first, last), by = &quot;date&quot;) %&gt;% ## 個体追跡セッション中にITが確認されていたか mutate(IT = ifelse((first &lt;= start_time &amp; last &gt;= fin_time)| (first &gt;= start_time &amp; first &lt;= fin_time)| (last &gt;= start_time &amp; last &lt;= fin_time), 1, 0)) %&gt;% replace_na(list(IT = 0)) -&gt; focal_19m_IT focal_19m %&gt;% left_join(focal_19m_IT %&gt;% select(no_focal, IT), by = &quot;no_focal&quot;) %&gt;% filter(IT == &quot;1&quot;) -&gt; focal_19m_IT_b focal_21nm %&gt;% distinct(no_focal, date, start_time, fin_time) %&gt;% left_join(IT_21nm %&gt;% select(date, male_presence, first, last), by = &quot;date&quot;) %&gt;% ## 個体追跡セッション中にITが確認されていたか mutate(IT = ifelse((first &lt;= start_time &amp; last &gt;= fin_time)| (first &gt;= start_time &amp; first &lt;= fin_time)| (last &gt;= start_time &amp; last &lt;= fin_time), 1, 0)) %&gt;% replace_na(list(IT = 0)) -&gt; focal_21nm_IT focal_21nm %&gt;% left_join(focal_21nm_IT %&gt;% select(no_focal, IT), by = &quot;no_focal&quot;) %&gt;% filter(IT == &quot;1&quot;) -&gt; focal_21nm_IT_b 交尾期のデータについて、追跡個体が発情しているかの列を追加し、発情していない日のデータのみを抽出する(focal_18m_IT_b、focal_19m_IT_b)。 focal_18m %&gt;% left_join(female_18m %&gt;% rename(subject = femaleID) %&gt;% select(date, subject, rs2) , by = c(&quot;date&quot;, &quot;subject&quot;)) %&gt;% filter(rs2 == &quot;0&quot;) -&gt; focal_18m_IT_b focal_19m_IT_b %&gt;% left_join(female_19m %&gt;% rename(subject = femaleID) %&gt;% select(date, subject, rs2) , by = c(&quot;date&quot;, &quot;subject&quot;)) %&gt;% filter(rs2 == &quot;0&quot;) -&gt; focal_19m_IT_b 3.3.2 CSIの算出(全調査期間) 3.3.2.1 毛づくろい時間割合の算出 算出のためにデータを加工する。 ## 全期間を結合 focal_all_IT &lt;- bind_rows(focal_18m_IT_b, focal_19m_IT_b, focal_19nm, focal_21nm_IT_b) ## 毛づくろい相手を表す列を追加 focal_all_IT %&gt;% mutate(groom = ifelse(groomer == subject,groomee,groomer), groom2 = ifelse(groomer2 == subject,groomee2,groomer2)) -&gt; focal_all_IT_b 各メスの追跡時間(総瞬間サンプリングポイント数)を算出する。 focal_all_IT_b %&gt;% group_by(subject) %&gt;% summarise(dur = n()) %&gt;% ungroup() -&gt; focal_duration_IT 各個体のITとの毛づくろい時間を算出する。 focal_all_IT_b %&gt;% filter(groom == &quot;IT&quot;|groom2 == &quot;IT&quot;) %&gt;% group_by(subject) %&gt;% summarise(no_groom = n())%&gt;% ungroup() -&gt; no_groom_IT 最後に、毛づくろい時間割合を算出する。 left_join(focal_duration_IT, no_groom_IT, by = &quot;subject&quot;) %&gt;% replace_na(list(no_groom = 0)) %&gt;% mutate(prop_groom = no_groom/dur) -&gt; prop_groom_IT 3.3.2.2 近接時間割合 地上採食/地上休息・毛づくろい時にITが3m以内にいた時間割合を算出する。 まずは、地上採食/地上休息・毛づくろいのデータのみを抽出する。また、ITと毛づくろいしているポイントは除外する。 focal_all_IT_b %&gt;% filter(activity %in% c(&quot;F&quot;,&quot;R&quot;,&quot;G&quot;) &amp; T_G == &quot;G&quot;) %&gt;% select(no_focal, subject, x0_1m:x1_3m, groom, groom2, study_period) %&gt;% replace_na(list(groom = &quot;NA&quot;, groom2 = &quot;NA&quot;)) %&gt;% filter(!(groom == &quot;IT&quot;|groom2 == &quot;IT&quot;)) -&gt; focal_prox_IT 分母を算出する。なお、ITと毛づくろいしていたポイントは分母に含まないものとする。 focal_prox_IT %&gt;% group_by(subject) %&gt;% summarise(dur = n())%&gt;% ungroup() -&gt; prox_duration_IT ITと3m以内に近接していたポイント数を算出する。 focal_prox_IT %&gt;% filter(str_detect(x0_1m, &quot;IT&quot;)|str_detect(x1_3m, &quot;IT&quot;)) %&gt;% group_by(subject) %&gt;% summarise(no_prox = n())%&gt;% ungroup() -&gt; no_prox_IT 最後に、近接時間割合を算出する。 left_join(prox_duration_IT, no_prox_IT, by = &quot;subject&quot;) %&gt;% mutate(prop_prox = no_prox/dur) -&gt; prop_prox_IT 3.3.2.3 CSIの算出 それでは、上記のデータを用いてCSIを算出する。 ## 平均毛づくろい時間割合 mean_groom_IT &lt;- mean(prop_groom_IT$prop_groom) ## 平均近接時間割合 mean_prox_IT &lt;- mean(prop_prox_IT$prop_prox) ## CSIの算出 prop_groom_IT %&gt;% left_join(prop_prox_IT, by = &quot;subject&quot;) %&gt;% mutate(CSI_IT = ((prop_groom/mean_groom_IT) + (prop_prox/mean_prox_IT))/2) -&gt; CSI_IT 算出した値が以下の通り。Kitは一日ITに長時間毛づくろいした日があり、それが強く影響したようだ。 CSI_IT %&gt;% mutate(subject = fct_reorder(subject, CSI_IT)) %&gt;% ggplot(aes(x = subject, y = CSI_IT))+ geom_col(color = &quot;black&quot;, fill = &quot;white&quot;, size =0.3)+ theme_classic(base_size=12, base_family = &quot;Arial&quot;)+ xlab(&quot;&quot;)+ ylab(expression(CSI[i]))+ coord_flip(ylim = c(0,6)) + scale_y_continuous(breaks = seq(0,6, by= 0.5), expand= c(0,0))+ theme(aspect.ratio=1, axis.text.y = element_text(face = &quot;italic&quot;, hjust=0), axis.ticks.y = element_blank(), axis.title.y = element_text(size = 8), axis.title.x = element_text(size = 10.5), plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;), plot.title = element_text(hjust = 0.5)) 3.3.3 CSIの算出(2018交尾期～2019交尾期) 3.3.3.1 毛づくろい時間割合の算出 算出のためにデータを加工する。 ## 期間を結合 focal_fh_IT &lt;- bind_rows(focal_18m_IT_b, focal_19m_IT_b, focal_19nm) ## 毛づくろい相手を表す列を追加 focal_fh_IT %&gt;% mutate(groom = ifelse(groomer == subject,groomee,groomer), groom2 = ifelse(groomer2 == subject,groomee2,groomer2)) -&gt; focal_fh_IT_b 各メスの追跡時間(総瞬間サンプリングポイント数)を算出する。 focal_fh_IT_b %&gt;% group_by(subject) %&gt;% summarise(dur = n())%&gt;% ungroup() -&gt; focal_duration_fh_IT 各個体のITとの毛づくろい時間を算出する。 focal_fh_IT_b %&gt;% filter(groom == &quot;IT&quot;|groom2 == &quot;IT&quot;) %&gt;% group_by(subject) %&gt;% summarise(no_groom = n())%&gt;% ungroup() -&gt; no_groom_fh_IT 最後に、毛づくろい時間割合を算出する。 left_join(focal_duration_fh_IT, no_groom_fh_IT, by = &quot;subject&quot;) %&gt;% replace_na(list(no_groom = 0)) %&gt;% mutate(prop_groom = no_groom/dur) -&gt; prop_groom_fh_IT 3.3.3.2 近接時間割合 地上採食/地上休息・毛づくろい時にITが3m以内にいた時間割合を算出する。 まずは、地上採食/地上休息・毛づくろいのデータのみを抽出する。また、ITと毛づくろいしているポイントは除外する。 focal_fh_IT_b %&gt;% filter(activity %in% c(&quot;F&quot;,&quot;R&quot;,&quot;G&quot;) &amp; T_G == &quot;G&quot;) %&gt;% select(no_focal, subject, x0_1m:x1_3m, groom, groom2) %&gt;% replace_na(list(groom = &quot;NA&quot;, groom2 = &quot;NA&quot;)) %&gt;% filter(!(groom == &quot;IT&quot;|groom2 == &quot;IT&quot;)) -&gt; focal_prox_fh_IT 分母を算出する。なお、ITと毛づくろいしていたポイントは分母に含まないものとする。 focal_prox_fh_IT %&gt;% group_by(subject) %&gt;% summarise(dur = n())%&gt;% ungroup() -&gt; prox_duration_fh_IT ITと3m以内に近接していたポイント数を算出する。 focal_prox_fh_IT %&gt;% filter(str_detect(x0_1m, &quot;IT&quot;)|str_detect(x1_3m, &quot;IT&quot;)) %&gt;% group_by(subject) %&gt;% summarise(no_prox = n())%&gt;% ungroup() -&gt; no_prox_fh_IT 最後に、近接時間割合を算出する。 left_join(prox_duration_fh_IT, no_prox_fh_IT, by = &quot;subject&quot;) %&gt;% replace_na(list(no_prox = 0)) %&gt;% mutate(prop_prox = no_prox/dur) -&gt; prop_prox_fh_IT 3.3.3.3 CSIの算出 それでは、上記のデータを用いてCSIを算出する。 ## 平均毛づくろい時間割合 mean_groom_fh_IT &lt;- mean(prop_groom_fh_IT$prop_groom) ## 平均近接時間割合 mean_prox_fh_IT &lt;- mean(prop_prox_fh_IT$prop_prox) ## CSIの算出 prop_groom_fh_IT %&gt;% left_join(prop_prox_fh_IT, by = &quot;subject&quot;) %&gt;% mutate(CSI_IT = ((prop_groom/mean_groom_fh_IT) + (prop_prox/mean_prox_fh_IT))/2) -&gt; CSI_fh_IT 算出した値が以下の通り。 CSI_fh_IT %&gt;% mutate(subject = fct_reorder(subject, CSI_IT)) %&gt;% ggplot(aes(x = subject, y = CSI_IT))+ geom_col(color = &quot;black&quot;, fill = &quot;white&quot;, size =0.3)+ theme_classic(base_size=12, base_family = &quot;Arial&quot;)+ xlab(&quot;&quot;)+ ylab(expression(CSI[i]))+ coord_flip(ylim = c(0,10)) + scale_y_continuous(breaks = seq(0,10, by= 1), expand= c(0,0))+ theme(aspect.ratio=1, axis.text.y = element_text(face = &quot;italic&quot;, hjust=0), axis.ticks.y = element_blank(), axis.title.y = element_text(size = 8), axis.title.x = element_text(size = 10.5), plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;), plot.title = element_text(hjust = 0.5)) 3.3.4 CSIの算出(非交尾期のみ) 3.3.4.1 毛づくろい時間割合の算出 算出のためにデータを加工する。 ## 全期間を結合 focal_nm_IT &lt;- bind_rows(focal_19nm, focal_21nm_IT_b) ## 毛づくろい相手を表す列を追加 focal_nm_IT %&gt;% mutate(groom = ifelse(groomer == subject,groomee,groomer), groom2 = ifelse(groomer2 == subject,groomee2,groomer2)) -&gt; focal_nm_IT_b 各メスの追跡時間(総瞬間サンプリングポイント数)を算出する。 focal_nm_IT_b %&gt;% group_by(subject) %&gt;% summarise(dur = n()) %&gt;% ungroup() -&gt; focal_duration_nm_IT 各個体のITとの毛づくろい時間を算出する。 focal_nm_IT_b %&gt;% filter(groom == &quot;IT&quot;|groom2 == &quot;IT&quot;) %&gt;% group_by(subject) %&gt;% summarise(no_groom = n()) %&gt;% ungroup() -&gt; no_groom_nm_IT 最後に、毛づくろい時間割合を算出する。 left_join(focal_duration_nm_IT, no_groom_nm_IT, by = &quot;subject&quot;) %&gt;% replace_na(list(no_groom = 0)) %&gt;% mutate(prop_groom = no_groom/dur) -&gt; prop_groom_nm_IT 3.3.4.2 近接時間割合 地上採食/地上休息・毛づくろい時にITが3m以内にいた時間割合を算出する。 まずは、地上採食/地上休息・毛づくろいのデータのみを抽出する。また、ITと毛づくろいしているポイントは除外する。 focal_nm_IT_b %&gt;% filter(activity %in% c(&quot;F&quot;,&quot;R&quot;,&quot;G&quot;) &amp; T_G == &quot;G&quot;) %&gt;% select(no_focal, subject, x0_1m:x1_3m, groom, groom2) %&gt;% replace_na(list(groom = &quot;NA&quot;, groom2 = &quot;NA&quot;)) %&gt;% filter(!(groom == &quot;IT&quot;|groom2 == &quot;IT&quot;)) -&gt; focal_prox_nm_IT 分母を算出する。なお、ITと毛づくろいしていたポイントは分母に含まないものとする。 focal_prox_nm_IT %&gt;% group_by(subject) %&gt;% summarise(dur = n()) %&gt;% ungroup() -&gt; prox_duration_nm_IT ITと3m以内に近接していたポイント数を算出する。 focal_prox_nm_IT %&gt;% filter(str_detect(x0_1m, &quot;IT&quot;)|str_detect(x1_3m, &quot;IT&quot;)) %&gt;% group_by(subject) %&gt;% summarise(no_prox = n()) %&gt;% ungroup() -&gt; no_prox_nm_IT 最後に、近接時間割合を算出する。 left_join(prox_duration_nm_IT, no_prox_nm_IT, by = &quot;subject&quot;) %&gt;% replace_na(list(no_prox = 0)) %&gt;% mutate(prop_prox = no_prox/dur) -&gt; prop_prox_nm_IT 3.3.4.3 CSIの算出 それでは、上記のデータを用いてCSIを算出する。 ## 平均毛づくろい時間割合 mean_groom_nm_IT &lt;- mean(prop_groom_nm_IT$prop_groom) ## 平均近接時間割合 mean_prox_nm_IT &lt;- mean(prop_prox_nm_IT$prop_prox) ## CSIの算出 prop_groom_nm_IT %&gt;% left_join(prop_prox_nm_IT, by = &quot;subject&quot;) %&gt;% mutate(CSI_IT = ((prop_groom/mean_groom_nm_IT) + (prop_prox/mean_prox_nm_IT))/2) -&gt; CSI_nm_IT 算出した値が以下の通り。 CSI_nm_IT %&gt;% mutate(subject = fct_reorder(subject, CSI_IT)) %&gt;% ggplot(aes(x = subject, y = CSI_IT))+ geom_col(color = &quot;black&quot;, fill = &quot;white&quot;, size =0.3)+ theme_classic(base_size=12, base_family = &quot;Arial&quot;)+ xlab(&quot;&quot;)+ ylab(expression(CSI[i]))+ coord_flip(ylim = c(0,7)) + scale_y_continuous(breaks = seq(0,10, by= 1), expand= c(0,0))+ theme(aspect.ratio=1, axis.text.y = element_text(face = &quot;italic&quot;, hjust=0), axis.ticks.y = element_blank(), axis.title.y = element_text(size = 8), axis.title.x = element_text(size = 10.5), plot.margin=grid::unit(c(0,0,0,0), &quot;mm&quot;), plot.title = element_text(hjust = 0.5)) 3.3.5 CSIの算出(調査期間ごと) 3.3.5.1 毛づくろい時間割合の算出 各メスの追跡時間(総瞬間サンプリングポイント数)を調査期間ごとに算出する。 focal_all_IT_b %&gt;% group_by(subject, study_period) %&gt;% summarise(dur = n()) %&gt;% ungroup() -&gt; focal_duration_sp_IT 各個体のITとの毛づくろい時間を算出する。 focal_all_IT_b %&gt;% filter(groom == &quot;IT&quot;|groom2 == &quot;IT&quot;) %&gt;% group_by(subject, study_period) %&gt;% summarise(no_groom = n()) %&gt;% ungroup() -&gt; no_groom_sp_IT 最後に、毛づくろい時間割合を算出する。 left_join(focal_duration_sp_IT, no_groom_sp_IT, by = c(&quot;subject&quot;,&quot;study_period&quot;)) %&gt;% replace_na(list(no_groom = 0)) %&gt;% mutate(prop_groom = no_groom/dur) -&gt; prop_groom_sp_IT 3.3.5.2 近接時間割合 地上採食/地上休息・毛づくろい時にITが3m以内にいた時間割合を算出する。 調査期間ごとに分母を算出する。なお、ITと毛づくろいしていたポイントは分母に含まないものとする。 focal_prox_IT %&gt;% group_by(subject, study_period) %&gt;% summarise(dur = n()) %&gt;% ungroup() -&gt; prox_duration_sp_IT ITと3m以内に近接していたポイント数を算出する。 focal_prox_IT %&gt;% filter(str_detect(x0_1m, &quot;IT&quot;)|str_detect(x1_3m, &quot;IT&quot;)) %&gt;% group_by(subject, study_period) %&gt;% summarise(no_prox = n()) %&gt;% ungroup() -&gt; no_prox_sp_IT 最後に、近接時間割合を算出する。 left_join(prox_duration_sp_IT, no_prox_sp_IT, by = c(&quot;subject&quot;,&quot;study_period&quot;)) %&gt;% replace_na(list(no_prox = 0)) %&gt;% mutate(prop_prox = no_prox/dur) -&gt; prop_prox_sp_IT 3.3.5.3 CSIの算出 それでは、上記のデータを用いてCSIを算出する。なお、平均毛づくろい時間割合が0の調査期間は分子の左側を1とした。 ## CSIの算出 prop_groom_sp_IT %&gt;% left_join(prop_prox_sp_IT, by = c(&quot;subject&quot;,&quot;study_period&quot;)) %&gt;% group_by(study_period) %&gt;% mutate(mean_groom = mean(prop_groom), mean_prox = mean(prop_prox)) %&gt;% ungroup() %&gt;% mutate(CSI_IT = ifelse(mean_groom != 0, ((prop_groom/mean_groom) + (prop_prox/mean_prox))/2, (1 + (prop_prox/mean_prox))/2)) -&gt; CSI_sp_IT 算出した値が以下の通り。 CSI_sp_IT %&gt;% ggplot(aes(x = study_period, y = CSI_IT))+ geom_point()+ geom_line(aes(group = subject))+ theme_bw()+ facet_rep_wrap(~subject, repeat.tick.labels = TRUE, scales = &quot;free&quot;)+ ylab(expression(CSI[i])) References Yamaguchi, T., &amp; Kazahari, N. (2022). Fission–fusion dynamics in a wild group of japanese macaques (macaca fuscata) on kinkazan island caused by the repeated separation of an alpha male being followed by females. Primates, 63(6), 575–582. "],["05_definition_group.html", "4 群れの離合集散動態をどのように分析すべきか 4.1 サブグループ/パーティの定義とサンプリング方法 4.2 ニホンザルではどのように集団サイズを測るべきか 4.3 どのような集団のデータを用いるべきか", " 4 群れの離合集散動態をどのように分析すべきか 4.1 サブグループ/パーティの定義とサンプリング方法 離合集散動態(fission-fusion dynamics: FFD)とは、集団内のまとまりや確認できる個体の数・構成の時空間的変動のことを指す(Aureli et al., 2008)。FFDの程度は種内でも種間でも多様である。例えば、FFDの程度が高いチンパンジー(e.g., Hashimoto et al., 2001; Itoh &amp; Nishida, 2007)やクモザル(e.g., Asensio et al., 2009; Ramos-Fernández &amp; Morales, 2014)は一日を通してサイズや構成が変化するパーティ/サブグループに別れて生活している。一方で、FFDの程度が低いニホンザルなどは、個体間距離は一日の中でも変動し、しばしば2つ以上のサブグループに分かれて行動をすることもあるが(Sugiura et al., 2011; Yamaguchi &amp; Kazahari, 2022)、基本的には群れの全個体が一日中行動を共にする。 FFDの研究はこれまで主にその程度が高いチンパンジーやクモザルを中心に行われ、パーティあるいはサブグループのサイズや構成が短期的・長期的にどのように変化するのかが調べられてきた(Aguilar-Melo et al., 2018, 2020; Anderson et al., 2002; Asensio et al., 2009; Busia et al., 2016, 2017; Chapman et al., 1995; Hartwell et al., 2021; Hashimoto et al., 2001, 2003; Itoh &amp; Nishida, 2007; Matsumoto-Oda et al., 1998; Matthews et al., 2021; Mitani et al., 2002; Newton-Fisher et al., 2000; Pinacho-Guendulain &amp; Ramos-Fernández, 2017; Potts et al., 2011; Ramos-Fernández &amp; Morales, 2014; Shibata et al., 2022; Villioth et al., 2022; Wakefield, 2008; Wittiger &amp; Boesch, 2013)。これらの研究でパーティ/サブグループを定量化する際には、主に以下の2種類の方法が用いられている。これらはいずれも異なるグルーピングの側面を定量化していると考えられている(Itoh &amp; Nishida, 2007; Reynolds, 2005)。なお、これら以外の種の研究でもサブグルーピング(分派)について扱う場合はいずれかの方法を用いることが多い(Bowler &amp; Bodmer, 2009; Coles et al., 2012; Dolado et al., 2016; Holmes et al., 2016)。 スキャンサンプリングに基づく方法 ある一定時間ごと(1分、15分、20分など)に観察者がスキャンサンプリングで視界内の個体、あるいは一定のルールに従って(e.g., 追跡個体の35m, 50m/30mのchain rule)同じパーティ/サブグループにいるとみなされる個体を記録する。研究によっては、連続記録で個体構成の変動を記録する場合もある。そのときどきの追跡個体/観察者の周囲で確認できる個体の集まりをパーティ/サブグループとみなす方法。チンパンジーの研究の半分くらいとほとんどすべてのクモザルの研究で採用されている(Aguilar-Melo et al., 2018, 2020; Anderson et al., 2002; Asensio et al., 2009; Busia et al., 2016, 2017; Chapman et al., 1995; Hartwell et al., 2021; Itoh &amp; Nishida, 2007; Matthews et al., 2021; Mitani et al., 2002; Newton-Fisher et al., 2000; Pinacho-Guendulain &amp; Ramos-Fernández, 2017; Potts et al., 2011; Ramos-Fernández &amp; Morales, 2014; Villioth et al., 2022; Wakefield, 2008; Wittiger &amp; Boesch, 2013)。Itoh &amp; Nishida (2007) はこのような方法によって観察されたパーティをface-to-face partyとした。 累積記録法 ある一定時間内(1時間~1日)に観察された個体を全てアドリブで記録し、確認された全個体を同じパーティ/サブグループにいたとみなす。1よりもより緩いつながりを評価することができる。主に日本人のチンパンジー研究者に用いられている(Hashimoto et al., 2001; Itoh &amp; Nishida, 2007; Matsumoto-Oda et al., 1998; Shibata et al., 2022)。Itoh &amp; Nishida (2007) はこのような方法によって観察されたパーティをnomadic partyとした。 4.2 ニホンザルではどのように集団サイズを測るべきか 1の方法はそのときどきのメンバーシップを細かく連続的に評価できるという利点があるものの、そのときどきの視界の良さや集団の広がり度合い、動物の人馴れ度合いに大きな影響を受ける(Chapman et al., 1993)。例えば、たとえある個体が1日中行動を共にしていたとしても、視界が悪いなどの理由で研究者の視界から外れてしまえば同じパーティ/サブグループにいないとみなされてしまう。こうした問題を可能な限り排除するためには、2のように一定以上の長さの期間内に確認された個体を累積して記録することが望ましい(Chapman et al., 1993)。 ニホンザルでは、分派が生じていなかったとしても(= 行動を共にしているとみなされているときでも)個体間の距離が視認できる距離を超えることが珍しくない(Nishikawa et al., 2014)。それは屋久島に比べて視界がよいとされる金華山であっても同様である(Koda et al., 2008; Sugiura et al., 2011)。よって、ニホンザルで共に行動していると考えられる集団の構成を確認する際にも、やはり2の方な方法をとるのが望ましいと考えられるだろう。本研究では、Itoh &amp; Nishida (2007) などに従い一日の中で一度でも確認できた個体を同じ集団にいた個体とみなした。ただし、通常の個体間距離を離れて発見された集団(Sugiura et al., 2011; Yamaguchi &amp; Kazahari, 2022)については、別の集団とみなした。最小の追跡時間を何分とすべきかについては、次章(5章)で検討する。 4.3 どのような集団のデータを用いるべきか 群れの離合集散が生じていると考えられる状況においては、観察者がどのサブグループを発見したかによって個体の確認状況が大きく左右される。例えば、群れが2つに分派しているとき(Subgroup 1とSubgroup 2)に3日間観察を行ったとする(図4.1)。このとき、サブグループの個体構成が全く変化しなかったとしても、日によって観察者が発見したサブグループが異なれば(e.g., 1日目と3日目にSubgroup 1、2日目にSubgroup 2)、確認できたメスの数は\\(7 \\rightarrow 5 \\rightarrow 7\\)となってしまう。同様に、オスの確認状況も観察者がどの集団を発見するかに左右される。これは、個体の確認状況を分析したいときには大きな問題になる。 図4.1: 離合集散が生じている状況での個体の確認状況 これを解決するため、本研究では6歳以上のメスが50%以上確認できた集団(= 以下、群れ本体)を観察した日のデータのみを用いて個体の確認状況の分析を行う。これにより、上記の問題を完全に解決することはできないが、観察者がどの集団を発見するかによって生じるバイアスをある程度減らすことができると考えられる。上記の例では、2日目のデータは用いないことで、サブグループの個体構成に変化がなければ、個体の確認状況が一定に保たれる。 References Aguilar-Melo, A. R., Calmé, S., Pinacho-Guendulain, B., Smith-Aguilar, S. E., &amp; Ramos-Fernández, G. (2020). Ecological and social determinants of association and proximity patterns in the fission-fusion society of spider monkeys (ateles geoffroyi). Am. J. Primatol., 82(1), e23077. Aguilar-Melo, A. R., Calmé, S., Smith-Aguilar, S. E., &amp; Ramos-Fernandez, G. (2018). Fission-fusion dynamics as a temporally and spatially flexible behavioral strategy in spider monkeys. Behav. Ecol. Sociobiol., 72(9). Anderson, D. P., Nordheim, E. V., Boesch, C., &amp; Moermond, T. C. (2002). Factors influencing fission–fusion grouping in chimpanzees in the taı̈ national park, côte d’ivoire. In Behavioural diversity in chimpanzees and bonobos (pp. 90–101). Cambridge University Press. Asensio, N., Korstjens, A. H., &amp; Aureli, F. (2009). Fissioning minimizes ranging costs in spider monkeys: A multiple-level approach. Behav. Ecol. Sociobiol., 63(5), 649–659. Aureli, F., Schaffner, C. M., Boesch, C., Bearder, S. K., Call, J., Chapman, C. A., Connor, R., Fiore, A. D., Dunbar, R. I. M., Henzi, S. P., &amp; Others. (2008). Fission-fusion dynamics: New research frameworks. Curr. Anthropol., 49(4), 627–654. Bowler, M., &amp; Bodmer, R. (2009). Social behavior in fission-fusion groups of red uakari monkeys (cacajao calvus ucayalii). Am. J. Primatol., 71(12), 976–987. Busia, L., Schaffner, C. M., &amp; Aureli, F. (2017). Relationship quality affects fission decisions in wild spider monkeys (ateles geoffroyi). Ethology, 123(6-7), 405–411. Busia, L., Schaffner, C. M., Rothman, J. M., Aureli, F., &amp; Setchell, J. M. (2016). Do fruit nutrients affect subgrouping patterns in wild spider monkeys (ateles geoffroyi)? Int. J. Primatol., 37, 738–751. Chapman, C. A., Chapman, L. J., &amp; Wrangham, R. W. (1995). Ecological constraints on group size: An analysis of spider monkey and chimpanzee subgroups. Behav. Ecol. Sociobiol., 36(1), 59–70. Chapman, C. A., White, F. J., &amp; Wrangham, R. W. (1993). Defining subgroup size in fission-fusion societies. Folia Primatol., 61(1), 31–34. Coles, R. C., Lee, P. C., &amp; Talebi, M. (2012). Fission–Fusion dynamics in southern muriquis (brachyteles arachnoides) in continuous brazilian atlantic forest. Int. J. Primatol., 33(1), 93–114. Dolado, R., Cooke, C., &amp; Beltran, F. S. (2016). How many for lunch today? Seasonal Fission-Fusion dynamics as a feeding strategy in wild Red-Capped mangabeys (cercocebus torquatus). Folia Primatol., 87(3), 197–212. Hartwell, K. S., Notman, H., Kalbitzer, U., Chapman, C. A., &amp; Pavelka, M. M. S. M. (2021). Fruit availability has a complex relationship with fission-fusion dynamics in spider monkeys. Primates, 62(1), 165–175. Hashimoto, C., Furuichi, T., &amp; Tashiro, Y. (2001). What factors affect the size of chimpanzee parties in the kalinzu forest, uganda? Examination of fruit abundance and number of estrous females. Int. J. Primatol., 22(6), 947–959. Hashimoto, C., Suzuki, S., Takenoshita, Y., Yamagiwa, J., Basabose, A. K., &amp; Furuichi, T. (2003). How fruit abundance affects the chimpanzee party size: A comparison between four study sites. Primates, 44(2), 77–81. Holmes, S. M., Gordon, A. D., Louis, E. E., &amp; Johnson, S. E. (2016). Fission-fusion dynamics in black-and-white ruffed lemurs may facilitate both feeding strategies and communal care of infants in a spatially and temporally variable environment. Behav. Ecol. Sociobiol., 70(11), 1949–1960. Itoh, N., &amp; Nishida, T. (2007). Chimpanzee grouping patterns and food availability in mahale mountains national park, tanzania. Primates, 48(2), 87–96. Koda, H., Shimooka, Y., &amp; Sugiura, H. (2008). Effects of caller activity and habitat visibility on contact call rate of wild japanese macaques (macaca fuscata). Am. J. Primatol., 70(11), 1055–1063. Matsumoto-Oda, A., Hosaka, K., Huffman, M. A., &amp; Kawanaka, K. (1998). Factors affecting party size in chimpanzees of the mahale mountains. Int. J. Primatol., 19(6), 999–1011. Matthews, J. K., Ridley, A., Kaplin, B. A., &amp; Grueter, C. C. (2021). Ecological and reproductive drivers of fission-fusion dynamics in chimpanzees (pan troglodytes schweinfurthii) inhabiting a montane forest. Behav. Ecol. Sociobiol., 75(1), 23. Mitani, J. C., Watts, D. P., &amp; Lwanga, J. S. (2002). Ecological and social correlates of chimpanzee party size and composition. In Behavioural diversity in chimpanzees and bonobos (pp. 102–111). Cambridge University Press. Newton-Fisher, N. E., Reynolds, V., &amp; Plumptre, A. J. (2000). Food supply and chimpanzee (pan troglodytes schweinfurthii) party size in the budongo forest reserve, uganda. Int. J. Primatol. Nishikawa, M., Suzuki, M., &amp; Sprague, D. S. (2014). Activity and social factors affect cohesion among individuals in female japanese macaques: A simultaneous focal-follow study: Cohesion among individuals inM. fuscata. Am. J. Primatol., 76(7), 694–703. Pinacho-Guendulain, B., &amp; Ramos-Fernández, G. (2017). Influence of fruit availability on the fission–fusion dynamics of spider monkeys (ateles geoffroyi). Int. J. Primatol., 38(3), 466–484. Potts, K. B., Watts, D. P., &amp; Wrangham, R. W. (2011). Comparative feeding ecology of two communities of chimpanzees (pan troglodytes) in kibale national park, uganda. Int. J. Primatol., 32(3), 669–690. Ramos-Fernández, G., &amp; Morales, J. M. (2014). Unraveling fission-fusion dynamics: How subgroup properties and dyadic interactions influence individual decisions. Behav. Ecol. Sociobiol., 68(8), 1225–1235. Reynolds, V. (2005). The chimpanzees of the budongo forest: Ecology, behaviour and conservation. OUP Oxford. Shibata, S., Furuichi, T., &amp; Hashimoto, C. (2022). Adaptive party choice of Low-Ranking males in Fission–Fusion dynamics of chimpanzees in kalinzu forest reserve, uganda. Animals, 12(17), 2240. Sugiura, H., Shimooka, Y., &amp; Tsuji, Y. (2011). Variation in spatial cohesiveness in a group of japanese macaques (macaca fuscata). Int. J. Primatol., 32(6), 1348–1366. Villioth, J., Zuberbühler, K., &amp; Newton-Fisher, N. E. (2022). Patch choice decisions by a fission–fusion forager as a test of the ecological constraints model. Behav. Ecol. Sociobiol., 76(12), 156. Wakefield, M. L. (2008). Grouping patterns and competition among female pan troglodytes schweinfurthii at ngogo, kibale national park, uganda. Int. J. Primatol., 29(4), 907–929. Wittiger, L., &amp; Boesch, C. (2013). Female gregariousness in western chimpanzees (pan troglodytes verus) is influenced by resource aggregation and the number of females in estrus. Behav. Ecol. Sociobiol., 67(7), 1097–1111. Yamaguchi, T., &amp; Kazahari, N. (2022). Fission–fusion dynamics in a wild group of japanese macaques (macaca fuscata) on kinkazan island caused by the repeated separation of an alpha male being followed by females. Primates, 63(6), 575–582. "],["06_decide_duration.html", "5 メスの発見までに要する時間 5.1 データの読み込み・加工 5.2 生存時間分析", " 5 メスの発見までに要する時間 これ以降で、各観察日に群れで確認した個体数を分析する。そのとき、何分以上追跡した日であれば十分にメスを探索する時間があったとみなし、分析に含めることができるだろうか。以下ではこの基準を決めるため、メスを確認するのにどの程度時間がかかっていたかを生存時間解析1を用いて分析する。 5.1 データの読み込み・加工 5.1.1 データの読み込み まずは、各観察日にそれぞれの個体を確認した時刻を記したデータシートを読み込む。 ## 確認した時間 female_time &lt;- read_csv(&quot;../Data/data/others/female_pre_time.csv&quot;) %&gt;% mutate(date = as_date(date)) データは以下の通り。2018年交尾期から2022年交尾期まで、6歳以上の個体の確認時刻が記入されている。分析には、2019年交尾期から2022年非交尾期までのデータを用いる。 ?: 確認されたが確認時刻は不明 DD: 死亡 NS: そのとき5歳以下 NA: 確認できず datatable(female_time, options = list(scrollX = 50)) 個体の属性を記したデータシートも読み込む。 #個体の属性情報 att &lt;- read_csv(&quot;../Data/data/others/attributes_sp_over6.csv&quot;) 各調査期間における年齢と順位が記されている。 datatable(att) 5.1.2 データの加工 メスの確認時刻のデータを縦型に変換し、分析のためにデータを加工・成型する。 female_time %&gt;% pivot_longer(cols = Kur:Cur, names_to = &quot;femaleID&quot;, values_to = &quot;presence&quot;) %&gt;% mutate(date = as_date(date)) %&gt;% ## 2022交尾期のデータは含めない filter(date &lt;= &quot;2022-08-31&quot;) %&gt;% ## 調査期間の情報を追加 left_join(group_all %&gt;% select(date, study_period) %&gt;% distinct(date, study_period)) %&gt;% left_join(att, by = c(&quot;study_period&quot;,&quot;femaleID&quot;)) -&gt; female_time_long female_time_long %&gt;% ## 死亡個体(DD)と確認時間不明個体(?)、非対象個体(6歳未満)(NS)は除く filter((presence != &quot;?&quot; &amp; presence != &quot;DD&quot; &amp; presence != &quot;NS&quot;)| is.na(presence)) %&gt;% ## 確認時刻をdatetime形式に mutate(found_time = str_c(date,&quot; &quot;, presence)) %&gt;% mutate(found_time = as_datetime(found_time)) %&gt;% ## 確認の有無についての列を作成 mutate(confirmed = ifelse(is.na(presence),0,1)) %&gt;% mutate(date = as_date(date)) %&gt;% ## 1日前の日付を表す列を作成 mutate(date_pre = date-1) -&gt; female_time_long_b 分析には、3通りのデータを用いた。 前日に全頭確認でき、かつその日も全頭確認できた日のみのデータ。前日に全頭確認できた日に限定したのは、分析対象日の前日に分派が生じており、分析対象の日の途中に分派していたサブグループが合流した、というような場合をできるだけ除外するためである。これにより、分派していない状態で全個体を探すのにかかる時間を可能な限り正確に推定できる。 2つ以上の集団を観察した日は、全頭確認している可能性のある大きい方の集団のデータを用いた。 途中で中断があり、中断以後に個体が見つかっている場合も除いた。 確認できない個体も含めた全個体のデータ。つまり、右側打ち切りの内、固定打ち切りのデータ(Allison, 2014)も含まれる。 2つ以上の集団を観察した日は大きい方の集団のデータを用いた。 扱いが難しいので、中断があった日は除く。 確認できた全個体のデータ 2つ以上の集団を観察した日は大きい方の集団のデータを用いた 扱いが難しいので、中断があった場合は再開以後に見つけた個体のデータは除く まず、1のためのデータを作成する。 ## 2つ以上の集団を観察した日に小さかった集団のID exc_groupID &lt;- c(&quot;m19_23&quot;,&quot;m19_24&quot;,&quot;m19_41&quot;,&quot;m19_53&quot;,&quot;m19_54&quot;,&quot;nm21_20&quot;,&quot;nm21_22&quot;,&quot;nm21_43&quot;,&quot;m20_52&quot;,&quot;m20_57&quot;,&quot;m21_35&quot;,&quot;m21_54&quot;) ## 各観察日の最大個体と確認個体数(確認時刻が記録できているメスのみ)を算出 female_time %&gt;% pivot_longer(cols = Kur:Cur, names_to = &quot;femaleID&quot;, values_to = &quot;presence&quot;) %&gt;% filter(is.na(presence)|(presence != &quot;DD&quot; &amp; presence != &quot;NS&quot;)) %&gt;% group_by(date) %&gt;% mutate(max_female = n()) %&gt;% distinct(date, max_female) -&gt; max_female group_all %&gt;% select(groupID, study_period, date, Kur:Yun) %&gt;% select(-c(TY,IT, LK,KR,KM,TG)) %&gt;% pivot_longer(cols = Kur:Yun, names_to = &quot;femaleID&quot;, values_to = &quot;presence&quot;) %&gt;% left_join(female_time_long_b %&gt;% select(-study_period, -presence), by = c(&quot;date&quot;,&quot;femaleID&quot;)) %&gt;% ## 6歳以上でかつ確認時刻が記録できている個体のみを抽出 filter(age &gt;= 6, confirmed == 1) %&gt;% ## groupIDごとに個体数を算出 group_by(date, groupID) %&gt;% summarise(no_female = sum(presence, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ## groupIDが上記のものは除く filter(!(groupID %in% exc_groupID)) %&gt;% left_join(max_female, by = &quot;date&quot;) -&gt; no_female ## 確認時刻データを結合する female_time_long_b %&gt;% ## 前日に全頭いたかの列を作成 left_join(no_female %&gt;% select(-groupID), by = c(&quot;date_pre&quot; = &quot;date&quot;)) %&gt;% mutate(inc = ifelse(no_female == max_female,1,0)) %&gt;% select(-max_female, -no_female) %&gt;% ## 当日に全頭いたかの列を作成 left_join(no_female, by = &quot;date&quot;) %&gt;% mutate(inc2 = ifelse(max_female == no_female,1,0)) %&gt;% ## 前日も当日も全頭確認できている日のみを抽出 filter(inc == 1 &amp; inc2 == 1) -&gt; female_time_anal ## 中断があり、中断以前に全頭が見つけられていない日は除く female_time_anal %&gt;% group_by(date, groupID) %&gt;% summarise(last_found = max(found_time)) %&gt;% ungroup() %&gt;% left_join(group_all %&gt;% select(1:6), by = c(&quot;groupID&quot;, &quot;date&quot;)) %&gt;% mutate(exclude = ifelse(is.na(suspend),0, ifelse(last_found &lt; suspend, 0, 1))) %&gt;% select(-last_found) -&gt; suspend_exclude female_time_anal %&gt;% left_join(suspend_exclude, by = c(&quot;date&quot;, &quot;groupID&quot;)) %&gt;% ## 中断以前に全頭見つかっていない日は除く（結果的に0） filter(exclude != 1) %&gt;% ## 各個体が開始から何分で見つかったか mutate(dur = as.numeric(found_time - start)/60) %&gt;% ## 各個体は何番目に見つかったか group_by(date) %&gt;% arrange(dur, .by_group = TRUE) %&gt;% mutate(N = 1:n()) %&gt;% ## その時間まで見つかっていた割合 mutate(prop = N/max_female) %&gt;% ungroup() %&gt;% ## 2018年交尾期のデータは用いない filter(study_period != &quot;m18&quot;) -&gt; female_time_anal_b データは以下の通り。 datatable(female_time_anal_b, options = list(scrollX = 60, filter = &quot;top&quot;)) 続いて、2のためのデータを作成する。群れが多数の小集団に分かれていたと思われる9月28~30日、雨で小屋前での観察だけだった2021年12月8日(確認時刻の記録がない)、確認個体の記録がない2022年3月28日のデータは除く。 exc_date &lt;- c(as_date(&quot;2019-09-28&quot;),as_date(&quot;2019-09-29&quot;), as_date(&quot;2019-09-30&quot;), as_date(&quot;2021-12-08&quot;), as_date(&quot;2022-03-28&quot;)) group_all %&gt;% select(groupID, study_period, start:fin, date, Kur:Yun) %&gt;% select(-c(TY,IT, LK,KR,KM,TG)) %&gt;% ## 縦型に変換 pivot_longer(cols = Kur:Yun, names_to = &quot;femaleID&quot;, values_to = &quot;presence&quot;) %&gt;% right_join(female_time_long_b %&gt;% select(-study_period, -presence), by = c(&quot;date&quot;,&quot;femaleID&quot;)) %&gt;% ## 2つ以上の集団を観察した場合、小さい方は除く filter(!(groupID %in% exc_groupID)) %&gt;% ## 上記の日付は除く filter(!(date %in% exc_date)) %&gt;% ## 中断がある日は除く filter(is.na(suspend)) %&gt;% ## 調査のない日は除く %&gt;% filter(!is.na(start)) %&gt;% ## 追跡時間 mutate(dur_follow = as.numeric(difftime(fin, start, units = &quot;mins&quot;))) %&gt;% ## 2018年交尾期のデータは用いない filter(study_period != &quot;m18&quot;) %&gt;% ## 各個体が開始から何分で見つかったか ## 見つかっていない場合は追跡時間 mutate(dur = ifelse(presence == 1, as.numeric(difftime(found_time, start, units = &quot;mins&quot;)), dur_follow)) %&gt;% ## 各個体は何番目に見つかったか group_by(date) %&gt;% arrange(dur, .by_group = TRUE) %&gt;% mutate(N = 1:n()) %&gt;% ungroup() %&gt;% left_join(no_female, by = c(&quot;date&quot;,&quot;groupID&quot;)) %&gt;% mutate(prop = N/max_female) %&gt;% ## 複数の集団を発見したとき、小さい集団にいた方の個体のconfirmedを0にする mutate(confirmed = ifelse(confirmed == 1 &amp; presence == 0, presence, confirmed)) -&gt; female_time_anal_all データは以下の通り。 datatable(female_time_anal_all, options = list(scrollX = 60, filter = &quot;top&quot;)) 最後に、3のためのデータを作成する。群れが多数の小集団に分かれていたと思われる9月28~30日、雨で小屋前での観察だけだった2021年12月8日(確認時刻の記録がない)、確認個体の記録がない2022年3月28日のデータは除く。 exc_date &lt;- c(as_date(&quot;2019-09-28&quot;),as_date(&quot;2019-09-29&quot;), as_date(&quot;2019-09-30&quot;), as_date(&quot;2021-12-08&quot;), as_date(&quot;2022-03-28&quot;)) group_all %&gt;% select(groupID, study_period, start:fin, date, Kur:Yun) %&gt;% select(-c(TY,IT, LK,KR,KM,TG)) %&gt;% ## 縦型に変換 pivot_longer(cols = Kur:Yun, names_to = &quot;femaleID&quot;, values_to = &quot;presence&quot;) %&gt;% right_join(female_time_long_b %&gt;% select(-study_period, -presence), by = c(&quot;date&quot;,&quot;femaleID&quot;)) %&gt;% ## 2つ以上の集団を観察した場合、小さい方は除く filter(!(groupID %in% exc_groupID)) %&gt;% ## 上記の日付は除く filter(!(date %in% exc_date)) %&gt;% ## 中断以後に見つけた個体は除く filter(is.na(suspend)|found_time &lt;= suspend) %&gt;% ## 調査のない日は除く %&gt;% filter(!is.na(start)) %&gt;% ## 追跡時間 mutate(dur_follow = as.numeric(difftime(fin, start, units = &quot;mins&quot;))) %&gt;% ## 2018年交尾期のデータは用いない filter(study_period != &quot;m18&quot;) %&gt;% ## 各個体が開始から何分で見つかったか ## 見つかっていない場合は追跡時間 mutate(dur = ifelse(presence == 1, as.numeric(difftime(found_time, start, units = &quot;mins&quot;)), dur_follow)) %&gt;% left_join(no_female, by = c(&quot;date&quot;,&quot;groupID&quot;)) %&gt;% ## 複数の集団を発見したとき、小さい集団にいた方の個体のconfirmedを0にする mutate(confirmed = ifelse(confirmed == 1 &amp; presence == 0, presence, confirmed)) %&gt;% filter(confirmed == 1) -&gt; female_time_anal_all_pre データは以下の通り。 datatable(female_time_anal_all_pre, options = list(scrollX = 60, filter = &quot;top&quot;)) 5.2 生存時間分析 5.2.1 全頭確認できた日のみ 5.2.1.1 データの確認 分析の前に、データを図示する。縦軸には累積確認個体数と累積確認個体割合をとる。 female_time_anal_b %&gt;% ggplot(aes(x= dur, y = N))+ geom_step(aes(color = study_period, group = date))+ theme_bw(base_size = 16)+ labs(y = &quot;Cumulative number of \\nconfirmed individuals&quot;)+ theme(aspect.ratio = 1, axis.title.y = element_text(family = &quot;Arial&quot;), legend.position = &quot;none&quot;) -&gt; p_cumsum female_time_anal_b %&gt;% ggplot(aes(x= dur, y = prop))+ geom_step(aes(color = study_period, group = date))+ theme_bw(base_size = 16)+ labs(y = &quot;Cumulative proportion of \\nconfirmed individuals&quot;)+ theme(aspect.ratio = 1, axis.title.y = element_text(family = &quot;Arial&quot;)) -&gt; p_prop p_cumsum_allind &lt;- p_cumsum + p_prop p_cumsum_allind # ggsave(&quot;figures/p_cumsum_allind.png&quot;, p_cumsum_allind, # width = 240, height = 120, dpi = 600, units = &quot;mm&quot;) 最後の個体が見つかるまでにかかる時間の分布は以下の通り。 female_time_anal_b %&gt;% group_by(date) %&gt;% summarise(last_time = max(dur)) %&gt;% ungroup() -&gt; last_time count &lt;- hist(last_time$last_time,breaks = seq(0,620,10), plot = F) cumsum &lt;- data.frame(x = count$breaks[-63], cumsum = (cumsum(count$counts)/max(cumsum(count$counts)))*10) ggplot(last_time, aes(x = last_time))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;, binwidth = 10)+ geom_line(data = cumsum, aes(x = x, y = cumsum), color = &quot;red2&quot;, linetype = &quot;dashed&quot;)+ theme_bw(base_size = 16)+ theme(aspect.ratio = 1)+ scale_y_continuous(name = &quot;Frequency&quot;, breaks = seq(0,10.2), sec.axis= sec_axis(name = &quot;Cumulative density&quot;, trans = ~.*0.1, breaks = seq(0,1,0.1)))+ labs(x = &quot;Time elapsed until the last individual&quot;) 5.2.1.2 コックス比例ハザードモデル まずは、brmsパッケージを用いてコックス比例ハザードモデルを適用する。コックス比例ハザードモデルについての解説は、こちらや筆者がまとめた資料を参照。 5.2.1.2.1 モデリング コックス比例ハザードモデルは以下のような形をとる。なお、\\(h(t)\\)はハザード関数を表す。\\(h_0(t)\\)は基準ハザード関数と呼ばれ、経過時間\\(t\\)のみの関数である。なお、\\(\\gamma_i\\)と\\(\\delta_j\\)はそれぞれ日付とメスIDのランダム切片を表す。\\(age_{ijk}\\)は、\\(i\\)番目の日付の\\(j\\)番目のメスのデータを表す。分析に用いるのは、2019年非交尾期(\\(nm19\\))、2019年交尾期(\\(m19\\))、2020年交尾期(\\(m20\\))、2021年非交尾期(\\(nm21\\))、2021年交尾期(\\(m21\\))、2022年非交尾期(\\(nm22\\))で、それぞれの変数は各調査期間かを表すダミー変数である。事前分布はbrmsパッケージのデフォルトである。 \\[ \\begin{aligned} &amp;h(t)_{ij} = h_0(t) exp(\\beta_1 \\times age_{ij} + \\beta_2 \\times rank_{ij} + \\beta_3 \\times nm19_{ij} + \\beta_4 \\times m19_{ij} + \\\\&amp; \\;\\;\\;\\;\\;\\;\\;\\; \\beta_5 \\times m20_{ij} + \\beta_6 \\times nm21_{ij} +\\beta_7 \\times m21_{ij} + \\beta_8 \\times nm22_{ij} + \\gamma_i + \\delta_j)\\\\ &amp; \\gamma_i \\sim Normal(0, \\sigma_{\\gamma})\\\\ &amp; \\delta_j \\sim Normal(0, \\sigma_{\\delta})\\\\ \\end{aligned} \\] Rでは以下のように実行する。 female_time_anal_b %&gt;% mutate(date = as.factor(date)) -&gt; female_time_anal_b mod_cox &lt;- brm(dur | cens(1 - confirmed) ~ 0 + study_period + age + rank + (1|date) + (1|femaleID), data = female_time_anal_b, iter = 5000, warmup = 2500, family = brmsfamily(&quot;cox&quot;), backend = &quot;cmdstanr&quot;, file = &quot;model/mod_cox&quot;) 結果は以下の通り。順位が低いほど有意に見つかりにくいという関係があるよう。 posterior_summary(mod_cox) %&gt;% head(8) %&gt;% data.frame() %&gt;% mutate(across(1:4, ~round(.,3))) 調査期間ごとの係数の差の事後分布を調べたところ、いずれも95%確信区間に0を含んでおり、調査期間ごとに有意な差はなさそうなことが分かる。 posterior_samples(mod_cox) %&gt;% select(1:6) %&gt;% mutate(m19_m20 = b_study_periodm19 - b_study_periodm20, m19_m21 = b_study_periodm19 - b_study_periodm21, m19_nm19 = b_study_periodm19 - b_study_periodnm19, m19_nm21 = b_study_periodm19 - b_study_periodnm21, m19_nm22 = b_study_periodm19 - b_study_periodnm22, m20_m21 = b_study_periodm20 - b_study_periodm21, m20_nm19 = b_study_periodm20 - b_study_periodnm19, m20_nm21 = b_study_periodm20 - b_study_periodnm21, m20_nm22 = b_study_periodm20 - b_study_periodnm22, m21_nm19 = b_study_periodm21 - b_study_periodnm19, m21_nm21 = b_study_periodm21 - b_study_periodnm21, m21_nm22 = b_study_periodm21 - b_study_periodnm22, nm19_nm21 = b_study_periodnm19 - b_study_periodnm21, nm19_nm22 = b_study_periodnm19 - b_study_periodnm22, nm21_nm22 = b_study_periodnm21 - b_study_periodnm22) %&gt;% select(-(1:6)) %&gt;% pivot_longer(everything()) %&gt;% group_by(name) %&gt;% summarise(mean = mean(value), lower = quantile(value, 0.025), upper = quantile(value, 0.975)) %&gt;% mutate(across(where(is.numeric), ~round(.,3))) %&gt;% separate(name, sep = &quot;_&quot;, into = c(&quot;Level1&quot;, &quot;Level2&quot;)) 5.2.1.3 離散時間モデル 続いて、離散時間モデル(Allison, 2014)を適用する。離散時間モデルについては、こちらや筆者がまとめた資料を参照。 5.2.1.3.1 データの加工 まず、データを加工する必要がある。 female_time_anal_b %&gt;% mutate(max_dur = as.numeric(fin - start)*60) %&gt;% group_by(date, femaleID) %&gt;% tidyr::expand(time = 1:max_dur) %&gt;% ungroup() -&gt; female_dur_all female_dur_all %&gt;% left_join(female_time_anal_b, by = c(&quot;date&quot;,&quot;femaleID&quot;)) %&gt;% filter(time &lt;= dur) %&gt;% mutate(confirmed = ifelse(time == dur,1,0)) -&gt; female_time_dcr 5.2.1.3.2 モデリング それでは、モデリングを行う。モデル式は以下の通り。なお、tは群れ発見からの経過時刻、confirmedは確認されたか否かを表す。連続変数はすべて標準化している。 応答変数: メスが確認されたか否か(\\(confirmed\\)) 説明変数: 群れ発見からの経過時間(\\(t, t^2, t^3\\))、調査期間(\\(nm19, \\dots, nm22\\))、順位(\\(rank_std\\))、年齢(\\(age_std\\)) ランダム切片: メスID(\\(delta_j\\))、日付(\\(gamma_i\\)) 分布: ベルヌーイ分布 リンク関数: logit関数 事前分布 切片、回帰係数: \\(student\\_t(4,0,10)\\) ランダム切片の標準偏差: \\(student\\_t(4,0,5)\\) \\[ \\begin{aligned} &amp;confirmed_{ij} \\sim Bernoulli(p_{ij}) \\\\ log\\biggl(\\frac{p_{ij}}{1-p_{ij}}\\biggl) &amp;= \\beta_0 + \\beta_1 t_{ij} + \\beta_2 t_{ij}^2 + \\beta_3 t^3_{ij} + \\beta_4 nm19_{ij} + \\beta_5 m19_{ij} + \\beta_6 m20_{ij} + \\\\ &amp; \\beta_7 nm21_{ij} + \\beta_8 m21_{ij} + \\beta_9 nm22_{ij} + \\beta_{10} rank\\_std + \\\\&amp; \\beta_{11} age_std_{ij} + \\gamma_i + \\delta_j \\\\ &amp;\\gamma_i \\sim Normal(0, \\sigma_{\\gamma}) \\\\ &amp;\\delta_j \\sim Normal(0, \\sigma_{\\delta}) \\\\ \\end{aligned} \\] Rでは以下のように実行する。時間(\\(time\\))の一次の項のみを含むもの、二次までの項を含むもの、三次までの項を含むものを実行する。 female_time_dcr &lt;- female_time_dcr %&gt;% mutate(date = as.factor(date)) %&gt;% mutate(age_std = standardize(age), time_scaled = time/max(time)) %&gt;% group_by(study_period) %&gt;% mutate(rank_scaled = rank/max(rank)) %&gt;% ungroup() %&gt;% mutate(rank_std = standardize(rank_scaled)) ## 1次のみ mod_dcr &lt;- brm(confirmed ~ study_period + time + rank_std + age_std + (1|date) + (1|femaleID), data = female_time_dcr, family = &quot;bernoulli&quot;, iter = 11000, warmup = 6000, seed = 13, prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd)), control=list(adapt_delta = 0.999, max_treedepth = 20), backend = &quot;cmdstanr&quot;, file = &quot;model/mod_dcr&quot;) ## 2次まで mod_dcr2 &lt;- brm(confirmed ~ study_period + poly(time, 2, raw = FALSE) + rank_std + age_std + (1|date) + (1|femaleID), data = female_time_dcr, family = &quot;bernoulli&quot;, iter = 11000, warmup = 6000, seed = 123, prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd, lb = 0)), control=list(adapt_delta = 0.99, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/mod_dcr2&quot;) ## 3次まで mod_dcr3 &lt;- brm(confirmed ~ study_period + poly(time, 3, raw = FALSE) + rank_std + age_std + (1|date) + (1|femaleID), data = female_time_dcr, family = &quot;bernoulli&quot;, iter = 11000, warmup = 6000, seed = 123, prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd, lb = 0)), control=list(adapt_delta = 0.99, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/mod_dcr3&quot;) 5.2.1.3.3 モデルのチェック 続いて、モデルチェックを行う。まず、DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。いずれのモデルでも特に問題はないよう。 dharma_dcr &lt;- dh_check_brms(mod_dcr, quantreg = TRUE) dharma_dcr2 &lt;- dh_check_brms(mod_dcr2, quantreg = TRUE) dharma_dcr3 &lt;- dh_check_brms(mod_dcr3, quantreg = TRUE) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ppcheck_dcr &lt;- pp_check(mod_dcr, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 1)+ guides(color = &quot;none&quot;) ppcheck_dcr2 &lt;- pp_check(mod_dcr2, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 1)+ guides(color = &quot;none&quot;) ppcheck_dcr3 &lt;- pp_check(mod_dcr3, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 1) ppcheck_dcr + ppcheck_dcr2 + ppcheck_dcr3 多重共線性の問題もない。 check_collinearity(mod_dcr) check_collinearity(mod_dcr2) check_collinearity(mod_dcr3) 5.2.1.3.4 結果の確認 推定結果は以下の通り。収束などの問題はないよう。いずれのモデルでも順位は有意な影響を持っているよう。 model_parameters(mod_dcr) %&gt;% data.frame() %&gt;% mutate(&quot;95%CI&quot; = str_c(&quot;[&quot;,sprintf(&quot;%.2f&quot;,CI_low),&quot;,&quot;,sprintf(&quot;%.2f&quot;,CI_high),&quot;]&quot;)) %&gt;% select(c(1,2,9,7,8)) model_parameters(mod_dcr2) %&gt;% data.frame() %&gt;% mutate(&quot;95%CI&quot; = str_c(&quot;[&quot;,sprintf(&quot;%.2f&quot;,CI_low),&quot;,&quot;,sprintf(&quot;%.2f&quot;,CI_high),&quot;]&quot;)) %&gt;% select(c(1,2,9,7,8)) model_parameters(mod_dcr3) %&gt;% data.frame() %&gt;% mutate(&quot;95%CI&quot; = str_c(&quot;[&quot;,sprintf(&quot;%.2f&quot;,CI_low),&quot;,&quot;,sprintf(&quot;%.2f&quot;,CI_high),&quot;]&quot;)) %&gt;% select(c(1,2,9,7,8)) 多重比較の結果、いずれのモデルでも調査期間によって有意な違いはなかった。 estimate_contrasts(mod_dcr, contrast = &quot;study_period&quot;) %&gt;% data.frame() %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(., 3))) %&gt;% mutate(model = &quot;model1&quot;) %&gt;% bind_rows(estimate_contrasts(mod_dcr2, contrast = &quot;study_period&quot;) %&gt;% data.frame() %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(., 3))) %&gt;% mutate(model = &quot;model2&quot;)) %&gt;% bind_rows(estimate_contrasts(mod_dcr3, contrast = &quot;study_period&quot;) %&gt;% data.frame() %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(., 3))) %&gt;% mutate(model = &quot;model3&quot;)) %&gt;% select(model, everything(), -pd) %&gt;% flextable() %&gt;% colformat_double(digits=2) %&gt;% set_table_properties(layout=&quot;autofit&quot;,width = 1) %&gt;% autofit(add_w = 0.2) %&gt;% merge_v(j = &quot;model&quot;) %&gt;% theme_zebra() .cl-f1fdc3a4{table-layout:auto;width:100%;}.cl-f1f4e568{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f1f4e572{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f1f84ac8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f1f84ad2{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f1f8695e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f86968{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f86969{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f8696a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f86972{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f86973{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f86974{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f8697c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f8697d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f8697e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f86986{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f86987{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f86990{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f86991{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f86992{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f86993{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f8699a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f869a4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f869a5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f869a6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f869a7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f869ae{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f869af{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f869b0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f1f869b1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}modelLevel1Level2DifferenceCI_lowCI_highmodel1nm19m190.24-0.200.69nm19m200.02-0.420.45nm19nm21-0.12-0.480.23nm19m21-0.06-0.550.43nm19nm22-0.02-0.350.32m19m20-0.22-0.740.28m19nm21-0.36-0.800.08m19m21-0.30-0.860.26m19nm22-0.26-0.690.17m20nm21-0.14-0.580.29m20m21-0.08-0.630.48m20nm22-0.03-0.460.38nm21m210.06-0.430.55nm21nm220.10-0.240.45m21nm220.04-0.430.52model2nm19m190.26-0.160.68nm19m200.06-0.350.49nm19nm21-0.08-0.430.26nm19m21-0.03-0.520.46nm19nm220.02-0.300.35m19m20-0.20-0.680.31m19nm21-0.34-0.770.08m19m21-0.29-0.830.26m19nm22-0.24-0.640.17m20nm21-0.14-0.570.28m20m21-0.09-0.640.45m20nm22-0.04-0.450.36nm21m210.05-0.430.54nm21nm220.10-0.230.44m21nm220.05-0.420.52model3nm19m190.25-0.180.69nm19m200.07-0.360.50nm19nm21-0.08-0.440.27nm19m21-0.02-0.510.45nm19nm220.02-0.300.35m19m20-0.18-0.690.31m19nm21-0.34-0.780.10m19m21-0.28-0.840.27m19nm22-0.23-0.660.18m20nm21-0.15-0.600.28m20m21-0.09-0.650.45m20nm22-0.05-0.460.37nm21m210.06-0.440.55nm21nm220.10-0.230.44m21nm220.04-0.420.53 5.2.1.3.5 結果の図示 結果の図示すると以下のようになる。まずは、経過時間によるハザード率(= その時間まで見つからなかった各メスの発見確率)を図示すると以下のようになる。二次までの項を含むモデルと三次までの項を含むモデルはほとんど違いがなさそう。 # nd &lt;- tidyr::crossing(time = seq(0,750,by = 1), # rank_scaled = c(0,0.5,1), # age_std = mean(female_time_dcr$age_std), # study_period = c(&quot;m19&quot;,&quot;m20&quot;,&quot;m21&quot;,&quot;nm19&quot;,&quot;nm21&quot;,&quot;nm22&quot;)) %&gt;% # mutate(rank_std = (rank_scaled - mean(female_time_dcr$rank_scaled))/sd(female_time_dcr$rank_scaled)) # # fit_dcr &lt;- fitted(mod_dcr, # newdata = nd, # scale = &quot;response&quot;, # re_formula = NA) %&gt;% # bind_cols(nd) %&gt;% # arrange(study_period, rank_scaled, time) # # fit_dcr2 &lt;- fitted(mod_dcr2, # newdata = nd, # scale = &quot;response&quot;, # re_formula = NA) %&gt;% # bind_cols(nd) %&gt;% # arrange(study_period, rank_scaled, time) # # fit_dcr3 &lt;- fitted(mod_dcr3, # newdata = nd, # scale = &quot;response&quot;, # re_formula = NA) %&gt;% # bind_cols(nd) %&gt;% # arrange(study_period, rank_scaled, time) # # fit_dcr %&gt;% # mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% # ggplot(aes(x = time, y = Estimate))+ # geom_line(aes(color = rank_scaled, linetype = rank_scaled), # linewidth = 1)+ # scale_linetype_manual(values = c(&quot;dotted&quot;,&quot;solid&quot;,&quot;dashed&quot;))+ # geom_ribbon(aes(ymin = Q2.5, ymax = Q97.5, # fill = rank_scaled), # alpha = 0.1)+ # theme_bw(base_size = 15)+ # theme(aspect.ratio = 1, # strip.background = element_blank(), # axis.title = element_text(&quot;Arial&quot;), # axis.text = element_text(&quot;Arial&quot;), # strip.text = element_text(hjust = 0))+ # labs(x = &quot;Time spent&quot;, y = &quot;Probability of being confirmed&quot;) + # facet_rep_wrap(~study_period, # repeat.tick.labels = TRUE)+ # labs(title = &quot;一次の項のみ&quot;) -&gt; p_dcr1 # # fit_dcr2 %&gt;% # mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% # ggplot(aes(x = time, y = Estimate))+ # geom_line(aes(color = rank_scaled, linetype = rank_scaled), # linewidth = 1)+ # scale_linetype_manual(values = c(&quot;dotted&quot;,&quot;solid&quot;,&quot;dashed&quot;))+ # geom_ribbon(aes(ymin = Q2.5, ymax = Q97.5, # fill = rank_scaled), # alpha = 0.1)+ # theme_bw(base_size = 15)+ # theme(aspect.ratio = 1, # strip.background = element_blank(), # axis.title = element_text(&quot;Arial&quot;), # axis.text = element_text(&quot;Arial&quot;), # strip.text = element_text(hjust = 0))+ # labs(x = &quot;Time spent&quot;, y = &quot;Probability of being confirmed&quot;) + # facet_rep_wrap(~study_period, # repeat.tick.labels = TRUE)+ # labs(title = &quot;二次の項まで&quot;) -&gt; p_dcr2 # # fit_dcr3 %&gt;% # mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% # ggplot(aes(x = time, y = Estimate))+ # geom_line(aes(color = rank_scaled, linetype = rank_scaled), # linewidth = 1)+ # scale_linetype_manual(values = c(&quot;dotted&quot;,&quot;solid&quot;,&quot;dashed&quot;))+ # geom_ribbon(aes(ymin = Q2.5, ymax = Q97.5, # fill = rank_scaled), # alpha = 0.1)+ # theme_bw(base_size = 15)+ # theme(aspect.ratio = 1, # strip.background = element_blank(), # axis.title = element_text(&quot;Arial&quot;), # axis.text = element_text(&quot;Arial&quot;), # strip.text = element_text(hjust = 0))+ # labs(x = &quot;Time spent&quot;, y = &quot;Probability of being confirmed&quot;) + # facet_rep_wrap(~study_period, # repeat.tick.labels = TRUE)+ # labs(title = &quot;三次の項まで&quot;) -&gt; p_dcr3 # # p_dcr &lt;- p_dcr1 / p_dcr2 / p_dcr3 # # ggsave(&quot;figures/p_dcr.png&quot;, p_dcr, dpi = 600, # width = 220, height = 360, units = &quot;mm&quot;) 図5.1: その時間まで見つからなかった各メスの発見確率 続いて、データを用いて累積発見確率(ある時点までに見つかる累積確率)を図示すると以下のようになる。どの期間、順位の個体でもおよそ200分あれば95%以上の確率で見つかることが分かる。 # fit_dcr_b &lt;- fit_dcr %&gt;% # arrange(study_period, rank_scaled, time) %&gt;% # group_by(study_period, rank_scaled) %&gt;% # mutate(mean = 1 - cumprod(1-Estimate), # upper = 1 - cumprod(1-Q97.5), # lower = 1 - cumprod(1 - Q2.5)) %&gt;% # ungroup() # # fit_dcr2_b &lt;- fit_dcr2 %&gt;% # arrange(study_period, rank_scaled, time) %&gt;% # group_by(study_period, rank_scaled) %&gt;% # mutate(mean = 1 - cumprod(1-Estimate), # upper = 1 - cumprod(1-Q97.5), # lower = 1 - cumprod(1 - Q2.5)) %&gt;% # ungroup() # # fit_dcr3_b &lt;- fit_dcr3 %&gt;% # arrange(study_period, rank_scaled, time) %&gt;% # group_by(study_period, rank_scaled) %&gt;% # mutate(mean = 1 - cumprod(1-Estimate), # upper = 1 - cumprod(1-Q97.5), # lower = 1 - cumprod(1 - Q2.5)) %&gt;% # ungroup() # # fit_dcr_b %&gt;% # mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% # ggplot(aes(x = time, y = mean))+ # geom_line(aes(color = rank_scaled, # linetype = rank_scaled), # linewidth = 1)+ # scale_linetype_manual(values = c(&quot;dotted&quot;, &quot;solid&quot;, &quot;dashed&quot;))+ # geom_ribbon(aes(ymin = lower, # ymax = upper, # fill = rank_scaled), # alpha = 0.1)+ # theme_bw(base_size = 16)+ # theme(aspect.ratio = 1, # strip.background = element_blank(), # axis.title = element_text(&quot;Arial&quot;), # axis.text = element_text(&quot;Arial&quot;), # strip.text = element_text(hjust = 0))+ # facet_rep_wrap(~study_period, repeat.tick.labels = TRUE)+ # scale_x_continuous(breaks = seq(0,700, 200))+ # scale_y_continuous(breaks = seq(0,1,0.2))+ # labs(x = &quot;Time spent&quot;, y = &quot;Cumulative probability of being confirmed&quot;, # color = &quot;scaled rank&quot;, fill = &quot;scaled rank&quot;, # linetype = &quot;scaled rank&quot;)+ # labs(title = &quot;一次の項まで&quot;)+ # guides(linetype = guide_legend(override.aes = list(linewidth = 0.6))) -&gt; p_dcr1_cum # # fit_dcr2_b %&gt;% # mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% # ggplot(aes(x = time, y = mean))+ # geom_line(aes(color = rank_scaled, # linetype = rank_scaled), # linewidth = 1)+ # scale_linetype_manual(values = c(&quot;dotted&quot;, &quot;solid&quot;, &quot;dashed&quot;))+ # geom_ribbon(aes(ymin = lower, # ymax = upper, # fill = rank_scaled), # alpha = 0.1)+ # theme_bw(base_size = 16)+ # theme(aspect.ratio = 1, # strip.background = element_blank(), # axis.title = element_text(&quot;Arial&quot;), # axis.text = element_text(&quot;Arial&quot;), # strip.text = element_text(hjust = 0))+ # facet_rep_wrap(~study_period, repeat.tick.labels = TRUE)+ # scale_x_continuous(breaks = seq(0,700, 200))+ # scale_y_continuous(breaks = seq(0,1,0.2))+ # labs(x = &quot;Time spent&quot;, y = &quot;Cumulative probability of being confirmed&quot;, # color = &quot;scaled rank&quot;, fill = &quot;scaled rank&quot;, # linetype = &quot;scaled rank&quot;)+ # labs(title = &quot;二次の項まで&quot;) + # guides(linetype = guide_legend(override.aes = list(linewidth = 0.6))) -&gt; p_dcr2_cum # # fit_dcr3_b %&gt;% # mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% # ggplot(aes(x = time, y = mean))+ # geom_line(aes(color = rank_scaled, # linetype = rank_scaled), # linewidth = 1)+ # scale_linetype_manual(values = c(&quot;dotted&quot;, &quot;solid&quot;, &quot;dashed&quot;))+ # geom_ribbon(aes(ymin = lower, # ymax = upper, # fill = rank_scaled), # alpha = 0.1)+ # theme_bw(base_size = 16)+ # theme(aspect.ratio = 1, # strip.background = element_blank(), # axis.title = element_text(&quot;Arial&quot;), # axis.text = element_text(&quot;Arial&quot;), # strip.text = element_text(hjust = 0))+ # facet_rep_wrap(~study_period, repeat.tick.labels = TRUE)+ # scale_x_continuous(breaks = seq(0,700, 200))+ # scale_y_continuous(breaks = seq(0,1,0.2))+ # labs(x = &quot;Time spent&quot;, y = &quot;Cumulative probability of being confirmed&quot;, # color = &quot;scaled rank&quot;, fill = &quot;scaled rank&quot;, # linetype = &quot;scaled rank&quot;) + # labs(title = &quot;三次の項まで&quot;) + # guides(linetype = guide_legend(override.aes = list(linewidth = 0.6))) -&gt; p_dcr3_cum # # p_dcr_cum &lt;- p_dcr1_cum / p_dcr2_cum / p_dcr3_cum # # ggsave(&quot;figures/p_dcr_cum.png&quot;, p_dcr_cum, dpi = 600, # width = 220, height = 360, units = &quot;mm&quot;) # # ggsave(&quot;figures/p_dcr1_cum.png&quot;, p_dcr1_cum, dpi = 600, # width = 220, height = 150, units = &quot;mm&quot;) 図5.2: それぞれの時間までの累積発見確率 5.2.2 全個体のデータ 5.2.2.1 データの確認 分析の前に、データを図示する。縦軸には累積確認個体数と累積確認個体割合をとる。 female_time_anal_all %&gt;% filter(presence == 1) %&gt;% ggplot(aes(x= dur, y = N))+ geom_step(aes(color = study_period, group = date))+ theme_bw(base_size = 16)+ labs(y = &quot;Cumulative number of confirmed individuals&quot;)+ theme(aspect.ratio = 1, axis.title.y = element_text(family = &quot;Arial&quot;), legend.position = &quot;none&quot;) -&gt; p_cumsum_all female_time_anal_all %&gt;% filter(presence == 1) %&gt;% ggplot(aes(x= dur, y = prop))+ geom_step(aes(color = study_period, group = date))+ theme_bw(base_size = 16)+ labs(y = &quot;Cumulative proportion of confirmed individuals&quot;)+ theme(aspect.ratio = 1, axis.title.y = element_text(family = &quot;Arial&quot;)) -&gt; p_prop_all p_cumsum_all + p_prop_all 5.2.2.2 コックス比例ハザードモデル まずは、brmsパッケージを用いてコックス比例ハザードモデルを適用する。 5.2.2.2.1 モデリング コックス比例ハザードモデルは以下のような形をとる。モデル式は第5.2.1.2節と同じである。 Rでは以下のように実行する。 female_time_anal_all %&gt;% mutate(date = as.factor(date)) -&gt; female_time_anal_all_b mod_cox_all &lt;- brm(dur | cens(1 - confirmed) ~ 0 + study_period + age + rank + (1|date) + (1|femaleID), data = female_time_anal_all_b, iter = 11000, warmup = 6000, family = brmsfamily(&quot;cox&quot;), backend = &quot;cmdstanr&quot;, file = &quot;model/mod_cox_all&quot;) 結果は以下の通り。やはり順位が低いほど有意に見つかりにくいという関係があるよう。 posterior_summary(mod_cox_all) %&gt;% head(8) %&gt;% data.frame() %&gt;% mutate(across(1:4, ~round(.,3))) 調査期間ごとの係数の差の事後分布を調べたところ、いくつかの期間で有意な差があるよう。 posterior_samples(mod_cox_all) %&gt;% select(1:6) %&gt;% mutate(m19_m20 = b_study_periodm19 - b_study_periodm20, m19_m21 = b_study_periodm19 - b_study_periodm21, m19_nm19 = b_study_periodm19 - b_study_periodnm19, m19_nm21 = b_study_periodm19 - b_study_periodnm21, m19_nm22 = b_study_periodm19 - b_study_periodnm22, m20_m21 = b_study_periodm20 - b_study_periodm21, m20_nm19 = b_study_periodm20 - b_study_periodnm19, m20_nm21 = b_study_periodm20 - b_study_periodnm21, m20_nm22 = b_study_periodm20 - b_study_periodnm22, m21_nm19 = b_study_periodm21 - b_study_periodnm19, m21_nm21 = b_study_periodm21 - b_study_periodnm21, m21_nm22 = b_study_periodm21 - b_study_periodnm22, nm19_nm21 = b_study_periodnm19 - b_study_periodnm21, nm19_nm22 = b_study_periodnm19 - b_study_periodnm22, nm21_nm22 = b_study_periodnm21 - b_study_periodnm22) %&gt;% select(-(1:6)) %&gt;% pivot_longer(everything()) %&gt;% group_by(name) %&gt;% summarise(mean = mean(value), lower = quantile(value, 0.025), upper = quantile(value, 0.975)) %&gt;% mutate(across(where(is.numeric), ~round(.,3))) %&gt;% separate(name, sep = &quot;_&quot;, into = c(&quot;Level1&quot;, &quot;Level2&quot;)) 5.2.2.3 離散時間モデル 続いて、離散時間モデル(Allison, 2014)を適用する。 5.2.2.3.1 データの加工 まず、データを加工する必要がある。 female_time_anal_all %&gt;% group_by(date, femaleID) %&gt;% tidyr::expand(time = 1:dur_follow) %&gt;% ungroup() -&gt; female_dur_all_b female_dur_all_b %&gt;% left_join(female_time_anal_all, by = c(&quot;date&quot;,&quot;femaleID&quot;)) %&gt;% filter(time &lt;= dur) %&gt;% mutate(confirmed = ifelse(confirmed == 1, ifelse(time == dur,1,0), 0)) -&gt; female_time_dcr_all 5.2.2.3.2 モデリング それでは、モデリングを行う。モデル式は第5.2.1.3節と同じ。 Rでは以下のように実行する。時間(\\(time\\))の二次までの項を含むもの、三次までの項を含むものを実行する。 female_time_dcr_all &lt;- female_time_dcr_all %&gt;% mutate(date = as.factor(date)) %&gt;% mutate(age_std = standardize(age), time_scaled = time/max(time), time_std = standardize(time)) %&gt;% group_by(study_period) %&gt;% mutate(rank_scaled = rank/max(rank)) %&gt;% ungroup() %&gt;% mutate(rank_std = standardize(rank_scaled)) ## 2次まで mod_dcr2_all &lt;- brm(confirmed ~ study_period + poly(time, 2, raw = FALSE) + rank_std + age_std + (1|date) + (1|femaleID), data = female_time_dcr_all, family = &quot;bernoulli&quot;, iter = 11000, warmup = 6000, seed = 123, prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd, lb = 0)), control=list(adapt_delta = 0.99, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/mod_dcr2_all&quot;) ## 3次まで mod_dcr3_all &lt;- brm(confirmed ~ study_period + poly(time, 3, raw = FALSE) + rank_std + age_std + (1|date) + (1|femaleID), data = female_time_dcr_all, family = &quot;bernoulli&quot;, iter = 11000, warmup = 6000, seed = 123, prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd, lb = 0)), control=list(adapt_delta = 0.99, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/mod_dcr3_all&quot;) 5.2.2.3.3 モデルのチェック 続いて、モデルチェックを行う。まず、DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。 2次の項までを含むモデルでは外れ値があるよう。ただし、分布からのずれや過分散はないよう。 # dharma_dcr2_all &lt;- dh_check_brms(mod_dcr2_all, quantreg = TRUE) # saveRDS(dharma_dcr2_all, &quot;model/dharma_dcr2_all.rds&quot;) # dharma_dcr2_all &lt;- readRDS(&quot;model/dharma_dcr2_all.rds&quot;) # plot(dharma_dcr2_all, quantreg = TRUE) 3次の項まで含めた場合も同様。 # dharma_dcr3_all &lt;- dh_check_brms(mod_dcr3_all, quantreg = TRUE) # saveRDS(dharma_dcr3_all, &quot;model/dharma_dcr3_all.rds&quot;) # dharma_dcr3_all &lt;- readRDS(&quot;model/dharma_dcr3_all.rds&quot;) # plot(dharma_dcr3_all, quantreg = TRUE) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 # ppcheck_dcr2_all &lt;- pp_check(mod_dcr2_all, ndraws = 100)+ # theme_bw()+ # theme(aspect.ratio = 1)+ # guides(color = &quot;none&quot;) # # ggsave(&quot;figures/ppcheck_dcr2_all.png&quot;, ppcheck_dcr2_all, # dpi = 600, width = 120, height = 100, units = &quot;mm&quot;) # ppcheck_dcr3_all &lt;- pp_check(mod_dcr3_all, ndraws = 100)+ # theme_bw()+ # theme(aspect.ratio = 1) # ggsave(&quot;figures/ppcheck_dcr2_all.png&quot;, ppcheck_dcr2_all, # dpi = 600, width = 120, height = 100, units = &quot;mm&quot;) # ppcheck_dcr2 + ppcheck_dcr3 多重共線性の問題はない。 check_collinearity(mod_dcr2_all) check_collinearity(mod_dcr3_all) 5.2.2.3.4 結果の確認 推定結果は以下の通り。収束などの問題はないよう。3次の項はほとんど効果がない。 model_parameters(mod_dcr2_all) %&gt;% data.frame() %&gt;% mutate(&quot;95%CI&quot; = str_c(&quot;[&quot;,sprintf(&quot;%.2f&quot;,CI_low),&quot;,&quot;,sprintf(&quot;%.2f&quot;,CI_high),&quot;]&quot;)) %&gt;% select(c(1,2,9,7,8)) model_parameters(mod_dcr3_all) %&gt;% data.frame() %&gt;% mutate(&quot;95%CI&quot; = str_c(&quot;[&quot;,sprintf(&quot;%.2f&quot;,CI_low),&quot;,&quot;,sprintf(&quot;%.2f&quot;,CI_high),&quot;]&quot;)) %&gt;% select(c(1,2,9,7,8)) 5.2.2.3.5 結果の図示 結果の図示すると以下のようになる。まずは、経過時間によるハザード率(= その時間まで見つからなかった各メスの発見確率)を図示すると以下のようになる。二次までの項を含むモデルと三次までの項を含むモデルはほとんど違いがなさそう。 nd_all &lt;- tidyr::crossing(time = seq(0,750,by = 1), rank_scaled = c(0,0.5,1), age_std = mean(female_time_dcr_all$age_std), study_period = c(&quot;m19&quot;,&quot;m20&quot;,&quot;m21&quot;,&quot;nm19&quot;,&quot;nm21&quot;,&quot;nm22&quot;)) %&gt;% mutate(rank_std = (rank_scaled - mean(female_time_dcr_all$rank_scaled))/sd(female_time_dcr_all$rank_scaled)) ## 二次の項までを含むモデル # fit_dcr2_all &lt;- fitted(mod_dcr2_all, # newdata = nd_all, # scale = &quot;response&quot;, # re_formula = NA) %&gt;% # bind_cols(nd_all) %&gt;% # arrange(study_period, rank_scaled, time) # # saveRDS(fit_dcr2_all, &quot;model/fit_dcr2_all.rds&quot;) fit_dcr2_all &lt;- readRDS(&quot;model/fit_dcr2_all.rds&quot;) fit_dcr2_all %&gt;% mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% ggplot(aes(x = time, y = Estimate))+ geom_line(aes(color = rank_scaled, linetype = rank_scaled), linewidth = 1)+ scale_linetype_manual(values = c(&quot;dotted&quot;,&quot;solid&quot;,&quot;dashed&quot;))+ geom_ribbon(aes(ymin = Q2.5, ymax = Q97.5, fill = rank_scaled), alpha = 0.1)+ theme_bw(base_size = 15)+ theme(aspect.ratio = 1, strip.background = element_blank(), axis.title = element_text(&quot;Arial&quot;), axis.text = element_text(&quot;Arial&quot;), strip.text = element_text(hjust = 0))+ labs(x = &quot;Time spent&quot;, y = &quot;Probability of being confirmed&quot;) + facet_rep_wrap(~study_period, repeat.tick.labels = TRUE)+ labs(title = &quot;二次の項まで&quot;) -&gt; p_dcr2_all ## 3次までの項 # fit_dcr3_all &lt;- fitted(mod_dcr3_all, # newdata = nd_all, # scale = &quot;response&quot;, # re_formula = NA) %&gt;% # bind_cols(nd_all) %&gt;% # arrange(study_period, rank_scaled, time) # # saveRDS(fit_dcr3_all, &quot;model/fit_dcr3_all.rds&quot;) # fit_dcr3_all &lt;- readRDS(&quot;model/fit_dcr3_all.rds&quot;) fit_dcr3_all %&gt;% mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% ggplot(aes(x = time, y = Estimate))+ geom_line(aes(color = rank_scaled, linetype = rank_scaled), linewidth = 1)+ scale_linetype_manual(values = c(&quot;dotted&quot;,&quot;solid&quot;,&quot;dashed&quot;))+ geom_ribbon(aes(ymin = Q2.5, ymax = Q97.5, fill = rank_scaled), alpha = 0.1)+ theme_bw(base_size = 15)+ theme(aspect.ratio = 1, strip.background = element_blank(), axis.title = element_text(&quot;Arial&quot;), axis.text = element_text(&quot;Arial&quot;), strip.text = element_text(hjust = 0))+ labs(x = &quot;Time spent&quot;, y = &quot;Probability of being confirmed&quot;) + facet_rep_wrap(~study_period, repeat.tick.labels = TRUE)+ labs(title = &quot;三次の項まで&quot;) -&gt; p_dcr3_all p_dcr_all &lt;- p_dcr2_all / p_dcr3_all p_dcr_all # ggsave(&quot;figures/p_dcr2_all.png&quot;, # p_dcr2_all, width = 220, height = 120, units = &quot;mm&quot;, # dpi = 600) # ggsave(&quot;figures/p_dcr3_all.png&quot;, # p_dcr3_all, width = 220, height = 120, units = &quot;mm&quot;, # dpi = 600) # ggsave(&quot;figures/p_dcr3_all.png&quot;, # p_dcr3_all, width = 220, height = 120, units = &quot;mm&quot;, # dpi = 600) 続いて、データを用いて累積発見確率(ある時点までに見つかる累積確率)を図示すると以下のようになる。どの期間、順位の個体でもおよそ200分から300分で見つかる確率が頭打ちになることが分かる。 fit_dcr2_all_b &lt;- fit_dcr2_all %&gt;% arrange(study_period, rank_scaled, time) %&gt;% group_by(study_period, rank_scaled) %&gt;% mutate(mean = 1 - cumprod(1-Estimate), upper = 1 - cumprod(1-Q97.5), lower = 1 - cumprod(1 - Q2.5)) %&gt;% ungroup() fit_dcr3_all_b &lt;- fit_dcr3_all %&gt;% arrange(study_period, rank_scaled, time) %&gt;% group_by(study_period, rank_scaled) %&gt;% mutate(mean = 1 - cumprod(1-Estimate), upper = 1 - cumprod(1-Q97.5), lower = 1 - cumprod(1 - Q2.5)) %&gt;% ungroup() fit_dcr2_all_b %&gt;% mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% ggplot(aes(x = time, y = mean))+ geom_line(aes(color = rank_scaled, linetype = rank_scaled), linewidth = 1)+ scale_linetype_manual(values = c(&quot;dotted&quot;, &quot;solid&quot;, &quot;dashed&quot;))+ geom_ribbon(aes(ymin = lower, ymax = upper, fill = rank_scaled), alpha = 0.1)+ theme_bw(base_size = 16)+ theme(aspect.ratio = 1, strip.background = element_blank(), axis.title = element_text(&quot;Arial&quot;), axis.text = element_text(&quot;Arial&quot;), strip.text = element_text(hjust = 0))+ facet_rep_wrap(~study_period, repeat.tick.labels = TRUE)+ scale_x_continuous(breaks = seq(0,700, 200))+ scale_y_continuous(breaks = seq(0,1,0.2))+ labs(x = &quot;Time spent&quot;, y = &quot;Cumulative probability of being confirmed&quot;, color = &quot;scaled rank&quot;, fill = &quot;scaled rank&quot;, linetype = &quot;scaled rank&quot;)+ labs(title = &quot;二次の項まで&quot;) + guides(linetype = guide_legend(override.aes = list(linewidth = 0.6))) -&gt; p_dcr2_all_cum fit_dcr3_all_b %&gt;% mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% ggplot(aes(x = time, y = mean))+ geom_line(aes(color = rank_scaled, linetype = rank_scaled), linewidth = 1)+ scale_linetype_manual(values = c(&quot;dotted&quot;, &quot;solid&quot;, &quot;dashed&quot;))+ geom_ribbon(aes(ymin = lower, ymax = upper, fill = rank_scaled), alpha = 0.1)+ theme_bw(base_size = 16)+ theme(aspect.ratio = 1, strip.background = element_blank(), axis.title = element_text(&quot;Arial&quot;), axis.text = element_text(&quot;Arial&quot;), strip.text = element_text(hjust = 0))+ facet_rep_wrap(~study_period, repeat.tick.labels = TRUE)+ scale_x_continuous(breaks = seq(0,700, 200))+ scale_y_continuous(breaks = seq(0,1,0.2))+ labs(x = &quot;Time spent&quot;, y = &quot;Cumulative probability of being confirmed&quot;, color = &quot;scaled rank&quot;, fill = &quot;scaled rank&quot;, linetype = &quot;scaled rank&quot;) + labs(title = &quot;三次の項まで&quot;) + guides(linetype = guide_legend(override.aes = list(linewidth = 0.6))) -&gt; p_dcr3_all_cum p_dcr_all_cum &lt;- p_dcr2_all_cum + p_dcr3_all_cum p_dcr_all_cum # ggsave(&quot;figures/p_dcr2_all_cum.png&quot;, p_dcr2_all_cum, dpi = 600, # width = 220, height = 360, units = &quot;mm&quot;) # ggsave(&quot;figures/p_dcr3_all_cum.png&quot;, p_dcr3_all_cum, dpi = 600, # width = 220, height = 150, units = &quot;mm&quot;) 5.2.3 確認できた全個体のデータ 5.2.3.1 コックス比例ハザードモデル まずは、brmsパッケージを用いてコックス比例ハザードモデルを適用する。 5.2.3.1.1 モデリング コックス比例ハザードモデルは以下のような形をとる。モデル式は第5.2.1.2節と同じである。 Rでは以下のように実行する。 female_time_anal_all_pre %&gt;% mutate(date = as.factor(date)) -&gt; female_time_anal_all_pre_b mod_cox_all_pre &lt;- brm(dur | cens(1 - confirmed) ~ 0 + study_period + age + rank + (1|date) + (1|femaleID), data = female_time_anal_all_pre_b, iter = 11000, warmup = 6000, family = brmsfamily(&quot;cox&quot;), backend = &quot;cmdstanr&quot;, file = &quot;model/mod_cox_all_pre&quot;) 結果は以下の通り。やはり順位が低いほど有意に見つかりにくいという関係があるよう。 posterior_summary(mod_cox_all_pre) %&gt;% head(8) %&gt;% data.frame() %&gt;% mutate(across(1:4, ~round(.,3))) 調査期間ごとの係数の差の事後分布を調べたところ、いくつかの期間で有意な差があるよう。 posterior_samples(mod_cox_all_pre) %&gt;% select(1:6) %&gt;% mutate(m19_m20 = b_study_periodm19 - b_study_periodm20, m19_m21 = b_study_periodm19 - b_study_periodm21, m19_nm19 = b_study_periodm19 - b_study_periodnm19, m19_nm21 = b_study_periodm19 - b_study_periodnm21, m19_nm22 = b_study_periodm19 - b_study_periodnm22, m20_m21 = b_study_periodm20 - b_study_periodm21, m20_nm19 = b_study_periodm20 - b_study_periodnm19, m20_nm21 = b_study_periodm20 - b_study_periodnm21, m20_nm22 = b_study_periodm20 - b_study_periodnm22, m21_nm19 = b_study_periodm21 - b_study_periodnm19, m21_nm21 = b_study_periodm21 - b_study_periodnm21, m21_nm22 = b_study_periodm21 - b_study_periodnm22, nm19_nm21 = b_study_periodnm19 - b_study_periodnm21, nm19_nm22 = b_study_periodnm19 - b_study_periodnm22, nm21_nm22 = b_study_periodnm21 - b_study_periodnm22) %&gt;% select(-(1:6)) %&gt;% pivot_longer(everything()) %&gt;% group_by(name) %&gt;% summarise(mean = mean(value), lower = quantile(value, 0.025), upper = quantile(value, 0.975)) %&gt;% mutate(across(where(is.numeric), ~round(.,3))) %&gt;% separate(name, sep = &quot;_&quot;, into = c(&quot;Level1&quot;, &quot;Level2&quot;)) 5.2.3.2 離散時間モデル 続いて、離散時間モデル(Allison, 2014)を適用する。 5.2.3.2.1 データの加工 まず、データを加工する必要がある。 female_time_anal_all_pre %&gt;% group_by(date, femaleID) %&gt;% tidyr::expand(time = 1:dur_follow) %&gt;% ungroup() -&gt; female_dur_all_pre_b female_dur_all_pre_b %&gt;% left_join(female_time_anal_all_pre, by = c(&quot;date&quot;,&quot;femaleID&quot;)) %&gt;% filter(time &lt;= dur) %&gt;% mutate(confirmed = ifelse(confirmed == 1, ifelse(time == dur,1,0), 0)) -&gt; female_time_dcr_all_pre 5.2.3.2.2 モデリング それでは、モデリングを行う。モデル式は第5.2.1.3節と同じ。 Rでは以下のように実行する。時間(\\(time\\))の二次までの項を含むもの、三次までの項を含むものを実行する。 female_time_dcr_all_pre &lt;- female_time_dcr_all_pre %&gt;% mutate(date = as.factor(date)) %&gt;% mutate(age_std = standardize(age), time_scaled = time/max(time), time_std = standardize(time)) %&gt;% group_by(study_period) %&gt;% mutate(rank_scaled = rank/max(rank)) %&gt;% ungroup() %&gt;% mutate(rank_std = standardize(rank_scaled)) ## 2次まで mod_dcr2_all_pre &lt;- brm(confirmed ~ study_period + poly(time, 2, raw = FALSE) + rank_std + age_std + (1|date) + (1|femaleID), data = female_time_dcr_all_pre, family = &quot;bernoulli&quot;, iter = 11000, warmup = 6000, seed = 123, prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd, lb = 0)), control=list(adapt_delta = 0.99, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/mod_dcr2_all_pre&quot;) ## 3次まで mod_dcr3_all_pre &lt;- brm(confirmed ~ study_period + poly(time, 3, raw = FALSE) + rank_std + age_std + (1|date) + (1|femaleID), data = female_time_dcr_all_pre, family = &quot;bernoulli&quot;, iter = 11000, warmup = 6000, seed = 123, prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd, lb = 0)), control=list(adapt_delta = 0.99, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/mod_dcr3_all_pre&quot;) 5.2.3.2.3 モデルのチェック 続いて、モデルチェックを行う。まず、DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。 いずれのモデルでも外れ値が少しあるようだ。これは、遅い時間に見つかった個体が何個体かいるからだろう。過分散や分布からのずれはない。 dharma_dcr2_all_pre &lt;- dh_check_brms(mod_dcr2_all_pre, quantreg = TRUE) dharma_dcr3_all_pre &lt;- dh_check_brms(mod_dcr3_all_pre, quantreg = TRUE) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ppcheck_dcr2_all_pre &lt;- pp_check(mod_dcr2_all_pre)+ theme_bw()+ theme(aspect.ratio = 1)+ guides(color = &quot;none&quot;) ppcheck_dcr3_all_pre &lt;- pp_check(mod_dcr3_all_pre)+ theme_bw()+ theme(aspect.ratio = 1) ppcheck_dcr2_all_pre + ppcheck_dcr3_all_pre 多重共線性の問題はない。 check_collinearity(mod_dcr2_all_pre) check_collinearity(mod_dcr3_all_pre) 5.2.3.2.4 結果の確認 推定結果は以下の通り。収束などの問題はないよう。いずれのモデルでも時間と順位が有意な関連。 model_parameters(mod_dcr2_all_pre) %&gt;% data.frame() %&gt;% mutate(&quot;95%CI&quot; = str_c(&quot;[&quot;,sprintf(&quot;%.2f&quot;,CI_low),&quot;,&quot;,sprintf(&quot;%.2f&quot;,CI_high),&quot;]&quot;)) %&gt;% select(c(1,2,9,7,8)) model_parameters(mod_dcr3_all_pre) %&gt;% data.frame() %&gt;% mutate(&quot;95%CI&quot; = str_c(&quot;[&quot;,sprintf(&quot;%.2f&quot;,CI_low),&quot;,&quot;,sprintf(&quot;%.2f&quot;,CI_high),&quot;]&quot;)) %&gt;% select(c(1,2,9,7,8)) 5.2.3.2.5 結果の図示 結果の図示すると以下のようになる。まずは、経過時間によるハザード率(= その時間まで見つからなかった各メスの発見確率)を図示すると以下のようになる。 nd_all_pre &lt;- tidyr::crossing(time = seq(0,750,by = 1), rank_scaled = c(0,0.5,1), age_std = mean(female_time_dcr_all_pre$age_std), study_period = c(&quot;m19&quot;,&quot;m20&quot;,&quot;m21&quot;,&quot;nm19&quot;,&quot;nm21&quot;,&quot;nm22&quot;)) %&gt;% mutate(rank_std = (rank_scaled - mean(female_time_dcr_all_pre$rank_scaled))/ sd(female_time_dcr_all_pre$rank_scaled)) # 二次の項までを含むモデル # fit_dcr2_all_pre &lt;- fitted(mod_dcr2_all_pre, # newdata = nd_all_pre, # scale = &quot;response&quot;, # re_formula = NA) %&gt;% # bind_cols(nd_all_pre) %&gt;% # arrange(study_period, rank_scaled, time) # # saveRDS(fit_dcr2_all_pre, &quot;model/fit_dcr2_all_pre.rds&quot;) fit_dcr2_all_pre &lt;- readRDS(&quot;model/fit_dcr2_all_pre.rds&quot;) fit_dcr2_all_pre %&gt;% mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% ggplot(aes(x = time, y = Estimate))+ geom_line(aes(color = rank_scaled, linetype = rank_scaled), linewidth = 1)+ scale_linetype_manual(values = c(&quot;dotted&quot;,&quot;solid&quot;,&quot;dashed&quot;))+ geom_ribbon(aes(ymin = Q2.5, ymax = Q97.5, fill = rank_scaled), alpha = 0.1)+ theme_bw(base_size = 15)+ theme(aspect.ratio = 1, strip.background = element_blank(), axis.title = element_text(&quot;Arial&quot;), axis.text = element_text(&quot;Arial&quot;), strip.text = element_text(hjust = 0))+ labs(x = &quot;Time spent&quot;, y = &quot;Probability of being confirmed&quot;) + facet_rep_wrap(~study_period, repeat.tick.labels = TRUE)+ labs(title = &quot;二次の項まで&quot;) -&gt; p_dcr2_all_pre # 3次までの項 # fit_dcr3_all_pre &lt;- fitted(mod_dcr3_all_pre, # newdata = nd_all_pre, # scale = &quot;response&quot;, # re_formula = NA) %&gt;% # bind_cols(nd_all_pre) %&gt;% # arrange(study_period, rank_scaled, time) # saveRDS(fit_dcr3_all_pre, &quot;model/fit_dcr3_all_pre.rds&quot;) fit_dcr3_all_pre &lt;- readRDS(&quot;model/fit_dcr3_all_pre.rds&quot;) fit_dcr3_all_pre %&gt;% mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% ggplot(aes(x = time, y = Estimate))+ geom_line(aes(color = rank_scaled, linetype = rank_scaled), linewidth = 1)+ scale_linetype_manual(values = c(&quot;dotted&quot;,&quot;solid&quot;,&quot;dashed&quot;))+ geom_ribbon(aes(ymin = Q2.5, ymax = Q97.5, fill = rank_scaled), alpha = 0.1)+ theme_bw(base_size = 15)+ theme(aspect.ratio = 1, strip.background = element_blank(), axis.title = element_text(&quot;Arial&quot;), axis.text = element_text(&quot;Arial&quot;), strip.text = element_text(hjust = 0))+ labs(x = &quot;Time spent&quot;, y = &quot;Probability of being confirmed&quot;) + facet_rep_wrap(~study_period, repeat.tick.labels = TRUE)+ labs(title = &quot;三次の項まで&quot;) -&gt; p_dcr3_all_pre p_dcr_all_pre &lt;- p_dcr2_all_pre + p_dcr3_all_pre p_dcr_all_pre # ggsave(&quot;figures/p_dcr2_all_pre.png&quot;, # p_dcr2_all_pre, width = 220, height = 120, units = &quot;mm&quot;, # dpi = 600) # # ggsave(&quot;figures/p_dcr3_all_pre.png&quot;, # p_dcr3_all_pre, width = 220, height = 120, units = &quot;mm&quot;, # dpi = 600) 続いて、データを用いて累積発見確率(ある時点までに見つかる累積確率)を図示すると以下のようになる。どの期間、順位の個体でもおよそ200分から300分で見つかる確率が頭打ちになることが分かる。 fit_dcr2_all_pre_b &lt;- fit_dcr2_all_pre %&gt;% arrange(study_period, rank_scaled, time) %&gt;% group_by(study_period, rank_scaled) %&gt;% mutate(mean = 1 - cumprod(1-Estimate), upper = 1 - cumprod(1-Q97.5), lower = 1 - cumprod(1 - Q2.5)) %&gt;% ungroup() fit_dcr3_all_pre_b &lt;- fit_dcr3_all_pre %&gt;% arrange(study_period, rank_scaled, time) %&gt;% group_by(study_period, rank_scaled) %&gt;% mutate(mean = 1 - cumprod(1-Estimate), upper = 1 - cumprod(1-Q97.5), lower = 1 - cumprod(1 - Q2.5)) %&gt;% ungroup() fit_dcr2_all_pre_b %&gt;% mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% ggplot(aes(x = time, y = mean))+ geom_line(aes(color = rank_scaled, linetype = rank_scaled), linewidth = 1)+ scale_linetype_manual(values = c(&quot;dotted&quot;, &quot;solid&quot;, &quot;dashed&quot;))+ geom_ribbon(aes(ymin = lower, ymax = upper, fill = rank_scaled), alpha = 0.1)+ theme_bw(base_size = 16)+ theme(aspect.ratio = 1, strip.background = element_blank(), axis.title = element_text(&quot;Arial&quot;), axis.text = element_text(&quot;Arial&quot;), strip.text = element_text(hjust = 0))+ facet_rep_wrap(~study_period, repeat.tick.labels = TRUE)+ scale_x_continuous(breaks = seq(0,700, 200))+ scale_y_continuous(breaks = seq(0,1,0.2))+ labs(x = &quot;Time spent&quot;, y = &quot;Cumulative probability of being confirmed&quot;, color = &quot;scaled rank&quot;, fill = &quot;scaled rank&quot;, linetype = &quot;scaled rank&quot;)+ labs(title = &quot;二次の項まで&quot;) + guides(linetype = guide_legend(override.aes = list(linewidth = 0.6))) -&gt; p_dcr2_all_pre_cum fit_dcr3_all_pre_b %&gt;% mutate(rank_scaled = as.factor(rank_scaled)) %&gt;% ggplot(aes(x = time, y = mean))+ geom_line(aes(color = rank_scaled, linetype = rank_scaled), linewidth = 1)+ scale_linetype_manual(values = c(&quot;dotted&quot;, &quot;solid&quot;, &quot;dashed&quot;))+ geom_ribbon(aes(ymin = lower, ymax = upper, fill = rank_scaled), alpha = 0.1)+ theme_bw(base_size = 16)+ theme(aspect.ratio = 1, strip.background = element_blank(), axis.title = element_text(&quot;Arial&quot;), axis.text = element_text(&quot;Arial&quot;), strip.text = element_text(hjust = 0))+ facet_rep_wrap(~study_period, repeat.tick.labels = TRUE)+ scale_x_continuous(breaks = seq(0,700, 200))+ scale_y_continuous(breaks = seq(0,1,0.2))+ labs(x = &quot;Time spent&quot;, y = &quot;Cumulative probability of being confirmed&quot;, color = &quot;scaled rank&quot;, fill = &quot;scaled rank&quot;, linetype = &quot;scaled rank&quot;) + labs(title = &quot;三次の項まで&quot;) + guides(linetype = guide_legend(override.aes = list(linewidth = 0.6))) -&gt; p_dcr3_all_pre_cum p_dcr_all_pre_cum &lt;- p_dcr2_all_pre_cum + p_dcr3_all_pre_cum p_dcr_all_pre_cum # ggsave(&quot;figures/p_dcr2_all_pre_cum.png&quot;, p_dcr2_all_pre_cum, dpi = 600, # width = 220, height = 360, units = &quot;mm&quot;) # # ggsave(&quot;figures/p_dcr3_all_pre_cum.png&quot;, p_dcr3_all_pre_cum, dpi = 600, # width = 220, height = 150, units = &quot;mm&quot;) References Allison, P. D. (2014). Event history and survival analysis: Regression for longitudinal event data. SAGE Publications. Gabry, J., &amp; Mahr, T. (2022). Bayesplot: Plotting for bayesian models. https://mc-stan.org/bayesplot Hartig, F. (2022). DHARMa: Residual diagnostics for hierarchical (multi-level / mixed) regression models. https://CRAN.R-project.org/package=DHARMa Rodríguez-Sánchez, F. (2023). DHARMa.helpers: Helper functions to check models not (yet) directly supported by DHARMa. 生存時間解析についてはこちら。↩︎ "],["07_male_presence.html", "6 オスの確認状況の分析 6.1 データの加工 6.2 確認日数割合の図示 6.3 群れを離れた頻度の算出", " 6 オスの確認状況の分析 本章では、オスの確認状況についてまとめる。ここでは、一度でもその集団で確認されれば確認されたとみなす。 6.1 データの加工 まず、6歳以上のメスが50%以上確認できた集団(群れ本体)が240分以上追跡できた日のデータのみを抽出する。1日に2集団を観察し、移動などがあっていずれも50%以上のメスが確認された場合は、より大きい方の集団のデータを用いる。 まず条件を満たす集団のgroupIDを計算する。 group_all %&gt;% ## オスの列を除外 select(-c(TY,IT,KR,LK,KM,TG)) %&gt;% ## 縦型にする pivot_longer(Kur:Yun, names_to = &quot;femaleID&quot;, values_to = &quot;presence&quot;) %&gt;% ## メスの属性データの結合 left_join(att, by = c(&quot;femaleID&quot;, &quot;study_period&quot;)) %&gt;% ## 6歳以上のみ抽出 filter(age &gt;= 6) %&gt;% ## 日ごとの観察時間と確認個体数を算出 mutate(dur = ifelse(is.na(suspend), as.numeric(fin - start)/60, as.numeric((fin - start) - (restart - suspend))/60)) %&gt;% group_by(date, groupID, study_period) %&gt;% summarise(no_female = sum(presence, na.rm = TRUE), dur = unique(dur)) %&gt;% ungroup() %&gt;% drop_na(dur) %&gt;% ## 最大メス数のデータを結合 left_join(max_female) %&gt;% ## 確認メス割合が0.5以上を抽出 mutate(prop_female = no_female/max_female) %&gt;% filter(prop_female &gt;= 0.5) %&gt;% ## 2021年2月28日は&quot;nm21_23&quot;は用いない filter(groupID != &quot;nm21_23&quot;) %&gt;% ## 追跡時間240分以上 filter(dur &gt;= 240) %&gt;% mutate(study_period = fct_relevel(study_period, &quot;m18&quot;,&quot;nm19&quot;,&quot;m19&quot;,&quot;nm20&quot;, &quot;m20&quot;,&quot;nm21&quot;,&quot;m21&quot;,&quot;nm22&quot;))-&gt; no_female_over0.5 続いて、先ほどのデータにオスの確認状況のデータを結合し、調査期間ごとに確認日数割合を算出する。 no_female_over0.5 %&gt;% left_join(group_all %&gt;% select(groupID, TY, IT, KR, LK, KM, TG), by = &quot;groupID&quot;) %&gt;% ## 縦長にする pivot_longer(TY:TG, names_to = &quot;maleID&quot;, values_to = &quot;presence&quot;) %&gt;% ## 算出する group_by(study_period, maleID) %&gt;% summarise(sum = n(), n = sum(presence, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ## いなかった期間などを除外 mutate(sp_maleID = str_c(study_period,&quot;_&quot;,maleID)) %&gt;% filter(!(sp_maleID %in% c(&quot;m21_IT&quot;,&quot;m18_KM&quot;,&quot;m19_KM&quot;,&quot;m18_TG&quot;,&quot;m19_TG&quot;,&quot;nm22_IT&quot;, &quot;m20_LK&quot;,&quot;m21_LK&quot;,&quot;nm19_KM&quot;,&quot;nm19_TG&quot;, &quot;nm20_KM&quot;,&quot;nm20_TG&quot;, &quot;nm20_LK&quot;, &quot;nm21_LK&quot;, &quot;nm22_LK&quot;))) %&gt;% select(-sp_maleID) %&gt;% mutate(maleID = fct_relevel(maleID, &quot;TY&quot;, &quot;IT&quot;, &quot;LK&quot;, &quot;KR&quot;, &quot;KM&quot;, &quot;TG&quot;)) -&gt; male_presence_sum 6.2 確認日数割合の図示 6.2.1 表 まずは表で図示する。TYとITについては、2019年交尾期～2021年交尾期の5つの調査期間にわたって出席率が顕著に低くなっており、特に交尾期にその傾向が強い。 male_presence_sum %&gt;% mutate(prop = n/sum) %&gt;% mutate(p = str_c(sprintf(&quot;%.2f&quot;,prop),&quot;(&quot;,n,&quot;/&quot;,sum,&quot;)&quot;)) %&gt;% select(maleID, study_period,p) %&gt;% arrange(maleID, study_period) %&gt;% pivot_wider(names_from = &quot;study_period&quot;, values_from = &quot;p&quot;) %&gt;% arrange(maleID) %&gt;% ## KMとTGを含めるか filter(!(maleID %in% c(&quot;KM&quot;, &quot;TG&quot;))) %&gt;% flextable() %&gt;% theme_zebra() %&gt;% italic(j=1,part = &quot;body&quot;) %&gt;% font(j=2:9,part = &quot;all&quot;,fontname = &quot;Arial&quot;) %&gt;% font(j=1, part = &quot;body&quot;,fontname = &quot;Arial&quot;) %&gt;% colformat_double(digits = 2) %&gt;% autofit(add_w = 0) %&gt;% align(j=2:9, part = &quot;all&quot;, align = &quot;center&quot;) -&gt; table_male_presence table_male_presence .cl-f177edbc{}.cl-f16f7736{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f16f7754{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f16f775e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f172c382{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f172c38c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f172de44{width:0.686in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f172de4e{width:0.967in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f172de58{width:0.686in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f172de59{width:0.967in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f172de62{width:0.686in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f172de63{width:0.967in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}maleIDm18nm19m19nm20m20nm21m21nm22TY1.00(49/49)1.00(37/37)0.31(16/51)0.90(9/10)0.45(36/80)0.89(34/38)0.59(47/79)1.00(39/39)IT1.00(49/49)1.00(37/37)0.41(21/51)0.90(9/10)0.42(34/80)0.79(30/38)LK0.98(48/49)0.95(35/37)1.00(51/51)KR1.00(49/49)0.97(36/37)1.00(51/51)1.00(10/10)1.00(80/80)0.95(36/38)1.00(79/79)1.00(39/39) #save_as_image(table_male_presence, &quot;tables/table_male_presence.png&quot;, res = 600) 6.2.2 グラフ 続いて、確認日数割合のグラフを作成する。 male_presence_sum %&gt;% mutate(prop = n/sum) %&gt;% mutate(p = str_c(sprintf(&quot;%.2f&quot;,prop),&quot;(&quot;,n,&quot;/&quot;,sum,&quot;)&quot;)) %&gt;% mutate(season = ifelse(str_detect(study_period, &quot;nm&quot;), &quot;nm&quot;,&quot;m&quot;)) %&gt;% ## KMとTGを含めるか filter(!(maleID %in% c(&quot;KM&quot;, &quot;TG&quot;))) %&gt;% ggplot(aes(x = study_period, y = prop))+ geom_col(aes(color = season,fill= season))+ scale_fill_manual(values = c(&quot;orange&quot;, &quot;palegreen4&quot;), label = c(&quot;mating(m)&quot;,&quot;nonmating(nm)&quot;))+ scale_color_manual(values = c(&quot;orange&quot;, &quot;palegreen4&quot;), label = c(&quot;mating(m)&quot;,&quot;nonmating(nm)&quot;))+ labs(y = &quot;Proportion of confirmed days&quot;,x=&quot;&quot;)+ theme_bw(base_size = 16)+ theme(axis.text = element_text(family = &quot;Arial&quot;), aspect.ratio = 0.6, axis.title.y = element_text(family = &quot;Arial&quot;), strip.background = element_blank(), strip.text.x = element_text(face = &quot;bold.italic&quot;, hjust=0, family = &quot;Arial&quot;), axis.ticks.x = element_blank(), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12, angle = -45, vjust = -0.5), legend.text = element_text(family = &quot;Yu Gothic&quot;))+ geom_text(aes(label = str_c(n,&quot;/&quot;,sum), y = prop + 0.07, family = &quot;Arial&quot;), size = 3)+ labs(fill = &quot;&quot;,color = &quot;&quot;)+ scale_y_continuous(expand = c(0,0), breaks = seq(0,1,0.25))+ coord_cartesian(ylim = c(0,1.13))+ facet_rep_wrap(~maleID, repeat.tick.labels = &quot;TRUE&quot;, ncol = 2) -&gt; p_male_presence p_male_presence # ggsave(&quot;figures/p_male_presence.png&quot;, dpi = 600, width = 240, height = 145, units = &quot;mm&quot;) TYとITのみについてグラフを書くと以下のようになる。 male_presence_sum %&gt;% mutate(prop = n/sum) %&gt;% mutate(p = str_c(sprintf(&quot;%.2f&quot;,prop),&quot;(&quot;,n,&quot;/&quot;,sum,&quot;)&quot;)) %&gt;% mutate(season = ifelse(str_detect(study_period, &quot;nm&quot;), &quot;nm&quot;,&quot;m&quot;)) %&gt;% ## TYとITのみ含める filter(maleID %in% c(&quot;TY&quot;, &quot;IT&quot;)) %&gt;% ggplot(aes(x = study_period, y = prop))+ geom_col(aes(color = season,fill= season))+ scale_fill_manual(values = c(&quot;orange&quot;, &quot;palegreen4&quot;), label = c(&quot;mating(m)&quot;,&quot;nonmating(nm)&quot;))+ scale_color_manual(values = c(&quot;orange&quot;, &quot;palegreen4&quot;), label = c(&quot;mating(m)&quot;,&quot;nonmating(nm)&quot;))+ labs(y = &quot;Proportion of confirmed days&quot;,x=&quot;&quot;)+ theme_bw(base_size = 16)+ theme(axis.text = element_text(family = &quot;Arial&quot;), aspect.ratio = 0.8, axis.title.y = element_text(family = &quot;Arial&quot;, size = 12.5), strip.background = element_blank(), strip.text.x = element_text(face = &quot;bold.italic&quot;, hjust=0, family = &quot;Arial&quot;), axis.ticks.x = element_blank(), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12, angle = -45, vjust = -0.5), legend.text = element_text(family = &quot;Yu Gothic&quot;))+ geom_text(aes(label = str_c(n,&quot;/&quot;,sum), y = prop + 0.07, family = &quot;Arial&quot;), size = 3)+ labs(fill = &quot;&quot;,color = &quot;&quot;)+ scale_y_continuous(expand = c(0,0), breaks = seq(0,1,0.25))+ coord_cartesian(ylim = c(0,1.13))+ facet_rep_wrap(~maleID, repeat.tick.labels = &quot;TRUE&quot;, ncol = 2) -&gt; p_male_presence_TYIT p_male_presence_TYIT # ggsave(&quot;figures/p_male_presence_TYIT.png&quot;, p_male_presence_TYIT, # dpi = 600, width = 240, height = 100, units = &quot;mm&quot;) 交尾期のみについて書くと以下のようになる。 male_presence_sum %&gt;% mutate(prop = n/sum) %&gt;% mutate(p = str_c(sprintf(&quot;%.2f&quot;,prop),&quot;(&quot;,n,&quot;/&quot;,sum,&quot;)&quot;)) %&gt;% mutate(season = ifelse(str_detect(study_period, &quot;nm&quot;), &quot;nm&quot;,&quot;m&quot;)) %&gt;% filter(season != &quot;nm&quot;) %&gt;% ## TYとITのみ含める filter(maleID %in% c(&quot;TY&quot;, &quot;IT&quot;)) %&gt;% ggplot(aes(x = study_period, y = prop))+ geom_col(color = &quot;orange&quot;, fill = &quot;orange&quot;)+ labs(y = &quot;Proportion of confirmed days&quot;,x=&quot;&quot;)+ theme_bw(base_size = 18)+ theme(axis.text = element_text(family = &quot;Arial&quot;), aspect.ratio = 0.8, axis.title.y = element_text(family = &quot;Arial&quot;, size = 16), strip.background = element_blank(), strip.text.x = element_text(face = &quot;bold.italic&quot;, hjust=0, family = &quot;Arial&quot;), axis.ticks.x = element_blank(), axis.text.x = element_text(family = &quot;Arial&quot;), legend.text = element_text(family = &quot;Yu Gothic&quot;))+ geom_text(aes(label = str_c(n,&quot;/&quot;,sum), y = prop + 0.07, family = &quot;Arial&quot;), size = 5)+ labs(fill = &quot;&quot;,color = &quot;&quot;)+ scale_y_continuous(expand = c(0,0), breaks = seq(0,1,0.25))+ coord_cartesian(ylim = c(0,1.13))+ facet_rep_wrap(~maleID, repeat.tick.labels = &quot;TRUE&quot;, ncol = 2) -&gt; p_male_presence_TYIT_m p_male_presence_TYIT_m # ggsave(&quot;figures/p_male_presence_TYIT_m.png&quot;, p_male_presence_TYIT_m, # dpi = 600, width = 200, height = 100, units = &quot;mm&quot;) KRとLKのみについてグラフを書くと以下のようになる。 male_presence_sum %&gt;% mutate(prop = n/sum) %&gt;% mutate(p = str_c(sprintf(&quot;%.2f&quot;,prop),&quot;(&quot;,n,&quot;/&quot;,sum,&quot;)&quot;)) %&gt;% mutate(season = ifelse(str_detect(study_period, &quot;nm&quot;), &quot;nm&quot;,&quot;m&quot;)) %&gt;% ## TYとITのみ含める filter(maleID %in% c(&quot;LK&quot;, &quot;KR&quot;)) %&gt;% ggplot(aes(x = study_period, y = prop))+ geom_col(aes(color = season,fill= season))+ scale_fill_manual(values = c(&quot;orange&quot;, &quot;palegreen4&quot;), label = c(&quot;mating(m)&quot;,&quot;nonmating(nm)&quot;))+ scale_color_manual(values = c(&quot;orange&quot;, &quot;palegreen4&quot;), label = c(&quot;mating(m)&quot;,&quot;nonmating(nm)&quot;))+ labs(y = &quot;Proportion of confirmed days&quot;,x=&quot;&quot;)+ theme_bw(base_size = 16)+ theme(axis.text = element_text(family = &quot;Arial&quot;), aspect.ratio = 0.8, axis.title.y = element_text(family = &quot;Arial&quot;, size = 12.5), strip.background = element_blank(), strip.text.x = element_text(face = &quot;bold.italic&quot;, hjust=0, family = &quot;Arial&quot;), axis.ticks.x = element_blank(), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12, angle = -45, vjust = -0.5), legend.text = element_text(family = &quot;Yu Gothic&quot;))+ geom_text(aes(label = str_c(n,&quot;/&quot;,sum), y = prop + 0.07, family = &quot;Arial&quot;), size = 3)+ labs(fill = &quot;&quot;,color = &quot;&quot;)+ scale_y_continuous(expand = c(0,0), breaks = seq(0,1,0.25))+ coord_cartesian(ylim = c(0,1.13))+ facet_rep_wrap(~maleID, repeat.tick.labels = &quot;TRUE&quot;, ncol = 2) -&gt; p_male_presence_LKKR p_male_presence_LKKR # ggsave(&quot;figures/p_male_presence_LKKR.png&quot;,p_male_presence_LKKR, # dpi = 600, width = 240, height = 100, units = &quot;mm&quot;) 交尾期のみについて書くと以下のようになる。 male_presence_sum %&gt;% mutate(prop = n/sum) %&gt;% mutate(p = str_c(sprintf(&quot;%.2f&quot;,prop),&quot;(&quot;,n,&quot;/&quot;,sum,&quot;)&quot;)) %&gt;% mutate(season = ifelse(str_detect(study_period, &quot;nm&quot;), &quot;nm&quot;,&quot;m&quot;)) %&gt;% filter(season != &quot;nm&quot;) %&gt;% ## TYとITのみ含める filter(maleID %in% c(&quot;LK&quot;, &quot;KR&quot;)) %&gt;% ggplot(aes(x = study_period, y = prop))+ geom_col(color = &quot;orange&quot;, fill = &quot;orange&quot;)+ labs(y = &quot;Proportion of confirmed days&quot;,x=&quot;&quot;)+ theme_bw(base_size = 18)+ theme(axis.text = element_text(family = &quot;Arial&quot;), aspect.ratio = 0.8, axis.title.y = element_text(family = &quot;Arial&quot;, size = 16), strip.background = element_blank(), strip.text.x = element_text(face = &quot;bold.italic&quot;, hjust=0, family = &quot;Arial&quot;), axis.ticks.x = element_blank(), axis.text.x = element_text(family = &quot;Arial&quot;), legend.text = element_text(family = &quot;Yu Gothic&quot;))+ geom_text(aes(label = str_c(n,&quot;/&quot;,sum), y = prop + 0.07, family = &quot;Arial&quot;), size = 5)+ labs(fill = &quot;&quot;,color = &quot;&quot;)+ scale_y_continuous(expand = c(0,0), breaks = seq(0,1,0.25))+ coord_cartesian(ylim = c(0,1.13))+ facet_rep_wrap(~maleID, repeat.tick.labels = &quot;TRUE&quot;, ncol = 2) -&gt; p_male_presence_LKKR_m p_male_presence_LKKR_m # ggsave(&quot;figures/p_male_presence_LKKR_m.png&quot;, p_male_presence_LKKR_m, # dpi = 600, width = 200, height = 100, units = &quot;mm&quot;) KMとTGは以下の通り。 male_presence_sum %&gt;% mutate(prop = n/sum) %&gt;% mutate(p = str_c(sprintf(&quot;%.2f&quot;,prop),&quot;(&quot;,n,&quot;/&quot;,sum,&quot;)&quot;)) %&gt;% mutate(season = ifelse(str_detect(study_period, &quot;nm&quot;), &quot;nm&quot;,&quot;m&quot;)) %&gt;% filter(season != &quot;nm&quot;) %&gt;% ## TYとITのみ含める filter(maleID %in% c(&quot;KM&quot;, &quot;TG&quot;)) %&gt;% ggplot(aes(x = study_period, y = prop))+ geom_col(color = &quot;orange&quot;, fill = &quot;orange&quot;)+ labs(y = &quot;Proportion of confirmed days&quot;,x=&quot;&quot;)+ theme_bw(base_size = 18)+ theme(axis.text = element_text(family = &quot;Arial&quot;), aspect.ratio = 0.8, axis.title.y = element_text(family = &quot;Arial&quot;, size = 16), strip.background = element_blank(), strip.text.x = element_text(face = &quot;bold.italic&quot;, hjust=0, family = &quot;Arial&quot;), axis.ticks.x = element_blank(), axis.text.x = element_text(family = &quot;Arial&quot;), legend.text = element_text(family = &quot;Yu Gothic&quot;))+ geom_text(aes(label = str_c(n,&quot;/&quot;,sum), y = prop + 0.07, family = &quot;Arial&quot;), size = 5)+ labs(fill = &quot;&quot;,color = &quot;&quot;)+ scale_y_continuous(expand = c(0,0), breaks = seq(0,1,0.25))+ coord_cartesian(ylim = c(0,1.13))+ facet_rep_wrap(~maleID, repeat.tick.labels = &quot;TRUE&quot;, ncol = 2) -&gt; p_male_presence_KMTG_m p_male_presence_KMTG_m # ggsave(&quot;figures/p_male_presence_KMTG_m.png&quot;, p_male_presence_KMTG_m, # dpi = 600, width = 200, height = 100, units = &quot;mm&quot;) 6.3 群れを離れた頻度の算出 ひとまず、ここでは6時間以上群れ本体で確認できないときに「群れを離れて行動していた」とみなし、TYとITが群れを離れた頻度を算出する。 6.3.1 データの読み込み まずは、データを読み込む。 maleout_19m &lt;- read_excel(&quot;../Data/data/2019mating/2019mating_raw.xlsx&quot;, sheet = &quot;male_presence_out&quot;) %&gt;% mutate(study_period = &quot;m19&quot;) maleout_20m &lt;- read_excel(&quot;../Data/data/2020mating/2020mating_raw.xlsx&quot;, sheet = &quot;male_presence_out&quot;) %&gt;% mutate(study_period = &quot;m20&quot;) maleout_21m &lt;- read_excel(&quot;../Data/data/2021mating/2021mating_raw.xlsx&quot;, sheet = &quot;male_presence_out&quot;) %&gt;% mutate(study_period = &quot;m21&quot;) maleout_20nm &lt;- read_excel(&quot;../Data/data/2020nonmating/2020nonmating_raw.xlsx&quot;, sheet = &quot;male_presence_out&quot;) %&gt;% mutate(study_period = &quot;nm20&quot;) maleout_21nm &lt;- read_excel(&quot;../Data/data/2021nonmating/2021nonmating_raw.xlsx&quot;, sheet = &quot;male_presence_out&quot;) %&gt;% mutate(study_period = &quot;nm21&quot;) これらを結合し、縦長データにする。 male_out &lt;- bind_rows(maleout_19m, maleout_20m, maleout_21m, maleout_20nm, maleout_21nm) %&gt;% left_join(no_female_over0.5) %&gt;% drop_na(prop_female) %&gt;% select(date, study_period, TY,IT) %&gt;% pivot_longer(3:4, names_to = &quot;maleID&quot;, values_to = &quot;out&quot;) %&gt;% drop_na(out) 6.3.2 頻度の算出 10日に何回のペースで出入りするのかを算出する。 2020年交尾期にTYとITともに最も頻繁に出入りしていた。 male_out %&gt;% group_by(maleID,study_period) %&gt;% summarise(sum = n(), n = sum(out), rate = mean(out)*10) %&gt;% ungroup() -&gt; male_out_sum male_out_sum 表 .cl-f44c3958{}.cl-f44406d4{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f44406e8{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f4472f94{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f4472f9e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f4474b32{width:0.786in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b33{width:1.202in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b3c{width:0.599in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b46{width:0.455in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b47{width:1.015in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b48{width:0.786in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b49{width:1.202in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b50{width:0.599in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b51{width:0.455in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b52{width:1.015in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b5a{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b5b{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b5c{width:0.599in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b5d{width:0.455in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b64{width:1.015in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b65{width:0.786in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b66{width:1.202in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b6e{width:0.599in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b6f{width:0.455in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b70{width:1.015in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b71{width:0.786in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b78{width:1.202in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b79{width:0.599in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b7a{width:0.455in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4474b82{width:1.015in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}maleIDstudy periodsumnfrequencyTYm195150.98TYm2080162.00TYm217930.38TYnm201011.00TYnm213820.53ITm195130.59ITm208081.00ITnm201011.00ITnm213810.26 特に交尾期に群れの出入りが多かったよう。 male_out %&gt;% mutate(season = ifelse(str_detect(study_period,&quot;nm&quot;),&quot;nonmating&quot;,&quot;mating&quot;)) %&gt;% group_by(maleID, season) %&gt;% summarise(rate = mean(out)*10) %&gt;% ungroup() %&gt;% arrange(desc(maleID)) %&gt;% flextable() %&gt;% theme_zebra() %&gt;% colformat_double(digits=3) .cl-f46d7b90{}.cl-f465c260{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f465c26a{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f4690d8a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f4690d9e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f4691f14{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4691f15{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4691f1e{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4691f1f{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4691f28{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4691f29{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}maleIDseasonrateTYmating1.143TYnonmating0.625ITmating0.840ITnonmating0.417 "],["08_female_presence.html", "7 調査期間ごとのメスの確認状況 7.1 各観察日のメス確認割合 7.2 メスごとの確認日数割合", " 7 調査期間ごとのメスの確認状況 以下では、メスの確認状況について分析を行う。 7.1 各観察日のメス確認割合 前章(6)で、6歳以上のメス(以下、メス)が50%以上確認でき、240分以上追跡できた日のデータを抽出していた(no_female_over0.5)。以下では、1日に確認できた6歳以上のメスの割合が調査期間ごとにどのように異なっていたかを分析する。 7.1.1 データの確認 まず、調査期間ごとにデータを図示する。2019年交尾期から2021年交尾期までの期間に1日に確認されたメスの割合が低い日が多くなっていることが分かる(特に交尾期)。 n_days &lt;- no_female_over0.5 %&gt;% group_by(study_period) %&gt;% summarise(N = n()) no_female_over0.5 %&gt;% mutate(season = ifelse(str_detect(study_period, &quot;nm&quot;), &quot;nm&quot;,&quot;m&quot;)) %&gt;% ggplot(aes(x = study_period, y = prop_female)) + geom_violin(aes(fill = as.factor(season)), scale = &quot;width&quot;,width = 0.9, size = 0.3,bw = 0.03)+ geom_quasirandom(shape = 1, alpha = 0.8, size = 1.9, stroke = 0.7, dodge.width = 0.8)+ geom_text(data = n_days, aes(label = str_c(&quot;N = &quot;,N), y = 1.025, family = &quot;Arial&quot;), size = 4) + scale_fill_manual(values = c(&quot;grey&quot;,&quot;white&quot;), labels = c(&quot;nonmating(m)&quot;,&quot;mating(nm)&quot;))+ scale_color_manual(values = c(&quot;black&quot;,&quot;black&quot;), labels = c(&quot;nonmating(m)&quot;,&quot;mating(nm)&quot;))+ labs(fill = &quot;&quot;, y = &quot;Proportion of confirmed females&quot;,x=&quot;&quot;)+ theme_bw(base_size = 16)+ theme(axis.title.y = element_text(family = &quot;Arial&quot;, size = 14.5), axis.text.x = element_text(family=&quot;Arial&quot;, face = &quot;bold&quot;, size = 16, angle = -45, vjust = -0.2), axis.title = element_text(family = &quot;Yu Gothic&quot;, size = 20), legend.text = element_text(family = &quot;Yu Gothic&quot;), axis.text.y = element_text(family =&quot;Arial&quot;))+ scale_y_continuous(breaks = seq(0,1,0.1)) 7.1.2 調査期間間の比較 7.1.2.1 モデリング 以下では、ベイズモデルによって調査期間間で確認したメスの割合を比較する。モデル式は以下の通り。max_femalesは各観察日の全メス数、no_femalesは各観察日の確認メス数を表す。 \\[ \\begin{aligned} &amp;no\\_female_i \\sim BetaBinomial(p_i, max\\_female_i, \\theta)\\\\ &amp;logit(p_i) = \\beta_0 + \\beta_1 \\times study\\_period_i + r_i\\\\ &amp;r_i \\sim Normal(0, \\sigma)\\\\ &amp;\\beta_0 \\sim student\\_t(4,0,10)\\\\ &amp;\\beta_1 \\sim student\\_t(4,0,10)\\\\ &amp;\\sigma \\sim student\\_t(4,0,5) \\end{aligned} \\] m_female_prop &lt;- brm(data = no_female_over0.5 %&gt;% mutate(date=as.factor(date)), no_female|trials(max_female) ~ study_period + (1|date), family = &quot;beta_binomial&quot;, prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd)), iter = 11000, warmup = 6000, seed = 13, control=list(adapt_delta = 0.9999, max_treedepth = 20), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_prop&quot;) 7.1.2.2 モデルチェック 続いて、モデルチェックを行う。まず、DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。特に問題はないよう。 dh_check_brms(m_female_prop) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 pp_check(m_female_prop, ndraws = 100)+ theme_bw() ただし、残差には時系列相関があることがわかり、可能であれば考慮した方がよい。 ## 残差の算出 resid_female_prop &lt;- residuals(m_female_prop, re_formula = NULL) %&gt;% bind_cols(no_female_over0.5) %&gt;% complete(date = seq.Date(min(date), max(date), by = &quot;1 day&quot;)) ## 自己相関の算出 acf_female_prop &lt;- acf(x = resid_female_prop$Estimate, lag.max = 20, na.action = na.pass, plot = F) pacf_female_prop &lt;- pacf(x = resid_female_prop$Estimate, lag.max = 20, na.action = na.pass, plot = F) ## 図示 data.frame(Lag = acf_female_prop$lag[,,1], acf = acf_female_prop$acf[,,1]) %&gt;% ggplot(aes(x = Lag, y = acf))+ geom_segment(aes(yend = 0, xend = Lag))+ theme_bw()+ theme(aspect.ratio = 1) -&gt; p_acf_female_prop data.frame(Lag = pacf_female_prop$lag[,,1], acf = pacf_female_prop$acf[,,1]) %&gt;% ggplot(aes(x = Lag, y = acf))+ geom_segment(aes(yend = 0, xend = Lag))+ theme_bw()+ theme(aspect.ratio = 1) -&gt; p_pacf_female_prop p_acf_female_prop + p_pacf_female_prop DHARMaパッケージで調べても、時系列相関が検出された。 dh_female_prop &lt;- dh_check_brms(m_female_prop, plot = FALSE) testTemporalAutocorrelation(dh_female_prop, time = no_female_over0.5$date) ## ## Durbin-Watson test ## ## data: simulationOutput$scaledResiduals ~ 1 ## DW = 1.1194, p-value &lt; 2.2e-16 ## alternative hypothesis: true autocorrelation is not 0 7.1.2.3 結果の確認 まず、モデルの結果は以下の通り。収束の問題は内容。有向サンプルサイズ(ESS)は1000を下回っているものがいくつかある。 model_parameters(m_female_prop) %&gt;% data.frame() %&gt;% select(1,3,5,6,7,8,9) %&gt;% mutate(across(where(is.numeric),~round(.,2))) 続いて、多重比較を行う。 estimate_contrasts(m_female_prop, contrast = &quot;study_period&quot;, ci = 0.95) %&gt;% data.frame() -&gt; cont_female_prop cont_female_prop %&gt;% mutate(across(where(is.numeric),~round(.,2))) 結果をまとめたのが下の表である。2019~2021年の交尾期は、その他の期間に比べて有意に確認メス割合が低いことが分かる。 cont_female_prop %&gt;% mutate(p = ifelse(CI_low*CI_high &gt;0, &quot;***&quot;,&quot;n.s&quot;)) %&gt;% select(Level1,Level2,p) %&gt;% pivot_wider(names_from = Level2, values_from = p) %&gt;% column_to_rownames(var = &quot;Level1&quot;) 7.1.2.4 結果の図示 モデルの結果と実データを合わせてプロットすると以下のようになる。 mean_female_prop &lt;- estimate_means(m_female_prop, at = &quot;study_period&quot;) %&gt;% data.frame() no_female_over0.5 %&gt;% mutate(season = ifelse(str_detect(study_period, &quot;nm&quot;), &quot;nm&quot;,&quot;m&quot;)) %&gt;% mutate(season = fct_relevel(season, &quot;nm&quot;,&quot;m&quot;)) %&gt;% ggplot(aes(x = study_period, y = prop_female)) + geom_violin(aes(fill = as.factor(season)), scale = &quot;width&quot;,width = 0.9, size = 0.3,bw = 0.03)+ geom_text(data = n_days, aes(label = str_c(&quot;N = &quot;,N), y = 1.025, family = &quot;Arial&quot;), size = 4) + geom_boxplot(aes(fill = as.factor(season)), width = 0.1, outlier.shape = NA, size = 0.3) + geom_pointrange(data = mean_female_prop %&gt;% filter(!str_detect(study_period,&quot;NM&quot;)), aes(y = Probability, ymin = CI_low,ymax = CI_high), color = &quot;white&quot;,size = 0.4)+ geom_errorbar(data = mean_female_prop%&gt;% filter(!str_detect(study_period,&quot;NM&quot;)), aes(y = Probability, ymin = CI_low,ymax = CI_high), color = &quot;white&quot;,width = 0.1,size=0.6)+ scale_fill_manual(values = c(&quot;palegreen4&quot;,&quot;orange&quot;), label = c(&quot;nonmating(m)&quot;,&quot;mating(nm)&quot;))+ scale_color_manual(values = c(&quot;palegreen4&quot;,&quot;orange3&quot;), label = c(&quot;nonmating(m)&quot;,&quot;mating(nm)&quot;))+ labs(fill = &quot;&quot;, y = &quot;Proportion of confirmed females&quot;,x=&quot;&quot;)+ theme_bw(base_size = 16)+ theme(axis.title.y = element_text(family = &quot;Arial&quot;, size = 14.5), axis.text.x = element_text(family=&quot;Arial&quot;, face = &quot;bold&quot;, size = 16), axis.title = element_text(family = &quot;Arial&quot;, size = 23), legend.text = element_text(family = &quot;Yu Gothic&quot;), axis.text.y = element_text(family =&quot;Arial&quot;))+ scale_y_continuous(breaks = seq(0,1,0.1)) -&gt; p_female_prop p_female_prop # ggsave(&quot;figures/p_female_prop.png&quot;,p_female_prop, dpi = 600, # width = 225, height = 110, units = &quot;mm&quot;) mean_female_prop_m &lt;- estimate_means(m_female_prop, at = &quot;study_period&quot;) %&gt;% data.frame() %&gt;% filter(!str_detect(study_period,&quot;nm&quot;)) no_female_over0.5 %&gt;% mutate(season = ifelse(str_detect(study_period, &quot;nm&quot;), &quot;nm&quot;,&quot;m&quot;)) %&gt;% mutate(season = fct_relevel(season, &quot;nm&quot;,&quot;m&quot;)) %&gt;% filter(season != &quot;nm&quot;) %&gt;% ggplot(aes(x = study_period, y = prop_female)) + geom_violin(fill = &quot;orange&quot;, scale = &quot;width&quot;,width = 0.9, size = 0.3,bw = 0.03)+ geom_text(data = n_days %&gt;% filter(!str_detect(study_period,&quot;nm&quot;)), aes(label = str_c(&quot;N = &quot;,N), y = 1.025, family = &quot;Arial&quot;), size = 6) + geom_boxplot(width = 0.1, outlier.shape = NA, size = 0.3, fill = &quot;orange3&quot;) + geom_pointrange(data = mean_female_prop_m, aes(y = Probability, ymin = CI_low,ymax = CI_high), color = &quot;white&quot;,size = 0.4)+ geom_errorbar(data = mean_female_prop_m , aes(y = Probability, ymin = CI_low,ymax = CI_high), color = &quot;white&quot;,width = 0.1,size=0.6)+ labs(fill = &quot;&quot;, y = &quot;Proportion of confirmed females&quot;,x=&quot;&quot;)+ theme_bw(base_size = 18)+ theme(axis.title.y = element_text(family = &quot;Arial&quot;, size = 14.5), axis.text.x = element_text(family=&quot;Arial&quot;, face = &quot;bold&quot;, size = 19), axis.title = element_text(family = &quot;Arial&quot;, size = 23), legend.text = element_text(family = &quot;Yu Gothic&quot;), axis.text.y = element_text(family =&quot;Arial&quot;, size = 20))+ scale_y_continuous(breaks = seq(0,1,0.1)) -&gt; p_female_prop_m p_female_prop_m # ggsave(&quot;figures/p_female_prop_m.png&quot;,p_female_prop_m, dpi = 600, # width = 180, height = 110, units = &quot;mm&quot;) 7.2 メスごとの確認日数割合 続いて、メスごとの確認に数割合を調査期間ごとに調べる。 7.2.1 データの加工 メスごとに各調査期間ごとの確認に数割合を算出する。なお、2019年交尾期以降のKurと2021年非交尾期以降のTamは死亡したので除く。 no_female_over0.5 %&gt;% select(groupID) %&gt;% left_join(group_all %&gt;% select(-c(TY,IT,KR,LK,KM,TG))) %&gt;% ## 縦型にする pivot_longer(Kur:Yun, names_to = &quot;femaleID&quot;, values_to = &quot;presence&quot;) %&gt;% left_join(att, by = c(&quot;femaleID&quot;, &quot;study_period&quot;)) %&gt;% ## 6歳以上のみ抽出 filter(age &gt;= 6) %&gt;% drop_na(presence) %&gt;% ## 算出 group_by(study_period, femaleID) %&gt;% summarise(sum = n(), n = sum(presence)) %&gt;% ungroup() %&gt;% mutate(prop_presence= n/sum) %&gt;% ## 2019年交尾期のKurと2021年非交尾期のTamを除く filter(!((femaleID == &quot;Kur&quot; &amp; study_period == &quot;m19&quot;)|(femaleID == &quot;Tam&quot; &amp; study_period == &quot;nm21&quot;))) %&gt;% mutate(study_period = fct_relevel(study_period, &quot;m18&quot;,&quot;nm19&quot;,&quot;m19&quot;,&quot;nm20&quot;, &quot;m20&quot;,&quot;nm21&quot;,&quot;m21&quot;,&quot;nm22&quot;)) -&gt; prop_female_presence データは以下のようになる。 datatable(prop_female_presence %&gt;% mutate(across(where(is.numeric),~round(.,3))), options = list(scrollX = 60)) 7.2.2 データの確認 まず、データを確認する。2019年交尾期から2021年交尾期までは、確認に数割合が低いメスがかなりいることが分かる。 prop_female_presence %&gt;% ggplot(aes(x = femaleID, y = prop_presence)) + geom_col() + theme_bw(base_size = 11)+ labs(x=&quot;&quot;, y = &quot;Proportion of confirmed days&quot;)+ theme(axis.text.y = element_text(family= &quot;Arial&quot;), axis.title.y = element_text(family = &quot;Arial&quot;), axis.text.x = element_text(family = &quot;Arial&quot;, face = &quot;italic&quot;), strip.background = element_blank(), strip.text.x = element_text(hjust=0, family = &quot;Arial&quot;, size = 11))+ coord_cartesian(ylim = c(0,1.2))+ scale_y_continuous(expand = c(0,0), breaks = seq(0,1,0.25))+ geom_text(aes(label = str_c(n,&quot;/&quot;,sum), y = prop_presence+0.1), family = &quot;Arial&quot;, size = 2.5)+ facet_rep_wrap(~study_period, repeat.tick.labels = T, ncol = 2) 7.2.3 調査期間間の比較 7.2.3.1 モデリング 以下では、ベイズモデルによって調査期間間でメスの確認日数割合に違いがあるかを調べる。モデル式は以下の通り。\\(i\\)はデータ番号を、\\(j\\)はメスIDを表す。また、max_dateは各観察期間の観察日数、no_presentはそのうちそのメスが確認されたかを数を表す。 \\[ \\begin{aligned} &amp;no\\_present_{i} \\sim BetaBinomial(p_{i}, max\\_date_{i})\\\\ &amp;logit(p_{i}) = \\beta_0 + \\beta_1 \\times study\\_period_{i} + r_{i} + \\gamma_j \\\\ &amp;r_{i} \\sim Normal(0, \\sigma_{r})\\\\ &amp;\\gamma_j \\sim Normal(0, \\sigma_{\\gamma})\\\\ &amp;\\beta_0 \\sim student\\_t(4,0,10)\\\\ &amp;\\beta_1 \\sim student\\_t(4,0,10)\\\\ &amp;\\sigma \\sim student\\_t(4,0,5) \\end{aligned} \\] m_female_presence &lt;- brm(data = prop_female_presence %&gt;% mutate(N = 1:n()), n|trials(sum) ~ study_period + (1|femaleID), family = &quot;beta_binomial&quot;, prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd)), iter = 11000, warmup = 6000, seed = 13, control=list(adapt_delta = 0.9999, max_treedepth = 20), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_presence&quot;) 7.2.3.2 モデルチェック 続いて、モデルチェックを行う。まず、DHARMaパッケージでモデルの前提が満たされているかを確認する。 dh_check_brms(m_female_presence) pp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 pp_check(m_female_presence, ndraws = 100)+ theme_bw() 7.2.3.3 結果の確認 まず、モデルの結果は以下の通り。収束の問題はないよう。 model_parameters(m_female_presence) %&gt;% data.frame() %&gt;% select(1,3,5,6,7,8,9) %&gt;% mutate(across(where(is.numeric),~round(.,2))) 続いて、多重比較を行う。 estimate_contrasts(m_female_presence, contrast = &quot;study_period&quot;, ci = 0.95) %&gt;% data.frame() -&gt; cont_female_presence cont_female_presence %&gt;% mutate(across(where(is.numeric),~round(.,2))) 結果をまとめたのが下の表である。 cont_female_presence %&gt;% mutate(p = ifelse(CI_low*CI_high &gt;0, &quot;***&quot;,&quot;n.s&quot;)) %&gt;% select(Level1,Level2,p) %&gt;% pivot_wider(names_from = Level2, values_from = p) %&gt;% column_to_rownames(var = &quot;Level1&quot;) 7.2.3.4 結果の図示 モデルの結果と実データを合わせてプロットすると以下のようになる。 mean_female_presence &lt;- estimate_means(m_female_presence, at = &quot;study_period&quot;) %&gt;% data.frame() prop_female_presence %&gt;% mutate(season = ifelse(str_detect(study_period, &quot;nm&quot;), &quot;nm&quot;,&quot;m&quot;)) %&gt;% mutate(season = fct_relevel(season, &quot;nm&quot;,&quot;m&quot;)) %&gt;% ggplot(aes(x = study_period))+ geom_violin(aes( y = prop_presence,fill = as.factor(season)), scale = &quot;width&quot;,width = 0.9, size = 0.3)+ geom_boxplot(aes( y = prop_presence,fill = as.factor(season)), color = &quot;black&quot;, width = 0.2, position = position_dodge(0.9), outlier.shape = NA, size =0.3)+ geom_pointrange(data = mean_female_presence, aes(y = Probability, ymin = CI_low,ymax = CI_high), color = &quot;white&quot;,size = 0.25)+ geom_errorbar(data = mean_female_presence, aes(y = Probability, ymin = CI_low,ymax = CI_high), color = &quot;white&quot;,width = 0.1,size=0.6)+ #stat_summary(fun = &quot;mean&quot;,geom = &quot;point&quot;, shape = 23, # color = &quot;black&quot;, position = position_dodge(0.9), # aes( y = rate, group = as.factor(season)), fill = &quot;white&quot;)+ scale_fill_manual(values = c(&quot;palegreen4&quot;,&quot;orange&quot;), label = c(&quot;nonmating(m)&quot;,&quot;mating(nm)&quot;))+ scale_color_manual(values = c(&quot;palegreen4&quot;,&quot;orange3&quot;), label = c(&quot;nonmating(m)&quot;,&quot;mating(nm)&quot;))+ labs(fill = &quot;season&quot;, y = &quot;Proportion of confirmed days&quot;,x=&quot;&quot;)+ theme_bw(base_size = 16)+ theme(axis.title.y = element_text(family = &quot;Arial&quot;, size = 14.5), axis.text.x = element_text(family=&quot;Arial&quot;, face = &quot;bold&quot;, size = 16), axis.title = element_text(family = &quot;Arial&quot;, size = 23), legend.text = element_text(family = &quot;Yu Gothic&quot;), axis.text.y = element_text(family =&quot;Arial&quot;))+ scale_y_continuous(breaks = seq(0,1,0.1)) -&gt;p_female_presence p_female_presence # ggsave(&quot;figures/p_female_presence.png&quot;,p_female_presence, dpi = 600, # width = 225, height = 110, units = &quot;mm&quot;) References Gabry, J., &amp; Mahr, T. (2022). Bayesplot: Plotting for bayesian models. https://mc-stan.org/bayesplot Hartig, F. (2022). DHARMa: Residual diagnostics for hierarchical (multi-level / mixed) regression models. https://CRAN.R-project.org/package=DHARMa Rodríguez-Sánchez, F. (2023). DHARMa.helpers: Helper functions to check models not (yet) directly supported by DHARMa. "],["09_female_presence_statespace.html", "8 各観察日の確認メス割合に関する時系列分析 8.1 データの加工 8.2 全期間を合わせたモデル 8.3 2021年非交尾期までのデータを用いたモデル", " 8 各観察日の確認メス割合に関する時系列分析 前章(7)で扱った各観察日の確認メス割合は時系列データのため、モデルの残差に時系列相関が残ってしまっていた。そこで、以下では確認メス割合のデータを状態空間モデル(Matsuura, 2023; 馬場, 2019)によって分析することでデータの時系列相関を考慮する。 8.1 データの加工 モデルでは、TYとITがその日群れ本体で確認されたか否かも変数として加える。2019年交尾期から2021年交尾期までは一時的に群れで確認されたものの、すぐにいなくなってしまった日が何日かあった。それらの日については、彼らの確認時間が1時間未満だったときは群れ本体にいなかったとして扱う。 まず、彼らの確認時間帯が記されたデータシートを読み込み、60分以上確認できたか否かの列を作成する。出入りがあった期間以外は、群れ本体にいた場合は終日確認されたのでgroup_allからデータを引っ張ってくる。 male_time_18m &lt;- group_all %&gt;% filter(study_period == &quot;m18&quot;) %&gt;% select(date, groupID, TY, IT) male_time_19nm &lt;- group_all %&gt;% filter(study_period == &quot;nm19&quot;) %&gt;% select(date, groupID, TY, IT) male_time_19m &lt;- read_excel(&quot;../Data/data/2019mating/2019mating_raw.xlsx&quot;, sheet = &quot;male_presence_long&quot;) %&gt;% mutate(study_period = &quot;m19&quot;) %&gt;% mutate(groupID = str_c(study_period,&quot;_&quot;, groupID)) %&gt;% ## 確認時間の算出 mutate(dur = ifelse(is.na(first), 0, difftime(last, first, units = &quot;mins&quot;))) %&gt;% mutate(presence_1h = ifelse(dur &gt;= 60,1,0)) %&gt;% select(maleID, date, groupID, presence_1h) %&gt;% pivot_wider(names_from = maleID, values_from = presence_1h) male_time_20m &lt;- read_excel(&quot;../Data/data/2020mating/2020mating_raw.xlsx&quot;, sheet = &quot;male_presence_long&quot;) %&gt;% mutate(study_period = &quot;m20&quot;) %&gt;% mutate(groupID = str_c(study_period,&quot;_&quot;, groupID)) %&gt;% ## 確認時間の算出 mutate(dur = ifelse(is.na(first), 0, difftime(last, first, units = &quot;mins&quot;))) %&gt;% mutate(presence_1h = ifelse(dur &gt;= 60,1,0)) %&gt;% select(maleID, date, groupID, presence_1h) %&gt;% pivot_wider(names_from = maleID, values_from = presence_1h) male_time_21m &lt;- read_excel(&quot;../Data/data/2021mating/2021mating_raw.xlsx&quot;, sheet = &quot;male_presence_long&quot;) %&gt;% mutate(study_period = &quot;m21&quot;) %&gt;% mutate(groupID = str_c(study_period,&quot;_&quot;, groupID)) %&gt;% ## 確認時間の算出 mutate(dur = ifelse(is.na(first), 0, difftime(last, first, units = &quot;mins&quot;))) %&gt;% mutate(presence_1h = ifelse(dur &gt;= 60,1,0)) %&gt;% select(maleID, date, groupID, presence_1h) %&gt;% pivot_wider(names_from = maleID, values_from = presence_1h) male_time_20nm &lt;- read_excel(&quot;../Data/data/2020nonmating/2020nonmating_raw.xlsx&quot;, sheet = &quot;male_presence_long&quot;) %&gt;% mutate(study_period = &quot;nm20&quot;) %&gt;% mutate(groupID = str_c(study_period,&quot;_&quot;, groupID)) %&gt;% ## 確認時間の算出 mutate(dur = ifelse(is.na(first), 0, difftime(last, first, units = &quot;mins&quot;))) %&gt;% mutate(presence_1h = ifelse(dur &gt;= 60,1,0)) %&gt;% select(maleID, date, groupID, presence_1h) %&gt;% pivot_wider(names_from = maleID, values_from = presence_1h) male_time_21nm &lt;- read_excel(&quot;../Data/data/2021nonmating/2021nonmating_raw.xlsx&quot;, sheet = &quot;male_presence_long&quot;) %&gt;% mutate(study_period = &quot;nm21&quot;) %&gt;% mutate(groupID = str_c(study_period,&quot;_&quot;, groupID)) %&gt;% ## 確認時間の算出 mutate(dur = ifelse(is.na(first), 0, difftime(last, first, units = &quot;mins&quot;))) %&gt;% mutate(presence_1h = ifelse(dur &gt;= 60,1,0)) %&gt;% select(maleID, date, groupID, presence_1h) %&gt;% pivot_wider(names_from = maleID, values_from = presence_1h) male_time_22nm &lt;- group_all %&gt;% filter(study_period == &quot;nm22&quot;) %&gt;% select(date, groupID, TY, IT) TYIT_presence &lt;- bind_rows(male_time_18m, male_time_19m, male_time_20m, male_time_21m, male_time_19nm, male_time_20nm, male_time_21nm, male_time_22nm) 続いて、群れ本体が240日以上確認できた日のデータに先ほどのデータを結合する。また、データのない日付の行も補完する。 no_female_over0.5_b &lt;- no_female_over0.5 %&gt;% left_join(TYIT_presence, by = c(&quot;date&quot;,&quot;groupID&quot;)) %&gt;% mutate(date = as_date(date)) %&gt;% complete(date = seq.Date(min(date), max(date), by =&quot;1 day&quot;)) %&gt;% mutate(m18 = ifelse(study_period == &quot;m18&quot;,1,0), m19 = ifelse(study_period == &quot;m19&quot;,1,0), m20 = ifelse(study_period == &quot;m20&quot;,1,0), m21 = ifelse(study_period == &quot;m21&quot;,1,0), nm19 = ifelse(study_period == &quot;nm19&quot;,1,0), nm20 = ifelse(study_period == &quot;nm20&quot;,1,0), nm21 = ifelse(study_period == &quot;nm21&quot;,1,0), nm22 = ifelse(study_period == &quot;nm22&quot;,1,0)) 8.2 全期間を合わせたモデル 8.2.1 TYの有無 + 調査期間 8.2.1.1 モデリング 以下のモデルを考える。ひとまず、全期間で観察されていないITの有無は変数からは除く。 \\(no\\_female_{t}\\): 時点tの確認メス数 \\(max_female_{t}\\): 時点tでの最大メス数 \\(TY_{t}\\)/\\(IT_{t}:\\) t時点のTY/ITの群れ本体での有無 \\(study\\_period_{t}\\): 調査期間を表すダミー変数 \\[ \\begin{aligned} &amp;no\\_female_{t} \\sim Binomial(p_t, max\\_female_t)\\\\ &amp;logit(p_{t}) = \\mu_{t} + \\beta_1 \\times TY_t + \\sum_{j = 2}^9 \\beta_j \\times study\\_period_{t}\\\\ &amp; \\mu_{t} = \\mu_{t-1}+\\epsilon_{t}\\\\ &amp; \\epsilon_{t} \\sim Normal(0,\\sigma^2)\\\\ &amp; \\beta_{1,2,3,4, 5,6,7,8,9} \\sim Student\\_t(0,4,10)\\\\ &amp;\\sigma^2 \\sim Student\\_t(0,4,5)\\\\ \\end{aligned} \\] データのリストは以下の通り。 ## 観測値がある行番号 nadrop_no_female &lt;- drop_na(no_female_over0.5_b %&gt;% select(-IT), prop_female) obs_no &lt;- which(!is.na(no_female_over0.5_b$no_female)) ## 説明変数の行列を作成 X &lt;- matrix(c(nadrop_no_female$TY, nadrop_no_female$m18, nadrop_no_female$m19, nadrop_no_female$m20, nadrop_no_female$m21, nadrop_no_female$nm19, nadrop_no_female$nm20, nadrop_no_female$nm21, nadrop_no_female$nm22), nrow = 383, ncol = 9) colnames(X) &lt;- colnames(nadrop_no_female)[8:16] list_female_ss &lt;- list(len_obs = nrow(nadrop_no_female), obs_no = obs_no, N = nrow(no_female_over0.5_b), X = X, D = ncol(X), no_female = nadrop_no_female$no_female, max_female = nadrop_no_female$max_female) それでは、以下のようにcmdstanr(Gabry et al., 2023)でモデルを回す。 stan_female_ss &lt;- cmdstan_model(&quot;stanfile/m_female_ss.stan&quot;) # m_female_ss &lt;- stan_female_ss$sample( # data = list_female_ss, # seed = 13, # iter_sampling = 5000, # iter_warmup = 6000, # thin = 1, # chains = 4, # adapt_delta = 0.999, # max_treedepth = 20 # ) # # m_female_ss$save_object(&quot;model/m_female_ss.rds&quot;) m_female_ss &lt;- readRDS(&quot;model/m_female_ss.rds&quot;) 8.2.1.2 モデルの診断 Rhatは小さく、収束に問題ないよう。 rhat_female_ss &lt;- m_female_ss %&gt;% bayesplot::rhat() data.frame(Rhat = rhat_female_ss) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 有効サンプルサイズも少なくとも10000程度ある。 post_summary_female_ss &lt;- m_female_ss$summary(variables = c(&quot;mu&quot;,&quot;p&quot;,&quot;b&quot;,&quot;lp__&quot;,&quot;s_t&quot;,&quot;mu_err&quot;), posterior::default_summary_measures(), lower = ~quantile(., 0.025, na.rm = TRUE), upper = ~quantile(., 0.975, na.rm = TRUE), posterior::default_convergence_measures()) post_summary_female_ss %&gt;% ggplot(aes(x = ess_bulk)) + geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 残差の自己相関は消えている。 postmean_female_ss &lt;- post_summary_female_ss %&gt;% filter(str_detect(variable, &quot;p\\\\[&quot;)) %&gt;% mutate(post_mean = inv_logit_scaled(mean)) %&gt;% bind_cols(no_female_over0.5_b) %&gt;% mutate(resid = prop_female - post_mean) acf_female_ss &lt;- acf(postmean_female_ss$resid, na.action = na.pass, plot = F) data.frame(Lag = acf_female_ss$lag[,,1], acf = acf_female_ss$acf[,,1]) %&gt;% ggplot(aes(x = Lag, y = acf))+ geom_segment(aes(yend = 0, xend = Lag))+ theme_bw()+ theme(aspect.ratio = 1) 事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## pの事後平均に元データを結合 post_p_female_ss &lt;- post_summary_female_ss %&gt;% filter(str_detect(variable, &quot;p\\\\[&quot;)) %&gt;% bind_cols(no_female_over0.5_b) %&gt;% drop_na(mean) %&gt;% mutate(mean_prob = inv_logit_scaled(mean)) ## 事後予測値を事後平均からシミュレート post_pred_female_ss &lt;- data.frame(matrix(rep(NA,383*100), ncol = 100)) for(i in 1:100){ post_pred_female_ss[,i] &lt;- rbinom(n = nrow(nadrop_no_female), size = post_p_female_ss$max_female, prob = post_p_female_ss$mean_prob) } post_pred_female_ss %&gt;% bind_cols(nadrop_no_female) %&gt;% select(1:100, no_female) %&gt;% rename(y_actual = no_female) %&gt;% pivot_longer(everything(), names_to = &quot;n_draw&quot;, values_to = &quot;post_pred&quot;) %&gt;% mutate(type = ifelse(str_detect(n_draw, &quot;X&quot;),&quot;y_pred&quot;,&quot;y&quot;)) -&gt; post_pred_female_ss_long ## 図示 post_pred_female_ss_long %&gt;% ggplot(aes(x = post_pred))+ geom_line(stat = &quot;density&quot;, aes(group = n_draw, color = type, alpha = type))+ scale_color_manual(values = c(&quot;blue4&quot;,&quot;lightblue&quot;))+ scale_alpha_discrete(range = c(1, 0.3))+ theme_bw()+ theme(aspect.ratio = 0.8)+ labs(x = &quot;&quot;, y = &quot;&quot;) 8.2.1.3 結果の確認 結果は以下の通り。TYがいる日は有意に確認メス数が多いことが分かった(\\(\\beta_1 = 0.574[0.187-0.962]\\))。 post_summary_female_ss %&gt;% filter(str_detect(variable, &quot;b&quot;) | str_detect(variable, &quot;s_t&quot;)) TYの有無をコントロールすると、調査期間間の効果の違いはない。つまり、調査期間間のメス確認割合の違いはTYの有無に大きく影響されていたことが分かった。 draws_female_ss &lt;- m_female_ss$draws() as_draws_df(draws_female_ss, .nchains = 4) %&gt;% select(2:10) %&gt;% mutate(`m18 - m19` = `b[2]` - `b[3]`, `m18 - m20` = `b[2]` - `b[4]`, `m18 - m21` = `b[2]` - `b[5]`, `m18 - nm19` = `b[2]` - `b[6]`, `m18 - nm20` = `b[2]` - `b[7]`, `m18 - nm21` = `b[2]` - `b[8]`, `m18 - nm22` = `b[2]` - `b[9]`, `m19 - m20` = `b[3]` - `b[4]`, `m19 - m21` = `b[3]` - `b[5]`, `m19 - nm19` = `b[3]` - `b[6]`, `m19 - nm20` = `b[3]` - `b[7]`, `m19 - nm21` = `b[3]` - `b[8]`, `m19 - nm22` = `b[3]` - `b[9]`, `m20 - m21` = `b[4]` - `b[5]`, `m20 - nm19` = `b[4]` - `b[6]`, `m20 - nm20` = `b[4]` - `b[7]`, `m20 - nm21` = `b[4]` - `b[8]`, `m20 - nm22` = `b[4]` - `b[9]`, `m21 - nm19` = `b[5]` - `b[6]`, `m21 - nm20` = `b[5]` - `b[7]`, `m21 - nm21` = `b[5]` - `b[8]`, `m21 - nm22` = `b[5]` - `b[9]`, `nm19 - nm20` = `b[6]` - `b[7]`, `nm19 - nm21` = `b[6]` - `b[8]`, `nm19 - nm22` = `b[6]` - `b[9]`, `nm20 - nm21` = `b[7]` - `b[8]`, `nm20 - nm22` = `b[7]` - `b[9]`, `nm21 - nm22` = `b[8]` - `b[9]`) %&gt;% select(-c(1:9)) %&gt;% pivot_longer(everything(), names_to = &quot;cat&quot;, values_to = &quot;Diff&quot;) %&gt;% group_by(cat) %&gt;% summarise(mean = mean(Diff), upper = quantile(Diff, 0.975), lower = quantile(Diff, 0.025)) 8.2.1.4 結果の図示 それでは、結果を図示する。まずは、時系列的に\\(p_t\\)の事後平均と95%確信区間を図示する。 TYの有無で確認メス割合を比較したものを図示したのが以下である。 as_draws_df(draws_female_ss, .nchains = 4) %&gt;% select(contains(&quot;p[&quot;)) %&gt;% pivot_longer(everything(), names_to = &quot;p&quot;, values_to = &quot;post&quot;) %&gt;% drop_na() %&gt;% mutate(p2 = as.numeric(str_replace_all(p, c(&quot;p\\\\[&quot; = &quot;&quot;,&quot;\\\\]&quot; = &quot;&quot;)))) %&gt;% left_join(no_female_over0.5_b %&gt;% mutate(p2 = 1:n()), by = &quot;p2&quot;) %&gt;% group_by(TY) %&gt;% summarise(mean_prob = inv_logit_scaled(mean(post)), lower_prob = inv_logit_scaled(quantile(post, 0.025)), upper_prob = inv_logit_scaled(quantile(post, 0.975))) %&gt;% mutate(TY = as.factor(TY)) -&gt; post_female_ss_TY nadrop_no_female %&gt;% mutate(TY = as.factor(TY)) %&gt;% ggplot(aes(x = TY, y = prop_female))+ geom_violin(bw = 0.04, aes(fill = TY))+ geom_boxplot(width = 0.2, aes(fill = TY), outlier.alpha = 0) + geom_pointrange(data = post_female_ss_TY, aes(y = mean_prob, ymin = lower_prob,ymax = upper_prob), color = &quot;grey92&quot;,size = 0.4)+ geom_errorbar(data = post_female_ss_TY, aes(y = mean_prob, ymin = lower_prob,ymax = upper_prob), color = &quot;grey92&quot;,width = 0.1,size=0.6)+ scale_fill_nejm()+ scale_x_discrete(labels = c(&quot;No&quot;,&quot;Yes&quot;))+ labs(y = &quot;proportion of comfirmed females&quot;, x = &quot;TY confirmed&quot;, fill = &quot;&quot;) + theme_bw(base_size = 14) + guides(fill = &quot;none&quot;)+ theme(aspect.ratio = 1) -&gt; p_female_ss_TY #ggsave(&quot;figures/p_female_ss_TY.png&quot;,p_female_ss_TY, dpi = 600, units = &quot;mm&quot;, # width = 100, height = 100) 交尾期のみを用いたのが以下の通り。 as_draws_df(draws_female_ss, .nchains = 4) %&gt;% select(contains(&quot;p[&quot;)) %&gt;% pivot_longer(everything(), names_to = &quot;p&quot;, values_to = &quot;post&quot;) %&gt;% drop_na() %&gt;% mutate(p2 = as.numeric(str_replace_all(p, c(&quot;p\\\\[&quot; = &quot;&quot;,&quot;\\\\]&quot; = &quot;&quot;)))) %&gt;% left_join(no_female_over0.5_b %&gt;% mutate(p2 = 1:n()), by = &quot;p2&quot;) %&gt;% filter(study_period %in% c(&quot;m18&quot;,&quot;m19&quot;,&quot;m20&quot;,&quot;m21&quot;)) %&gt;% group_by(TY) %&gt;% summarise(mean_prob = inv_logit_scaled(mean(post)), lower_prob = inv_logit_scaled(quantile(post, 0.025)), upper_prob = inv_logit_scaled(quantile(post, 0.975))) %&gt;% mutate(TY = as.factor(TY)) -&gt; post_female_ss_TY_m nadrop_no_female %&gt;% mutate(TY = as.factor(TY)) %&gt;% filter(study_period %in% c(&quot;m18&quot;,&quot;m19&quot;,&quot;m20&quot;,&quot;m21&quot;)) %&gt;% ggplot(aes(x = TY, y = prop_female))+ geom_violin(bw = 0.04, aes(fill = TY))+ geom_boxplot(width = 0.2, aes(fill = TY), outlier.alpha = 0) + geom_pointrange(data = post_female_ss_TY_m, aes(y = mean_prob, ymin = lower_prob,ymax = upper_prob), color = &quot;grey92&quot;,size = 0.4)+ geom_errorbar(data = post_female_ss_TY_m, aes(y = mean_prob, ymin = lower_prob,ymax = upper_prob), color = &quot;grey92&quot;,width = 0.1,size=0.6)+ scale_fill_nejm()+ scale_x_discrete(labels = c(&quot;No&quot;,&quot;Yes&quot;))+ labs(y = &quot;proportion of comfirmed females&quot;, x = &quot;TY confirmed&quot;, fill = &quot;&quot;) + theme_bw(base_size = 18) + guides(fill = &quot;none&quot;)+ theme(aspect.ratio = 1) -&gt; p_female_ss_TY_m p_female_ss_TY_m # ggsave(&quot;figures/p_female_ss_TY_m.png&quot;,p_female_ss_TY_m, dpi = 600, units = &quot;mm&quot;, # width = 100, height = 100) 8.2.2 TY/ITの動向 + 調査期間 先ほどはTYとITの有無のみを考慮したが、さらに詳しい分析を行うため、彼らの前日からの動向を以下の3つのように分析し、それが確認メス割合に与える影響を分析した(図??)。 図8.1: TYとITの動向の3分類 8.2.2.1 データの加工 まず、上記の3つの動向を示す変数を作成する。 no_female_over0.5_b %&gt;% replace_na(list(IT = 0)) %&gt;% ## 前日の動向のデータを追加 left_join(no_female_over0.5_b %&gt;% mutate(date = date + 1) %&gt;% rename(TY_pre = TY, IT_pre = IT) %&gt;% select(date, TY_pre, IT_pre) %&gt;% replace_na(list(IT_pre = 0)), by = &quot;date&quot;) %&gt;% mutate(TY_out = ifelse(is.na(TY_pre)|is.na(TY), NA, ifelse(TY == 0 &amp; TY_pre == 1, 1, 0))) %&gt;% mutate(TY_stay = ifelse(is.na(TY_pre)|is.na(TY), NA, ifelse(TY == 1 &amp; TY_pre == 1, 1, 0))) %&gt;% mutate(TY_absent = ifelse(is.na(TY_pre)|is.na(TY), NA, ifelse(TY_pre == 0, 1, 0))) %&gt;% mutate(IT_out = ifelse(is.na(IT_pre)|is.na(IT), NA, ifelse(IT == 0 &amp; IT_pre == 1, 1, 0))) %&gt;% mutate(IT_stay = ifelse(is.na(IT_pre)|is.na(IT), NA, ifelse(IT == 1 &amp; IT_pre == 1, 1, 0))) %&gt;% mutate(IT_absent = ifelse(is.na(IT_pre)|is.na(IT), NA, ifelse(IT_pre == 0, 1, 0))) -&gt; no_female_over0.5_TYstate 8.2.2.2 モデリング(交尾期) 以下のモデルを考える。 \\(no\\_female_{t}\\): 時点tの確認メス数 \\(max_female_{t}\\): 時点tでの最大メス数 \\(TYstate_{t}\\)/\\(ITstate{t}:\\) t時点のTY/ITの動向を表すダミー変数 \\(study\\_period_{t}\\): 調査期間を表すダミー変数 \\[ \\begin{aligned} &amp;no\\_female_{t} \\sim Binomial(p_t, max\\_female_t)\\\\ &amp;logit(p_{t}) = \\mu_{t} + \\beta_1 \\times TY_t + \\sum_{j = 2}^9 \\beta_j \\times study\\_period_{t}\\\\ &amp; \\mu_{t} = \\mu_{t-1}+\\epsilon_{t}\\\\ &amp; \\epsilon_{t} \\sim Normal(0,\\sigma^2)\\\\ &amp; \\beta_{1,2,3,4, 5,6,7,8,9} \\sim Student\\_t(0,4,10)\\\\ &amp;\\sigma^2 \\sim Student\\_t(0,4,5)\\\\ \\end{aligned} \\] データのリストは以下の通り。 ## 観測値がある行番号 nadrop_no_female_TYstate &lt;- drop_na(no_female_over0.5_TYstate, TY_out) obs_no_TYstate &lt;- which(!is.na(no_female_over0.5_TYstate$TY_out)) ## 説明変数の行列を作成 X_TYstate &lt;- matrix(c(nadrop_no_female_TYstate$TY_out, nadrop_no_female_TYstate$TY_stay, nadrop_no_female_TYstate$TY_absent, nadrop_no_female_TYstate$IT_out, nadrop_no_female_TYstate$IT_stay, nadrop_no_female_TYstate$IT_absent, nadrop_no_female_TYstate$m18, nadrop_no_female_TYstate$m19, nadrop_no_female_TYstate$m20, nadrop_no_female_TYstate$m21, nadrop_no_female_TYstate$nm19, nadrop_no_female_TYstate$nm20, nadrop_no_female_TYstate$nm21, nadrop_no_female_TYstate$nm22), nrow = nrow(nadrop_no_female_TYstate), ncol = 14) list_female_ss_TYstate &lt;- list(len_obs = nrow(nadrop_no_female_TYstate), obs_no = obs_no_TYstate, N = nrow(no_female_over0.5_TYstate), X = X_TYstate, D = ncol(X_TYstate), no_female = nadrop_no_female_TYstate$no_female, max_female = nadrop_no_female_TYstate$max_female) それでは、以下のようにcmdstanr(Gabry et al., 2023)でモデルを回す。 stan_female_ss_TYstate &lt;- cmdstan_model(&quot;stanfile/m_female_ss.stan&quot;) # m_female_ss_TYstate &lt;- stan_female_ss_TYstate$sample( # data = list_female_ss_TYstate, # seed = 13, # iter_sampling = 5000, # iter_warmup = 2000, # thin = 1, # chains = 4, # adapt_delta = 0.999, # max_treedepth = 20 # ) # m_female_ss_TYstate$save_object(&quot;model/m_female_ss_TYstate.rds&quot;) m_female_ss_TYstate &lt;- readRDS(&quot;model/m_female_ss_TYstate.rds&quot;) 8.2.2.3 モデルの診断 Rhatは小さく、収束に問題ないよう。 rhat_female_ss_TYstate &lt;- m_female_ss_TYstate %&gt;% bayesplot::rhat() data.frame(Rhat = rhat_female_ss_TYstate) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 有効サンプルサイズも少なくとも10000程度ある。 post_summary_female_ss_TYstate &lt;- m_female_ss_TYstate$summary( variables = c(&quot;mu&quot;,&quot;p&quot;,&quot;b&quot;,&quot;lp__&quot;,&quot;s_t&quot;,&quot;mu_err&quot;), posterior::default_summary_measures(), lower = ~quantile(., 0.025, na.rm = TRUE), upper = ~quantile(., 0.975, na.rm = TRUE), posterior::default_convergence_measures()) post_summary_female_ss_TYstate %&gt;% ggplot(aes(x = ess_bulk)) + geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 残差の自己相関は消えている。 postmean_female_ss_TYstate &lt;- post_summary_female_ss_TYstate %&gt;% filter(str_detect(variable, &quot;p\\\\[&quot;)) %&gt;% mutate(post_mean = inv_logit_scaled(mean)) %&gt;% bind_cols(no_female_over0.5_TYstate) %&gt;% mutate(resid = prop_female - post_mean) acf_female_ss_TYstate &lt;- acf(postmean_female_ss_TYstate$resid, na.action = na.pass, plot = F) data.frame(Lag = acf_female_ss_TYstate$lag[,,1], acf = acf_female_ss_TYstate$acf[,,1]) %&gt;% ggplot(aes(x = Lag, y = acf))+ geom_segment(aes(yend = 0, xend = Lag))+ theme_bw()+ theme(aspect.ratio = 1) 事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## pの事後平均に元データを結合 post_p_female_ss_TYstate &lt;- post_summary_female_ss_TYstate %&gt;% filter(str_detect(variable, &quot;p\\\\[&quot;)) %&gt;% bind_cols(no_female_over0.5_TYstate) %&gt;% drop_na(mean) %&gt;% mutate(mean_prob = inv_logit_scaled(mean)) ## 事後予測値を事後平均からシミュレート post_pred_female_ss_TYstate &lt;- data.frame(matrix(rep(NA,344*100), ncol = 100)) for(i in 1:100){ post_pred_female_ss_TYstate[,i] &lt;- rbinom(n = nrow(nadrop_no_female_TYstate), size = post_p_female_ss_TYstate$max_female, prob = post_p_female_ss_TYstate$mean_prob) } post_pred_female_ss_TYstate %&gt;% bind_cols(nadrop_no_female_TYstate) %&gt;% select(1:100, no_female) %&gt;% rename(y_actual = no_female) %&gt;% pivot_longer(everything(), names_to = &quot;n_draw&quot;, values_to = &quot;post_pred&quot;) %&gt;% mutate(type = ifelse(str_detect(n_draw, &quot;X&quot;),&quot;y_pred&quot;,&quot;y&quot;)) -&gt; post_pred_female_ss_TYstate_long ## 図示 post_pred_female_ss_TYstate_long %&gt;% ggplot(aes(x = post_pred))+ geom_line(stat = &quot;density&quot;, aes(group = n_draw, color = type, alpha = type))+ scale_color_manual(values = c(&quot;blue4&quot;,&quot;lightblue&quot;))+ scale_alpha_discrete(range = c(1, 0.3))+ theme_bw()+ theme(aspect.ratio = 0.8)+ labs(x = &quot;&quot;, y = &quot;&quot;) 8.2.2.4 結果の確認 結果は以下の通り。TYがいる日は有意に確認メス数が多いことが分かった(\\(\\beta_1 = 0.574[0.187-0.962]\\))。 post_summary_female_ss_TYstate %&gt;% filter(str_detect(variable, &quot;b&quot;) | str_detect(variable, &quot;s_t&quot;)) TYの有無をコントロールすると、調査期間間の効果の違いはない。つまり、調査期間間のメス確認割合の違いはTYの有無に大きく影響されていたことが分かった。 draws_female_ss_TYstate &lt;- m_female_ss_TYstate$draws() as_draws_df(draws_female_ss_TYstate, .nchains = 4) %&gt;% select(2:10) %&gt;% mutate(`m18 - m19` = `b[2]` - `b[3]`, `m18 - m20` = `b[2]` - `b[4]`, `m18 - m21` = `b[2]` - `b[5]`, `m18 - nm19` = `b[2]` - `b[6]`, `m18 - nm20` = `b[2]` - `b[7]`, `m18 - nm21` = `b[2]` - `b[8]`, `m18 - nm22` = `b[2]` - `b[9]`, `m19 - m20` = `b[3]` - `b[4]`, `m19 - m21` = `b[3]` - `b[5]`, `m19 - nm19` = `b[3]` - `b[6]`, `m19 - nm20` = `b[3]` - `b[7]`, `m19 - nm21` = `b[3]` - `b[8]`, `m19 - nm22` = `b[3]` - `b[9]`, `m20 - m21` = `b[4]` - `b[5]`, `m20 - nm19` = `b[4]` - `b[6]`, `m20 - nm20` = `b[4]` - `b[7]`, `m20 - nm21` = `b[4]` - `b[8]`, `m20 - nm22` = `b[4]` - `b[9]`, `m21 - nm19` = `b[5]` - `b[6]`, `m21 - nm20` = `b[5]` - `b[7]`, `m21 - nm21` = `b[5]` - `b[8]`, `m21 - nm22` = `b[5]` - `b[9]`, `nm19 - nm20` = `b[6]` - `b[7]`, `nm19 - nm21` = `b[6]` - `b[8]`, `nm19 - nm22` = `b[6]` - `b[9]`, `nm20 - nm21` = `b[7]` - `b[8]`, `nm20 - nm22` = `b[7]` - `b[9]`, `nm21 - nm22` = `b[8]` - `b[9]`) %&gt;% select(-c(1:9)) %&gt;% pivot_longer(everything(), names_to = &quot;cat&quot;, values_to = &quot;Diff&quot;) %&gt;% group_by(cat) %&gt;% summarise(mean = mean(Diff), upper = quantile(Diff, 0.975), lower = quantile(Diff, 0.025)) 8.2.3 調査期間のみ 続いて、調査期間のみを含むモデルを考える。 8.2.3.1 モデリング データのリストは以下の通り。 ## 観測値がある行番号 nadrop_no_female &lt;- drop_na(no_female_over0.5_b %&gt;% select(-IT), prop_female) obs_no &lt;- which(!is.na(no_female_over0.5_b$no_female)) ## 説明変数の行列を作成 X_sp &lt;- matrix(c(nadrop_no_female$m18, nadrop_no_female$m19, nadrop_no_female$m20, nadrop_no_female$m21, nadrop_no_female$nm19, nadrop_no_female$nm20, nadrop_no_female$nm21, nadrop_no_female$nm22), nrow = 383, ncol = 8) colnames(X_sp) &lt;- colnames(nadrop_no_female)[9:16] list_female_sp_ss &lt;- list(len_obs = nrow(nadrop_no_female), obs_no = obs_no, N = nrow(no_female_over0.5_b), X = X_sp, D = ncol(X_sp), no_female = nadrop_no_female$no_female, max_female = nadrop_no_female$max_female) それでは、以下のようにcmdstanr(Gabry et al., 2023)でモデルを回す。 # stan_female_sp_ss &lt;- cmdstan_model(&quot;stanfile/m_female_ss.stan&quot;) # # m_female_sp_ss &lt;- stan_female_sp_ss$sample( # data = list_female_sp_ss, # seed = 13, # iter_sampling = 5000, # iter_warmup = 6000, # thin = 1, # chains = 4, # adapt_delta = 0.999, # max_treedepth = 20 # ) #m_female_sp_ss$save_object(&quot;model/m_female_sp_ss.rds&quot;) m_female_sp_ss &lt;- readRDS(&quot;model/m_female_sp_ss.rds&quot;) 8.2.3.2 モデルの診断 Rhatは小さく、収束に問題ないよう。 rhat_female_sp_ss &lt;- m_female_sp_ss %&gt;% bayesplot::rhat() data.frame(Rhat = rhat_female_sp_ss) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 有効サンプルサイズも少なくとも10000程度ある。 post_summary_female_sp_ss &lt;- m_female_sp_ss$summary(variables = c(&quot;mu&quot;,&quot;p&quot;,&quot;b&quot;,&quot;lp__&quot;,&quot;s_t&quot;,&quot;mu_err&quot;), posterior::default_summary_measures(), lower = ~quantile(., 0.025, na.rm = TRUE), upper = ~quantile(., 0.975, na.rm = TRUE), posterior::default_convergence_measures()) post_summary_female_sp_ss %&gt;% ggplot(aes(x = ess_bulk)) + geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 残差の自己相関は消えている。 postmean_female_sp_ss &lt;- post_summary_female_sp_ss %&gt;% filter(str_detect(variable, &quot;p\\\\[&quot;)) %&gt;% mutate(post_mean = inv_logit_scaled(mean)) %&gt;% bind_cols(no_female_over0.5_b) %&gt;% mutate(resid = prop_female - post_mean) acf_female_sp_ss &lt;- acf(postmean_female_sp_ss$resid, na.action = na.pass, plot = F) data.frame(Lag = acf_female_sp_ss$lag[,,1], acf = acf_female_sp_ss$acf[,,1]) %&gt;% ggplot(aes(x = Lag, y = acf))+ geom_segment(aes(yend = 0, xend = Lag))+ theme_bw()+ theme(aspect.ratio = 1) 事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## pの事後平均に元データを結合 post_p_female_sp_ss &lt;- post_summary_female_sp_ss %&gt;% filter(str_detect(variable, &quot;p\\\\[&quot;)) %&gt;% bind_cols(no_female_over0.5_b) %&gt;% drop_na(mean) %&gt;% mutate(mean_prob = inv_logit_scaled(mean)) ## 事後予測値を事後平均からシミュレート post_pred_female_sp_ss &lt;- data.frame(matrix(rep(NA,383*100), ncol = 100)) for(i in 1:100){ post_pred_female_sp_ss[,i] &lt;- rbinom(n = nrow(nadrop_no_female), size = post_p_female_sp_ss$max_female, prob = post_p_female_sp_ss$mean_prob) } post_pred_female_sp_ss %&gt;% bind_cols(nadrop_no_female) %&gt;% select(1:100, no_female) %&gt;% rename(y_actual = no_female) %&gt;% pivot_longer(everything(), names_to = &quot;n_draw&quot;, values_to = &quot;post_pred&quot;) %&gt;% mutate(type = ifelse(str_detect(n_draw, &quot;X&quot;),&quot;y_pred&quot;,&quot;y&quot;)) -&gt; post_pred_female_sp_ss_long ## 図示 post_pred_female_sp_ss_long %&gt;% ggplot(aes(x = post_pred))+ geom_line(stat = &quot;density&quot;, aes(group = n_draw, color = type, alpha = type))+ scale_color_manual(values = c(&quot;blue4&quot;,&quot;lightblue&quot;))+ scale_alpha_discrete(range = c(1, 0.3))+ theme_bw()+ theme(aspect.ratio = 0.8)+ labs(x = &quot;&quot;, y = &quot;&quot;) 8.2.3.3 結果の確認 結果は以下の通り。TYがいる日は有意に確認メス数が多いことが分かった(\\(\\beta_1 = 0.574[0.187-0.962]\\))。 post_summary_female_sp_ss %&gt;% filter(str_detect(variable, &quot;b&quot;) | str_detect(variable, &quot;s_t&quot;)) 調査期間間の効果の違いについてまとめたのが以下である。いずれの調査期間間も有意な差がないことが分かった。 draws_female_sp_ss &lt;- m_female_sp_ss$draws() ## それぞれの調査期間のTYあり/なしで列を作成 as_draws_df(draws_female_sp_ss, .nchains = 4) %&gt;% select(2:9) %&gt;% mutate(`m18 - m19` = `b[1]` - `b[2]`, `m18 - m20` = `b[1]` - `b[3]`, `m18 - m21` = `b[1]` - `b[4]`, `m18 - nm19` = `b[1]` - `b[5]`, `m18 - nm20` = `b[1]` - `b[6]`, `m18 - nm21` = `b[1]` - `b[7]`, `m18 - nm22` = `b[1]` - `b[8]`, `m19 - m20` = `b[2]` - `b[3]`, `m19 - m21` = `b[2]` - `b[4]`, `m19 - nm19` = `b[2]` - `b[5]`, `m19 - nm20` = `b[2]` - `b[6]`, `m19 - nm21` = `b[2]` - `b[7]`, `m19 - nm22` = `b[2]` - `b[8]`, `m20 - m21` = `b[3]` - `b[4]`, `m20 - nm19` = `b[3]` - `b[5]`, `m20 - nm20` = `b[3]` - `b[6]`, `m20 - nm21` = `b[3]` - `b[7]`, `m20 - nm22` = `b[3]` - `b[8]`, `m21 - nm19` = `b[4]` - `b[5]`, `m21 - nm20` = `b[4]` - `b[6]`, `m21 - nm21` = `b[4]` - `b[7]`, `m21 - nm22` = `b[4]` - `b[8]`, `nm19 - nm20` = `b[5]` - `b[6]`, `nm19 - nm21` = `b[5]` - `b[7]`, `nm19 - nm22` = `b[5]` - `b[8]`, `nm20 - nm21` = `b[6]` - `b[7]`, `nm20 - nm22` = `b[6]` - `b[8]`, `nm21 - nm22` = `b[7]` - `b[8]`) %&gt;% select(-c(1:8)) %&gt;% pivot_longer(everything(), names_to = &quot;cat&quot;, values_to = &quot;Diff&quot;) %&gt;% group_by(cat) %&gt;% summarise(mean = mean(Diff), lower = quantile(Diff, 0.025), upper = quantile(Diff, 0.975)) 8.2.3.4 結果の図示 それでは、結果を図示する。まずは、時系列的に\\(p_t\\)の事後平均と95%確信区間を図示する。 8.3 2021年非交尾期までのデータを用いたモデル 2021年交尾期までのデータを用いることで、ITの確認状況も考慮したモデルを作成する。 8.3.1 TYの有無 + ITの有無 + 調査期間 8.3.1.1 データの加工 no_female_over0.5_bf21nm &lt;- no_female_over0.5_b %&gt;% filter(is.na(prop_female) | (study_period != &quot;m21&quot; &amp; study_period != &quot;nm22&quot;)) %&gt;% filter(date &lt;= &quot;2021-03-27&quot;) 8.3.1.2 モデリング 以下のモデルを考える。 \\(no\\_female_{t}\\): 時点tの確認メス数 \\(max_female_{t}\\): 時点tでの最大メス数 \\(TY_{t}\\)/\\(IT_{t}:\\) t時点のTY/ITの群れ本体での有無 \\(study\\_period_{t}\\): 調査期間を表すダミー変数 \\[ \\begin{aligned} &amp;no\\_female_{t} \\sim Binomial(p_t, max\\_female_t)\\\\ &amp;logit(p_{t}) = \\mu_{t} + \\beta_1 \\times TY_t + \\beta_2 \\times IT_t + \\sum_{j = 3}^10 \\beta_j \\times study\\_period_{t}\\\\ &amp; \\mu_{t} = \\mu_{t-1}+\\epsilon_{t}\\\\ &amp; \\epsilon_{t} \\sim Normal(0,\\sigma^2)\\\\ &amp; \\beta_{1,2,3,4, 5,6,7,8,9} \\sim Student\\_t(0,4,10)\\\\ &amp;\\sigma^2 \\sim Student\\_t(0,4,5)\\\\ \\end{aligned} \\] データのリストは以下の通り。 ## 観測値がある行番号 nadrop_no_female_bf21nm &lt;- drop_na(no_female_over0.5_bf21nm, IT) obs_no_bf21nm &lt;- which(!is.na(no_female_over0.5_bf21nm$no_female)) ## 説明変数の行列を作成 X_bf21nm &lt;- matrix(c(nadrop_no_female_bf21nm$TY, nadrop_no_female_bf21nm$IT, nadrop_no_female_bf21nm$m18, nadrop_no_female_bf21nm$m19, nadrop_no_female_bf21nm$m20, nadrop_no_female_bf21nm$nm19, nadrop_no_female_bf21nm$nm20, nadrop_no_female_bf21nm$nm21), nrow = 265, ncol = 8) list_female_ss_bf21nm &lt;- list(len_obs = nrow(nadrop_no_female_bf21nm), obs_no = obs_no_bf21nm, N = nrow(no_female_over0.5_bf21nm), X = X_bf21nm, D = ncol(X_bf21nm), no_female = nadrop_no_female_bf21nm$no_female, max_female = nadrop_no_female_bf21nm$max_female) それでは、以下のようにcmdstanr(Gabry et al., 2023)でモデルを回す。 # stan_female_ss_bf21nm &lt;- cmdstan_model(&quot;stanfile/m_female_ss.stan&quot;) # m_female_ss_bf21nm &lt;- stan_female_ss_bf21nm$sample( # data = list_female_ss_bf21nm, # seed = 13, # iter_sampling = 5000, # iter_warmup = 6000, # thin = 1, # chains = 4, # adapt_delta = 0.999, # max_treedepth = 20 # ) # # m_female_ss_bf21nm$save_object(&quot;model/m_female_ss_bf21nm.rds&quot;) m_female_ss_bf21nm &lt;- readRDS(&quot;model/m_female_ss_bf21nm.rds&quot;) 8.3.1.2.1 モデルの診断 Rhatは小さく、収束に問題ないよう。 rhat_female_ss_bf21nm &lt;- m_female_ss_bf21nm %&gt;% bayesplot::rhat() data.frame(Rhat = rhat_female_ss_bf21nm) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 有効サンプルサイズも少なくとも10000程度ある。 post_summary_female_ss_bf21nm &lt;- m_female_ss_bf21nm$summary( variables = c(&quot;mu&quot;,&quot;p&quot;,&quot;b&quot;,&quot;lp__&quot;,&quot;s_t&quot;,&quot;mu_err&quot;), posterior::default_summary_measures(), lower = ~quantile(., 0.025, na.rm = TRUE), upper = ~quantile(., 0.975, na.rm = TRUE), posterior::default_convergence_measures()) post_summary_female_ss_bf21nm %&gt;% ggplot(aes(x = ess_bulk)) + geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 残差の自己相関は消えている。 postmean_female_ss_bf21nm &lt;- post_summary_female_ss_bf21nm %&gt;% filter(str_detect(variable, &quot;p\\\\[&quot;)) %&gt;% mutate(post_mean = inv_logit_scaled(mean)) %&gt;% bind_cols(no_female_over0.5_bf21nm) %&gt;% mutate(resid = prop_female - post_mean) acf_female_ss_bf21nm &lt;- acf(postmean_female_ss_bf21nm$resid, na.action = na.pass, plot = F) data.frame(Lag = acf_female_ss_bf21nm$lag[,,1], acf = acf_female_ss_bf21nm$acf[,,1]) %&gt;% ggplot(aes(x = Lag, y = acf))+ geom_segment(aes(yend = 0, xend = Lag))+ theme_bw()+ theme(aspect.ratio = 1) 事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## pの事後平均に元データを結合 post_p_female_ss_bf21nm &lt;- post_summary_female_ss_bf21nm %&gt;% filter(str_detect(variable, &quot;p\\\\[&quot;)) %&gt;% bind_cols(no_female_over0.5_bf21nm) %&gt;% drop_na(mean) %&gt;% mutate(mean_prob = inv_logit_scaled(mean)) ## 事後予測値を事後平均からシミュレート post_pred_female_ss_bf21nm &lt;- data.frame(matrix(rep(NA,265*100), ncol = 100)) for(i in 1:100){ post_pred_female_ss_bf21nm[,i] &lt;- rbinom(n = nrow(nadrop_no_female_bf21nm), size = post_p_female_ss_bf21nm$max_female, prob = post_p_female_ss_bf21nm$mean_prob) } post_pred_female_ss_bf21nm %&gt;% bind_cols(nadrop_no_female_bf21nm) %&gt;% select(1:100, no_female) %&gt;% rename(y_actual = no_female) %&gt;% pivot_longer(everything(), names_to = &quot;n_draw&quot;, values_to = &quot;post_pred&quot;) %&gt;% mutate(type = ifelse(str_detect(n_draw, &quot;X&quot;),&quot;y_pred&quot;,&quot;y&quot;)) -&gt; post_pred_female_ss_bf21nm_long ## 図示 post_pred_female_ss_bf21nm_long %&gt;% ggplot(aes(x = post_pred))+ geom_line(stat = &quot;density&quot;, aes(group = n_draw, color = type, alpha = type))+ scale_color_manual(values = c(&quot;blue4&quot;,&quot;lightblue&quot;))+ scale_alpha_discrete(range = c(1, 0.3))+ theme_bw()+ theme(aspect.ratio = 0.8)+ labs(x = &quot;&quot;, y = &quot;&quot;) 8.3.1.2.2 結果の確認 結果は以下の通り。TYがいる日とITがいる日は有意に確認メス数が多いことが分かった。 post_summary_female_ss_bf21nm %&gt;% filter(str_detect(variable, &quot;b&quot;) | str_detect(variable, &quot;s_t&quot;)) TYの有無をコントロールすると、調査期間間の効果の違いはない。つまり、調査期間間のメス確認割合の違いはTYの有無に大きく影響されていたことが分かった。 draws_female_ss_bf21nm &lt;- m_female_ss_bf21nm$draws() as_draws_df(draws_female_ss_bf21nm, .nchains = 4) %&gt;% select(4:9) %&gt;% mutate(`m18 - m19` = `b[3]` - `b[4]`, `m18 - m20` = `b[3]` - `b[5]`, `m18 - nm19` = `b[3]` - `b[6]`, `m18 - nm20` = `b[3]` - `b[7]`, `m18 - nm21` = `b[3]` - `b[8]`, `m19 - m20` = `b[4]` - `b[5]`, `m19 - nm19` = `b[4]` - `b[6]`, `m19 - nm20` = `b[4]` - `b[7]`, `m19 - nm21` = `b[4]` - `b[8]`, `m20 - nm19` = `b[5]` - `b[6]`, `m20 - nm20` = `b[5]` - `b[7]`, `m20 - nm21` = `b[5]` - `b[8]`, `nm19 - nm20` = `b[6]` - `b[7]`, `nm19 - nm21` = `b[6]` - `b[8]`, `nm20 - nm21` = `b[7]` - `b[8]`) %&gt;% select(-c(1:9)) %&gt;% pivot_longer(everything(), names_to = &quot;cat&quot;, values_to = &quot;Diff&quot;) %&gt;% group_by(cat) %&gt;% summarise(mean = mean(Diff), lower = quantile(Diff, 0.025), upper = quantile(Diff, 0.975)) 8.3.1.2.3 結果の図示 それでは、結果を図示する。まずは、時系列的に\\(p_t\\)の事後平均と95%確信区間を図示する。 TYの有無で確認メス割合を比較したものを図示したのが以下である。 as_draws_df(draws_female_ss_bf21nm, .nchains = 4) %&gt;% select(contains(&quot;p[&quot;)) %&gt;% pivot_longer(everything(), names_to = &quot;p&quot;, values_to = &quot;post&quot;) %&gt;% drop_na() %&gt;% mutate(p2 = as.numeric(str_replace_all(p, c(&quot;p\\\\[&quot; = &quot;&quot;,&quot;\\\\]&quot; = &quot;&quot;)))) %&gt;% left_join(no_female_over0.5_bf21nm %&gt;% mutate(p2 = 1:n()), by = &quot;p2&quot;) %&gt;% group_by(TY) %&gt;% summarise(mean_prob = inv_logit_scaled(mean(post)), lower_prob = inv_logit_scaled(quantile(post, 0.025)), upper_prob = inv_logit_scaled(quantile(post, 0.975))) %&gt;% mutate(TY = as.factor(TY)) -&gt; post_female_ss_bf21nm_TY nadrop_no_female_bf21nm %&gt;% mutate(TY = as.factor(TY)) %&gt;% ggplot(aes(x = TY, y = prop_female))+ geom_violin(bw = 0.04, aes(fill = TY))+ geom_boxplot(width = 0.2, aes(fill = TY), outlier.alpha = 0) + geom_pointrange(data = post_female_ss_bf21nm_TY, aes(y = mean_prob, ymin = lower_prob,ymax = upper_prob), color = &quot;grey92&quot;,size = 0.4)+ geom_errorbar(data = post_female_ss_bf21nm_TY, aes(y = mean_prob, ymin = lower_prob,ymax = upper_prob), color = &quot;grey92&quot;,width = 0.1,size=0.6)+ scale_fill_nejm()+ scale_x_discrete(labels = c(&quot;No&quot;,&quot;Yes&quot;))+ labs(y = &quot;proportion of comfirmed females&quot;, x = &quot;TY confirmed&quot;, fill = &quot;&quot;) + theme_bw(base_size = 13) + guides(fill = &quot;none&quot;)+ theme(aspect.ratio = 1) ITの有無で確認メス割合を比較したものを図示したのが以下である。 as_draws_df(draws_female_ss_bf21nm, .nchains = 4) %&gt;% select(contains(&quot;p[&quot;)) %&gt;% pivot_longer(everything(), names_to = &quot;p&quot;, values_to = &quot;post&quot;) %&gt;% drop_na() %&gt;% mutate(p2 = as.numeric(str_replace_all(p, c(&quot;p\\\\[&quot; = &quot;&quot;,&quot;\\\\]&quot; = &quot;&quot;)))) %&gt;% left_join(no_female_over0.5_bf21nm %&gt;% mutate(p2 = 1:n()), by = &quot;p2&quot;) %&gt;% group_by(IT) %&gt;% summarise(mean_prob = inv_logit_scaled(mean(post)), lower_prob = inv_logit_scaled(quantile(post, 0.025)), upper_prob = inv_logit_scaled(quantile(post, 0.975))) %&gt;% mutate(IT = as.factor(IT)) -&gt; post_female_ss_bf21nm_IT nadrop_no_female_bf21nm %&gt;% mutate(IT = as.factor(IT)) %&gt;% ggplot(aes(x = IT, y = prop_female))+ geom_violin(bw = 0.04, aes(fill = IT))+ geom_boxplot(width = 0.2, aes(fill = IT), outlier.alpha = 0) + geom_pointrange(data = post_female_ss_bf21nm_IT, aes(y = mean_prob, ymin = lower_prob,ymax = upper_prob), color = &quot;grey92&quot;,size = 0.4)+ geom_errorbar(data = post_female_ss_bf21nm_IT, aes(y = mean_prob, ymin = lower_prob,ymax = upper_prob), color = &quot;grey92&quot;,width = 0.1,size=0.6)+ scale_fill_nejm()+ scale_x_discrete(labels = c(&quot;No&quot;,&quot;Yes&quot;))+ labs(y = &quot;proportion of comfirmed females&quot;, x = &quot;IT confirmed&quot;, fill = &quot;&quot;) + theme_bw() + guides(fill = &quot;none&quot;)+ theme(aspect.ratio = 1) 交尾期のみのを用いて図示したのが以下である。 as_draws_df(draws_female_ss_bf21nm, .nchains = 4) %&gt;% select(contains(&quot;p[&quot;)) %&gt;% pivot_longer(everything(), names_to = &quot;p&quot;, values_to = &quot;post&quot;) %&gt;% drop_na() %&gt;% mutate(p2 = as.numeric(str_replace_all(p, c(&quot;p\\\\[&quot; = &quot;&quot;,&quot;\\\\]&quot; = &quot;&quot;)))) %&gt;% left_join(no_female_over0.5_bf21nm %&gt;% mutate(p2 = 1:n()), by = &quot;p2&quot;) %&gt;% filter(study_period %in% c(&quot;m18&quot;,&quot;m19&quot;,&quot;m20&quot;,&quot;m21&quot;)) %&gt;% group_by(IT) %&gt;% summarise(mean_prob = inv_logit_scaled(mean(post)), lower_prob = inv_logit_scaled(quantile(post, 0.025)), upper_prob = inv_logit_scaled(quantile(post, 0.975))) %&gt;% mutate(IT = as.factor(IT)) -&gt; post_female_ss_bf21nm_IT_m nadrop_no_female_bf21nm %&gt;% filter(study_period %in% c(&quot;m18&quot;,&quot;m19&quot;,&quot;m20&quot;,&quot;m21&quot;)) %&gt;% mutate(IT = as.factor(IT)) %&gt;% ggplot(aes(x = IT, y = prop_female))+ geom_violin(bw = 0.04, aes(fill = IT))+ geom_boxplot(width = 0.2, aes(fill = IT), outlier.alpha = 0) + geom_pointrange(data = post_female_ss_bf21nm_IT_m, aes(y = mean_prob, ymin = lower_prob,ymax = upper_prob), color = &quot;grey92&quot;,size = 0.4)+ geom_errorbar(data = post_female_ss_bf21nm_IT_m, aes(y = mean_prob, ymin = lower_prob,ymax = upper_prob), color = &quot;grey92&quot;,width = 0.1,size=0.6)+ scale_fill_nejm()+ scale_x_discrete(labels = c(&quot;No&quot;,&quot;Yes&quot;))+ labs(y = &quot;proportion of comfirmed females&quot;, x = &quot;IT confirmed&quot;, fill = &quot;&quot;) + theme_bw(base_size = 18) + guides(fill = &quot;none&quot;)+ theme(aspect.ratio = 1) -&gt; p_female_ss_bf21_IT_m p_female_ss_bf21_IT_m # ggsave(&quot;figures/p_female_ss_bf21_IT_m.png&quot;,p_female_ss_bf21_IT_m, dpi = 600, units = &quot;mm&quot;, # width = 100, height = 100) References Gabry, J., Češnovar, R., &amp; Johnson, A. (2023). Cmdstanr: R interface to ’CmdStan’. Matsuura, K. (2023). Bayesian statistical modeling with stan, r, and python. Springer Nature. 馬場真哉. (2019). R と stan ではじめるベイズ統計モデリングによるデータ分析入門. 講談社. "],["10_female_out_analysis.html", "9 メスが群れを離れるメカニズム 9.1 データの加工 9.2 基本的な情報 9.3 分析(モデリング)", " 9 メスが群れを離れるメカニズム 前章までの分析により、TYとITが群れを出入りすることが群れ本体における確認メス割合に影響している可能背うが高いことが分かった。それでは、実際にそれぞれのメスはどのようなメカニズムで群れを出るか否かを決めているのだろうか? 以下では、メスの毎日の確認状況のデータからメスが群れを離れる要因を探る(図9.1)。オスの出入りの他、彼らとの親密度、アカンボウの有無、発情の有無、オスの攻撃などの要因を検討する。 図9.1: メスの確認状況に影響する要因 9.1 データの加工 9.1.1 オスが群れを離れた日の特定 まず、TYとITが群れを離れたと考えられる日にちについての列のあるデータフレームを作成する。ここでは、「1時間以上確認された翌日に群れ本体で一度も確認できないとき」に群れを離れたとみなす。 ## 群れ本体でかつ240分以上追跡した日のデータとオスの確認状況のデータを結合 no_female_over0.5 %&gt;% left_join(TYIT_presence, by = c(&quot;date&quot;, &quot;groupID&quot;)) %&gt;% mutate(date = as_date(date)) %&gt;% select(date, groupID, study_period, TY, IT) -&gt; TYIT_presence_over0.5 ## 前日の確認状況の列を作成 TYIT_presence_over0.5 %&gt;% mutate(date_pre = date - 1) %&gt;% select(date, date_pre, groupID) %&gt;% left_join(TYIT_presence_over0.5 %&gt;% select(-groupID, -study_period), by = c(&quot;date_pre&quot; = &quot;date&quot;)) %&gt;% rename(TY_pre = TY, IT_pre = IT) %&gt;% left_join(TYIT_presence, by = c(&quot;date&quot;, &quot;groupID&quot;)) -&gt; TYIT_presence_pre ## TYとITが「群れを離れた」か否かの列を作成 TYIT_presence_pre %&gt;% mutate(TY_out = ifelse(is.na(TY_pre), NA, ifelse(TY_pre == 1 &amp; TY == 0,1,0)), IT_out = ifelse(is.na(TY_pre), NA, ifelse(IT_pre == 1 &amp; IT == 0,1,0))) -&gt; male_out データは以下の通り。 datatable(male_out) 9.1.2 メスが群れを離れた日の同定 続いて、各メスが群れを離れたか否かを記したデータフレームを作成する。また、前日のアカンボウの有無や発情の有無などの情報も結合する。 ## メスのアカンボウの有無 infant &lt;- read_csv(&quot;../Data/data/others/female_infant.csv&quot;) infant %&gt;% pivot_longer(Kur:Cur, names_to = &quot;femaleID&quot;, values_to = &quot;infant&quot;) %&gt;% mutate(date = as_date(date)) -&gt; infant_long # 群れ本体でかつ240分以上追跡した日のデータとメスの確認状況のデータを結合 no_female_over0.5 %&gt;% select(groupID) %&gt;% left_join(group_all %&gt;% select(-c(TY,IT,KR,LK,KM,TG))) %&gt;% select(-(start:fin)) %&gt;% ## 縦型にする pivot_longer(Kur:Yun, names_to = &quot;femaleID&quot;, values_to = &quot;presence&quot;) %&gt;% left_join(att, by = c(&quot;femaleID&quot;, &quot;study_period&quot;)) %&gt;% ## 6歳以上のみ抽出 filter(age &gt;= 6) %&gt;% left_join(female_time_long %&gt;% select(date, femaleID, presence) %&gt;% rename(time = presence), by = c(&quot;date&quot;,&quot;femaleID&quot;)) %&gt;% ## 死亡個体は除く filter(is.na(time)| time != &quot;DD&quot;) %&gt;% select(-time) %&gt;% mutate(date = as_date(date)) -&gt; female_pre_long ## 発情状態とアカンボウの有無を結合 female_pre_long %&gt;% mutate(date_pre = date - 1) %&gt;% left_join(female_pre_long %&gt;% select(date, femaleID, presence) %&gt;% rename(presence_pre = presence), by = c(&quot;date_pre&quot; = &quot;date&quot;, &quot;femaleID&quot;)) %&gt;% mutate(female_out = ifelse(is.na(presence_pre), NA, ifelse(presence_pre == 1 &amp; presence == 0,1,0))) %&gt;% left_join(female_all %&gt;% select(date, femaleID, rs2) %&gt;% mutate(date = date + 1) %&gt;% rename(rs_pre = rs2), by = c(&quot;date&quot;, &quot;femaleID&quot;)) %&gt;% left_join(infant_long %&gt;% mutate(date = date + 1) %&gt;% rename(infant_pre = infant), by = c(&quot;date&quot;,&quot;femaleID&quot;)) %&gt;% ## 前日にメスがいる日のみを抽出 filter(presence_pre == 1) %&gt;% ## オスの出入りがある期間のみを抽出 filter(study_period %in% c(&quot;m19&quot;, &quot;m20&quot;, &quot;m21&quot;, &quot;nm20&quot;, &quot;nm21&quot;)) -&gt; female_out 9.1.3 オスの攻撃頻度 続いて、オスの攻撃についての情報を加工する。各観察日のそれぞれのメスが攻撃された頻度と、群れ全体で攻撃が確認された頻度について算出する。 ### 6歳以上への攻撃のみ aggression_all %&gt;% mutate(femaleID = str_replace_all(femaleID, &quot;\\\\?&quot;,&quot;&quot;)) %&gt;% left_join(att, by = c(&quot;femaleID&quot;, &quot;study_period&quot;)) %&gt;% ## 確実に被攻撃個体が6歳以上であるものを抽出 filter(age &gt;= 6 | str_detect(femaleID,&quot;multi|many|Multi|KunTrt|Ako,Kil&quot;)) %&gt;% group_by(date) %&gt;% summarise(no_agg = length(unique(no))) %&gt;% ungroup() %&gt;% right_join(no_female_over0.5) %&gt;% replace_na(list(no_agg = 0)) %&gt;% mutate(rate_agg_6yo = no_agg*60/dur) %&gt;% select(date, groupID, no_agg, rate_agg_6yo, dur) %&gt;% filter(!str_detect(groupID, &quot;nm&quot;)) %&gt;% filter(date &gt;= &quot;2018-10-08&quot;) -&gt; agg_rate_6yo ### 全攻撃 aggression_all %&gt;% group_by(date) %&gt;% summarise(no_agg = length(unique(no))) %&gt;% ungroup() %&gt;% right_join(no_female_over0.5) %&gt;% replace_na(list(no_agg = 0)) %&gt;% mutate(rate_agg_all = no_agg*60/dur) %&gt;% select(date, groupID, no_agg, rate_agg_all, dur) %&gt;% filter(!str_detect(groupID, &quot;nm&quot;)) %&gt;% filter(date &gt;= &quot;2018-10-08&quot;) -&gt; agg_rate_all ### 個体ごとの被攻撃頻度 aggression_all %&gt;% left_join(att, by = c(&quot;study_period&quot;, &quot;femaleID&quot;)) %&gt;% filter(!is.na(age)) %&gt;% group_by(date, femaleID) %&gt;% summarise(no_agg = n()) %&gt;% ungroup() %&gt;% complete(date,femaleID) %&gt;% replace_na(list(no_agg = 0)) %&gt;% mutate(study_period = str_c(&quot;m&quot;,str_sub(year(date),3,4))) %&gt;% left_join(att, by = c(&quot;study_period&quot;, &quot;femaleID&quot;)) %&gt;% ## 6歳以上を抽出 filter(!is.na(age)) %&gt;% right_join(no_female_over0.5 %&gt;% select(date, groupID, dur)) %&gt;% filter(!str_detect(study_period,&quot;nm&quot;)) %&gt;% mutate(rate_agg = no_agg*60/dur) %&gt;% left_join(group_all %&gt;% select(-c(TY,IT,KR,LK,KM,TG)) %&gt;% select(-c(start:fin)) %&gt;% pivot_longer(Kur:Yun, names_to = &quot;femaleID&quot;, values_to = &quot;presence&quot;), by = c(&quot;date&quot;, &quot;femaleID&quot;,&quot;study_period&quot;,&quot;groupID&quot;)) -&gt; agg_rate_each 9.1.4 血縁個体が群れを出たか否か 続いて、各観察日に血縁個体が離れたか否かを求める。ここでは、離れた個体の最大血縁度を算出する。 kin &lt;- read_csv(&quot;../Data/data/others/kin.csv&quot;) female_out %&gt;% select(groupID, date, study_period, femaleID, female_out, presence_pre) %&gt;% ## 他のメスのデータを結合 left_join(att %&gt;% filter(age &gt;= 6) %&gt;% select(study_period, femaleID) %&gt;% rename(femaleID2 = femaleID), by = &quot;study_period&quot;) %&gt;% filter(femaleID != femaleID2) %&gt;% ## 他のメスが群れを離れたか否かの列を作成 left_join(female_out %&gt;% select(groupID, date, femaleID, female_out) %&gt;% rename(female_out2 = female_out, femaleID2 = femaleID), by = c(&quot;groupID&quot;,&quot;date&quot;, &quot;femaleID2&quot;)) %&gt;% replace_na(list(female_out2 = 0)) %&gt;% ## 相手のメスとの血縁度を結合 left_join(kin, by = c(&quot;femaleID&quot;, &quot;femaleID2&quot;)) %&gt;% filter(female_out2 == 1) %&gt;% ## それぞれの日で離れたメスの最大の血縁度を算出 group_by(groupID, date, femaleID) %&gt;% summarise(max_kin = max(kin), ## 血縁カテゴリーも作成する kin_cat = as.character(max(kin))) -&gt; kin_female_out 9.1.5 群れ外オス数の算出 続いて、各観察日の群れ外オス数を算出する。 no_ntm_m19 &lt;- male_19m %&gt;% filter(!(maleID %in% c(&quot;TY&quot;, &quot;IT&quot;, &quot;KR&quot;, &quot;LK&quot;))) %&gt;% group_by(date) %&gt;% summarise(no_ntm = sum(presence, na.rm = TRUE)) no_ntm_m20 &lt;- male_20m %&gt;% filter(!(maleID %in% c(&quot;TY&quot;, &quot;IT&quot;, &quot;KR&quot;, &quot;LK&quot;, &quot;KM&quot;, &quot;TG&quot;))) %&gt;% group_by(date) %&gt;% summarise(no_ntm = sum(presence, na.rm = TRUE)) no_ntm_m21 &lt;- male_21m %&gt;% filter(!(maleID %in% c(&quot;TY&quot;, &quot;IT&quot;, &quot;KR&quot;, &quot;LK&quot;, &quot;KM&quot;, &quot;TG&quot;))) %&gt;% group_by(date) %&gt;% summarise(no_ntm = sum(presence, na.rm = TRUE)) sum_ntm &lt;- bind_rows(no_ntm_m19, no_ntm_m20, no_ntm_m21) 9.1.6 全データの結合 最後に、全データを結合する。 female_out %&gt;% left_join(no_female_over0.5 %&gt;% select(date, prop_female) %&gt;% rename(date_pre = date), by = c(&quot;date_pre&quot;)) %&gt;% left_join(male_out %&gt;% select(date, groupID, TY_out, IT_out), by = c(&quot;date&quot;, &quot;groupID&quot;)) %&gt;% left_join(agg_rate_6yo %&gt;% select(date, rate_agg_6yo) %&gt;% mutate(date = date + 1) %&gt;% rename(rate_agg_6yo_pre = rate_agg_6yo), by = c(&quot;date&quot;)) %&gt;% left_join(agg_rate_all %&gt;% select(date, rate_agg_all) %&gt;% mutate(date = date + 1) %&gt;% rename(rate_agg_all_pre = rate_agg_all), by = c(&quot;date&quot;)) %&gt;% left_join(CSI_TY %&gt;% rename(femaleID = subject) %&gt;% select(femaleID, CSI_TY), by = &quot;femaleID&quot;) %&gt;% left_join(CSI_IT %&gt;% rename(femaleID = subject) %&gt;% select(femaleID, CSI_IT), by = &quot;femaleID&quot;) %&gt;% left_join(no_female_over0.5_b %&gt;% select(date, TY, IT) %&gt;% mutate(date = date + 1) %&gt;% rename(TY_pre = TY, IT_pre = IT)) %&gt;% left_join(kin_female_out, by = c(&quot;groupID&quot;,&quot;date&quot;, &quot;femaleID&quot;)) %&gt;% left_join(sum_ntm, by = c(&quot;date_pre&quot; = &quot;date&quot;)) %&gt;% replace_na(list(max_kin = 0, kin_cat = &quot;no&quot;)) %&gt;% mutate(kin_01 = ifelse(max_kin &gt; 0, 1,0)) %&gt;% mutate(kin_cat = as.factor(kin_cat)) %&gt;% group_by(study_period) %&gt;% ## 相対順位を算出 mutate(max_rank = max(rank)) %&gt;% ungroup() %&gt;% mutate(rank_scaled = rank/max_rank) -&gt; female_out_final 9.2 基本的な情報 交尾期/非交尾期または、発情/非発情で群れを離れる頻度(回/10日)を図示すると以下のようになる。非交尾期 &lt; 交尾期・非発情 &lt; 交尾期・発情の順に高くなる。非交尾期にはほとんどないようだ。 female_out_summary &lt;- female_out_final %&gt;% mutate(season = ifelse(str_detect(study_period, &quot;nm&quot;), &quot;nonmating&quot;, &quot;mating&quot;)) %&gt;% group_by(femaleID, season, rs_pre) %&gt;% summarise(n = n(), sum_out = sum(female_out)) %&gt;% replace_na(list(rs_pre = 0)) %&gt;% ungroup() %&gt;% mutate(rate_out = sum_out*10/n) female_out_summary %&gt;% mutate(rs_pre2 = ifelse(season == &quot;nonmating&quot;, &quot;非交尾期&quot;, ifelse(season == &quot;mating&quot; &amp; rs_pre == 1, &quot;発情&quot;, &quot;非発情&quot;))) %&gt;% mutate(rs_pre2 = as.factor(rs_pre2)) %&gt;% mutate(rs_pre2 = fct_relevel(rs_pre2, &quot;非発情&quot;, &quot;発情&quot;)) %&gt;% ggplot(aes(x = rs_pre2, y = rate_out))+ geom_violin(bw = 0.25, scale = &quot;width&quot;, aes(fill = season))+ geom_beeswarm(shape = 21, cex = 1.7, alpha = 0.7, fill = &quot;white&quot;, color = &quot;black&quot;, size = 2)+ theme_bw(base_size = 15)+ scale_fill_manual(values = c(&quot;orange2&quot;, &quot;green4&quot;))+ labs(x = &quot;&quot;, y = &quot;Frequency of leaving troop (times/10 days)&quot;) + theme(aspect.ratio = 1, axis.title.y = element_text(family = &quot;Arial&quot;, size = 12), axis.title.x = element_text(family = &quot;Yu Gothic&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12), axis.text.y = element_text(family = &quot;Arial&quot;)) -&gt; p_female_out_rate p_female_out_rate # ggsave(&quot;figures/p_female_out_rate.png&quot;, # p_female_out_rate, dpi = 600, width = 140, height = 100, # units = &quot;mm&quot;) 9.3 分析(モデリング) 以下では、交尾期と非交尾期に分けて分析を行う。また、交尾期については発情メスと非発情メスを分けて分析を行う。分析に含まれるのは、6歳以上でかつTY、ITとのCSIが算出できる個体(= 2019年時点で6歳以上の個体)である。 ITは2021年は群れから移出してしまっていた。これが結果に影響していないか確かめるため、以下のすべてのモデルについて、2019~2021年の全期間のデータを用いたモデルと、2020年までのデータを用いたモデルの2つを実行する。 9.3.1 交尾期(非発情メス) 9.3.1.1 データの加工 まず、データの加工を行う。 female_out_an &lt;- female_out_final %&gt;% filter(!str_detect(study_period, &quot;nm&quot;)) %&gt;% filter(rs_pre == &quot;0&quot;) %&gt;% ## TYとITとのCSIがないメスは除く drop_na(CSI_TY) %&gt;% mutate(rate_agg_6yo_std = standardize(rate_agg_6yo_pre), rate_agg_all_std = standardize(rate_agg_all_pre)) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), rank_std = standardize(rank_scaled), age_std = standardize(age), kin_std = standardize(max_kin), ntm_std = standardize(no_ntm), prop_std = standardize(prop_female)) %&gt;% ## 2021年はIT_outを全て0とする replace_na(list(IT_out = 0, IT_pre = 0)) %&gt;% mutate(date = as_date(date)) 9.3.1.2 モデリング1 モデル式は以下の通り。 説明変数の説明は以下の通り。なお、\\(i, j, k\\)はそれぞれデータ番号、日付番号、メスIDの番号を表す。なお、連続変数は全て標準化している。 \\(TY\\_out/IT\\_out\\): TY/ITが群れを離れたか否か \\(CSI\\_TY/CSI\\_IT\\): 各メスとTY/ITとの親密度 \\(rate\\_agg\\_all\\): 前日の群れ内のオスの攻撃頻度 \\(no_ntm\\): 前日の群れ外オス数 \\(infant\\): アカンボウの有無 \\(age\\): 年齢 \\(rank\\): 0から1にスケール化された順位 \\(kin\\_01\\): 同じ日に群れを離れたメスがいたか否か \\(study\\_period(m19,m20,m21)\\): 調査期間 \\[ \\begin{aligned} female\\_out_i &amp;\\sim Bernoulli(p_i) \\\\ logit(p_i) = &amp;\\beta_0 + \\beta_1 \\times rate\\_agg\\_all_i + \\beta_2 \\times TY\\_out_i + \\beta_3 \\times IT\\_out_i + \\beta_4 \\times CSI\\_TY_i + \\beta_5 \\times CSI\\_IT_i + \\\\ &amp;\\beta_6 \\times rank_i + \\beta_7 \\times age_i + \\beta_8 \\times infant_i + \\beta_9 \\times TY\\_out_i \\times CSI\\_TY_i + \\\\ &amp;\\beta_{10} \\times IT\\_out_i \\times CSI\\_IT_i + \\beta_{11} \\times no\\_ntm_i + \\beta_{12} \\times kin_i + \\beta_{13} \\times m20_i + \\beta_{13} \\times m21_i + r_j + \\gamma_k\\\\ r_j &amp;\\sim Normal(0, \\sigma_r)\\\\ \\gamma_k &amp;\\sim Normal(0, \\sigma_{\\gamma})\\\\ \\beta_0 &amp;\\sim student\\_t(4,0,20)\\\\ \\beta_{1,2,\\dots,12} &amp;\\sim student_t(0,4,10)\\\\ \\sigma_{r, \\gamma} &amp;\\sim student_t(0,4,10)\\\\ \\end{aligned} \\] モデルは以下のように実行する。**2019~2021年 ## 全個体への攻撃 ### 攻撃頻度とオスの出入りの交互作用なし m_female_out_an &lt;- brm(data = female_out_an %&gt;% mutate(date = as.factor(date)), female_out ~ rate_agg_all_std + TY_out*CSI_TY_std + IT_out*CSI_IT_std + ntm_std + prop_std + infant_pre + age_std + rank_std + kin_01 + study_period + (1|femaleID) + (1|date), family = &quot;bernoulli&quot;, prior = c(prior(student_t(4,0,20),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,10), class = sd)), iter = 11000, warmup = 1000, seed = 223, control=list(adapt_delta = 0.999, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_out_an&quot;) ## 2021年交尾期を除く female_out_an %&gt;% filter(study_period != &quot;m21&quot;) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), rank_std = standardize(rank_scaled), age_std = standardize(age), kin_std = standardize(max_kin), ntm_std = standardize(no_ntm), prop_std = standardize(prop_female), rate_agg_all_std = standardize(rate_agg_all_pre)) %&gt;% mutate(date = as.factor(date)) -&gt; female_out_an_no21 m_female_out_an_no21 &lt;- brm(data = female_out_an_no21, female_out ~ rate_agg_all_std + TY_out*CSI_TY_std + IT_out*CSI_IT_std + ntm_std + prop_std + infant_pre + age_std + rank_std + kin_01 + study_period + (1|femaleID) + (1|date), family = &quot;bernoulli&quot;, prior = c(prior(student_t(4,0,20),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,10), class = sd)), iter = 11000, warmup = 1000, seed = 223, control=list(adapt_delta = 0.999, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_out_an_no21&quot;) 9.3.1.2.1 モデルチェック まず、DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。いずれのモデルも特に問題はないよう。 ## 全期間 dh_female_out_an &lt;- dh_check_brms(m_female_out_an, quantreg = TRUE) ## 2021年を除く dh_female_out_an_no21 &lt;- dh_check_brms(m_female_out_an_no21, quantreg = TRUE) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## 全期間 pp_check(m_female_out_an, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) ## 2021年を除く pp_check(m_female_out_an_no21, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) 多重共線性のチェックもお個あったが、VIFに問題はない。 ## 全期間 check_collinearity(m_female_out_an) ## 2021年を除く check_collinearity(m_female_out_an_no21) Rhatにも問題はなく、収束の問題はないよう。 ## 全期間 data.frame(Rhat = brms::rhat(m_female_out_an)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) ## 2021年を除く data.frame(Rhat = brms::rhat(m_female_out_an_no21)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 最後に残差の時系列相関のチェックを行う。 まず1つ目のモデルについてチェックする。残差の自己相関をプロットすると、明確なパターンは見られなかった。また、Ljung-Box検定で5時点前までの残差との自己相関を検定したところ、有意な自己相関を示したのはMifとTenのみであった。 res_female_out_an &lt;- female_out_an %&gt;% mutate(resid = dh_female_out_an$scaledResiduals) %&gt;% mutate(date = as_date(date)) %&gt;% group_by(femaleID) %&gt;% complete(date = seq.Date(min(date), max(date), by = &quot;1 day&quot;)) %&gt;% ungroup() females &lt;- unique(female_out_an$femaleID) acf_female_out_an &lt;- NULL for(i in seq_along(females)){ data &lt;- res_female_out_an %&gt;% filter(femaleID == females[i]) out.acf &lt;- acf(data$resid, lag.max = 5, na.action = na.pass, plot = F) box_test &lt;- Box.test(data$resid, type = &quot;Ljung-Box&quot;, lag = 5) out.df &lt;- data.frame(Timelag = out.acf$lag, Acf = out.acf$acf, femaleID = females[i], p = box_test$p.value) acf_female_out_an &lt;- bind_rows(acf_female_out_an, out.df) } acf_female_out_an %&gt;% mutate(p = str_c(&quot;p = &quot;,round(p,2))) %&gt;% ggplot(aes(x = Timelag, y = 0))+ geom_segment(aes(xend = Timelag, yend = Acf))+ geom_text(aes(x = 4, y = 0.8, label = p), size = 3.5, family = &quot;Arial&quot;)+ theme_bw()+ theme(aspect.ratio = 1)+ facet_rep_wrap(~femaleID, repeat.tick.labels = TRUE) 2020年までのデータを用いたモデルでは、有意な自己相関がみられたのはHotのみだった。 res_female_out_an_no21 &lt;- female_out_an_no21 %&gt;% mutate(resid = dh_female_out_an_no21$scaledResiduals) %&gt;% mutate(date = as_date(date)) %&gt;% group_by(femaleID) %&gt;% complete(date = seq.Date(min(date), max(date), by = &quot;1 day&quot;)) %&gt;% ungroup() females &lt;- unique(female_out_an_no21$femaleID) acf_female_out_an_no21 &lt;- NULL for(i in seq_along(females)){ data &lt;- res_female_out_an_no21 %&gt;% filter(femaleID == females[i]) out.acf &lt;- acf(data$resid, lag.max = 5, na.action = na.pass, plot = F) box_test &lt;- Box.test(data$resid, type = &quot;Ljung-Box&quot;, lag = 5) out.df &lt;- data.frame(Timelag = out.acf$lag, Acf = out.acf$acf, femaleID = females[i], p = box_test$p.value) acf_female_out_an_no21 &lt;- bind_rows(acf_female_out_an_no21, out.df) } acf_female_out_an_no21 %&gt;% mutate(p = str_c(&quot;p = &quot;,round(p,2))) %&gt;% ggplot(aes(x = Timelag, y = 0))+ geom_segment(aes(xend = Timelag, yend = Acf))+ geom_text(aes(x = 4, y = 0.8, label = p), size = 3.5, family = &quot;Arial&quot;)+ theme_bw()+ theme(aspect.ratio = 1)+ facet_rep_wrap(~femaleID, repeat.tick.labels = TRUE) DHARMaパッケージで調べても有意な時系列相関は検出されなかった。ただし、この分析ではLagが実際の日付をもとに算出されていない可能性が高い。 all_test_acf_an &lt;- NULL for(i in seq_along(females)){ dh_female_out_an_b &lt;- recalculateResiduals(dh_female_out_an, sel = female_out_an$femaleID == females[i]) test_acf_an &lt;- testTemporalAutocorrelation(dh_female_out_an_b, time = female_out_an %&gt;% filter(femaleID == females[i]) %&gt;% .$date, plot = FALSE) df_test_acf_an &lt;- data.frame(femaleID = females[i], p = test_acf_an$p.value) all_test_acf_an &lt;- bind_rows(all_test_acf_an, df_test_acf_an) } all_test_acf_an 2020年までのデータでも同様。 all_test_acf_an_no21 &lt;- NULL for(i in seq_along(females)){ dh_female_out_an_no21_b &lt;- recalculateResiduals(dh_female_out_an_no21, sel = female_out_an_no21$femaleID == females[i]) test_acf_an &lt;- testTemporalAutocorrelation(dh_female_out_an_no21_b, time = female_out_an_no21 %&gt;% filter(femaleID == females[i]) %&gt;% .$date, plot = FALSE) df_test_acf_an &lt;- data.frame(femaleID = females[i], p = test_acf_an$p.value) all_test_acf_an_no21 &lt;- bind_rows(all_test_acf_an_no21, df_test_acf_an) } all_test_acf_an_no21 9.3.1.2.2 結果の確認 9.3.1.2.2.1 推定された係数 まずは、全期間のデータを用いたモデルについてみる。太字になっている変数は95%確信区間が0をまたいでおらず、有意な影響があるといえる。 .cl-9938d758{table-layout:auto;width:90%;}.cl-99317c06{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-99317c10{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-99317c1a{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-99317c1b{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-99347fdc{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-99347fe6{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-993497ec{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-993497ed{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-993497f6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-993497f7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-993497f8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-993497f9{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-7.77[-10.54,-5.75]1.009,362.41TYが群れを離れたか (vs 否)1.51[-0.11,3.36]1.0015,488.81TYとの親密度(CSI)-0.92[-2.34,0.38]1.0016,155.30TYが群れを離れたか ×TYとの親密度1.62[0.70,2.64]1.0038,803.20ITが群れを離れたか (vs 否)0.24[-2.20,2.43]1.0019,243.05ITとの親密度(CSI)0.31[-0.62,1.23]1.0016,236.91ITが群れを離れたか ×ITとの親密度0.02[-1.24,1.32]1.0048,973.52前日のオスからの攻撃頻度0.26[-0.31,0.88]1.0015,421.64前日の群れ外オス数0.12[-0.63,0.83]1.0020,781.75血縁のメスが群れを離れたか(vs 否)2.28[1.33,3.19]1.0020,235.91順位0.20[-1.03,1.35]1.0015,051.52年齢0.61[-0.40,1.63]1.0015,886.72アカンボウの有無 (vs 無)1.19[0.05,2.41]1.0032,436.25前日確認したメスの割合-0.28[-0.83,0.29]1.0022,324.36調査期間(m20 vs m19)1.52[-0.26,3.66]1.0013,834.60調査期間(m21 vs m19)0.86[-0.95,2.94]1.0013,953.63 続いて、2021年のデータを除いたモデルについて確認する。少しの違いはあるが、ITがかかわる変数については変化がない。 .cl-9d33d5ce{table-layout:auto;width:90%;}.cl-9d2cce1e{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9d2cce28{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9d2cce32{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9d2cce3c{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9d2fca56{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9d2fca60{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9d2fdfdc{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d2fdfdd{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d2fdfe6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d2fdfe7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d2fdfe8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d2fdff0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-8.59[-12.64,-6.01]1.008,248.81TYが群れを離れたか (vs 否)1.52[-0.41,3.97]1.0013,331.66TYとの親密度(CSI)-0.77[-2.46,0.79]1.0016,269.90TYが群れを離れたか ×TYとの親密度1.71[0.61,3.01]1.0031,546.02ITが群れを離れたか (vs 否)0.27[-2.41,2.68]1.0021,659.16ITとの親密度(CSI)0.43[-0.64,1.56]1.0017,038.10ITが群れを離れたか ×ITとの親密度-0.04[-1.36,1.31]1.0039,624.15前日のオスからの攻撃頻度1.02[0.18,2.24]1.009,003.91前日の群れ外オス数-0.45[-1.69,0.47]1.0015,413.60血縁のメスが群れを離れたか(vs 否)2.43[1.16,3.66]1.0016,993.27順位0.28[-1.19,1.69]1.0016,105.68年齢0.51[-0.70,1.70]1.0018,318.17アカンボウの有無 (vs 無)1.06[-0.16,2.49]1.0033,947.83前日確認したメスの割合0.11[-0.65,1.05]1.0016,555.89調査期間(m20 vs m19)1.89[-0.30,4.77]1.0014,453.89 9.3.1.2.2.2 交互作用項の検討 さらに交互作用項のある変数について検討を行う。 全期間のデータを含むモデル 以下は、TYとのCSIに応じて、TYが群れを離れた日に群れを離れる確率が、そうでない日に比べて有意に高いかを調べたものである。Differenceは、Level1とLevel2のログオッズの差(= ログオッズ比)を示す。0より大きければ、TYが群れを離れなかった日に比べて、TYが群れを離れた日にメスが群れを離れる確率が高かったことを表す。この結果から、おおよそCSIが1.1より大きいメスはTYが群れを離れるのと同じ日に群れを離れる確率が有意に上昇することが示された。 estimate_contrasts(m_female_out_an, contrast = &quot;TY_out = c(1,0)&quot;, at = &quot;CSI_TY_std = seq(-1,2.5, 0.2)&quot;, transform = &quot;none&quot;) %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(female_out_an$CSI_TY)*CSI_TY + mean(female_out_an$CSI_TY)) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) ITについてはこのような傾向はなかった。 estimate_contrasts(m_female_out_an, contrast = &quot;IT_out = c(1,0)&quot;, at = &quot;CSI_IT_std = seq(-1,1, 0.2)&quot;, transform = &quot;response&quot;) %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_an$CSI_IT)*CSI_IT + mean(female_out_an$CSI_IT)) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 2021年のデータを除く含むモデル CSIが高い個体では、TYが群れを離れなかった日に比べて、TYが群れを離れた日にメスが群れを離れる確率が高かった。有意なのはCSIが約1.3よりも大きいとき。 estimate_contrasts(m_female_out_an_no21, contrast = &quot;TY_out = c(1,0)&quot;, at = &quot;CSI_TY_std = seq(-0.67,3.56, 0.2)&quot;, transform = &quot;none&quot;) %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(female_out_an_no21$CSI_TY)*CSI_TY + mean(female_out_an_no21$CSI_TY)) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) ITについては、全期間のデータと同様にこのような傾向はなかった。 estimate_contrasts(m_female_out_an_no21, contrast = &quot;IT_out = c(1,0)&quot;, at = &quot;CSI_IT_std = seq(-0.664,1, 0.2)&quot;, transform = &quot;none&quot;) %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_an_no21$CSI_IT)*CSI_IT + mean(female_out_an_no21$CSI_IT)) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 9.3.1.2.3 結果の図示 9.3.1.2.3.1 TYの群れへの出入り、CSIとの関連 まず、TYとのCSIに応じてオッズ比(TYと同じ日に群れを離れるオッズ/そうでない日に離れるオッズ)の対数をとったものがどのように変わるかを図示する。先ほど示したように、およそCSIが1.3くらいあると同じ日に群れを離れる確率が有意に高くなる。 # cont_female_out_an_TYcsi &lt;- estimate_contrasts(m_female_out_an, # contrast = &quot;TY_out = c(1,0)&quot;, # at = &quot;CSI_TY_std&quot;, # length = 100, # transform = &quot;none&quot;) # # saveRDS(cont_female_out_an_TYcsi, &quot;model/cont_female_out_an_TYcsi.rds&quot;) cont_female_out_an_TYcsi &lt;- readRDS(&quot;model/cont_female_out_an_TYcsi.rds&quot;) cont_female_out_an_TYcsi %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(female_out_an$CSI_TY)*CSI_TY + mean(female_out_an$CSI_TY)) %&gt;% ggplot(aes(x = CSI_TY, y = Difference))+ geom_segment(data = CSI_TY, aes(xend = CSI_TY, y=-1, yend = 0), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.4, arrow = arrow(length = unit(11, &quot;points&quot;))) + geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.2)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;TY&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,0.5))+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1) -&gt; p_female_out_an_TYcsi p_female_out_an_TYcsi # ggsave(&quot;figures/p_female_out_an_TYcsi.png&quot;,p_female_out_an_TYcsi, dpi = 600, units = &quot;mm&quot;, # width = 100, height = 100) 9.3.1.2.3.2 ITの群れへの出入り、CSIとの関連 ITとのCSIに応じてオッズ比(ITと同じ日に群れを離れるオッズ/そうでない日に離れるオッズ)の対数をとったものがどのように変わるかを図示する。こちらは、いずれのCSIでも有意な効果はないよう。 # cont_female_out_an_ITcsi &lt;- estimate_contrasts(m_female_out_an, # contrast = &quot;IT_out = c(1,0)&quot;, # at = &quot;CSI_IT_std&quot;, # length = 100, # transform = &quot;none&quot;) # # saveRDS(cont_female_out_an_ITcsi, &quot;model/cont_female_out_an_ITcsi.rds&quot;) cont_female_out_an_ITcsi &lt;- readRDS(&quot;model/cont_female_out_an_ITcsi.rds&quot;) cont_female_out_an_ITcsi %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_an$CSI_IT)*CSI_IT + mean(female_out_an$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference))+ geom_segment(data = CSI_IT, aes(xend = CSI_IT, y=-1, yend = 0), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.4, arrow = arrow(length = unit(11, &quot;points&quot;))) + geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.2)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,6,1))+ scale_y_continuous(breaks = seq(-6,4,2)) + theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1) -&gt; p_female_out_an_ITcsi p_female_out_an_ITcsi # ggsave(&quot;figures/p_female_out_an_ITcsi.png&quot;,p_female_out_an_ITcsi, dpi = 600, units = &quot;mm&quot;, # width = 100, height = 100) 2021年を除いたモデルでも同様の傾向。 # cont_female_out_an_no21_ITcsi &lt;- estimate_contrasts(m_female_out_an_no21, # contrast = &quot;IT_out = c(1,0)&quot;, # at = &quot;CSI_IT_std&quot;, # length = 100, # transform = &quot;none&quot;) # saveRDS(cont_female_out_an_no21_ITcsi, &quot;model/cont_female_out_an_no21_ITcsi.rds&quot;) cont_female_out_an_no21_ITcsi &lt;- readRDS(&quot;model/cont_female_out_an_no21_ITcsi.rds&quot;) cont_female_out_an_no21_ITcsi %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_an_no21$CSI_IT)*CSI_IT + mean(female_out_an_no21$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference))+ geom_segment(data = CSI_IT, aes(xend = CSI_IT, y=-1, yend = 0), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.4, arrow = arrow(length = unit(11, &quot;points&quot;))) + geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.2)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,6,1))+ scale_y_continuous(breaks = seq(-6,4,2)) + theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1) -&gt; p_female_out_an_no21_ITcsi p_female_out_an_no21_ITcsi # ggsave(&quot;figures/p_female_out_an_no21_ITcsi.png&quot;,p_female_out_an_no21_ITcsi, dpi = 600, units = &quot;mm&quot;, # width = 100, height = 100) 9.3.1.2.3.3 メス同士の血縁度との関連 最後に、血縁のメスが群れを離れたか否かとメスが離れる確率についての結果を図示する。血縁のメスが群れを離れるほど、同じ日に群れを離れる確率が高くなることが分かる。 emm_female_out_an_kin &lt;- estimate_means(m_female_out_an, at = &quot;kin_01 = c(0,1)&quot;) %&gt;% mutate(kin_01 = as.factor(kin_01)) female_out_an %&gt;% mutate(kin_01 = as.factor(kin_01)) %&gt;% group_by(kin_01, femaleID) %&gt;% summarise(prop = mean(female_out)) %&gt;% ungroup() %&gt;% ggplot(aes(x = kin_01, y = prop))+ geom_count(alpha = 0.5)+ geom_line(aes(group = femaleID))+ scale_size(range = c(2,8))+ theme_bw(base_size = 13)+ labs(x = &quot;If kin females left the group&quot;, y = &quot;Probability of female leaving main group&quot;, color = &quot;Study period&quot;, fill = &quot;Study period&quot;)+ coord_cartesian(xlim = c(1.2,1.7), ylim = c(0,1))+ scale_x_discrete(labels = c(&quot;No&quot;, &quot;Yes&quot;)) + theme(axis.title.y = element_text(family = &quot;YArial&quot;, size = 12), axis.title.x = element_text(family = &quot;Arial&quot;, size =12), axis.text = element_text(family = &quot;Arial&quot;, size = 12), legend.title = element_text(family = &quot;Arial&quot;), legend.text = element_text(family = &quot;Arial&quot;), aspect.ratio = 0.9) + geom_signif(xmin = 1, xmax = 2, y_position = 0.95, annotation = &quot;***&quot;, vjust = 0.01, textsize = 5) -&gt; p_female_out_an_kin p_female_out_an_kin # ggsave(&quot;figures/p_female_out_an_kin.png&quot;,p_female_out_an_kin, dpi = 600, units = &quot;mm&quot;, # width = 120, height = 100) p_female_out_an_TYcsi + p_female_out_an_ITcsi + p_female_out_an_kin + plot_layout(ncol = 2) 9.3.1.3 モデリング2 先ほどのモデルではTYとITが群れを離れたか否かにだけ注目したが、TYとITが群れを離れなかったときには、大きく分けて2つのパターンがある。 前日にそもそも群れにいなかった(TY_absent) 前日に群れにいて、翌日も群れで確認された(TY_stay) ここでは、これらの2つも区別したモデルを考える。モデルではTYとITが群れを離れた(TY/IT_out)、TY/IT_absent、TY/IT_stayの3つの水準を持つ変数TY/IT_stateを作成し、先ほどのモデルのTY_outの代わりに入れる。 以下のように変数を作成する。 female_out_an_b &lt;- female_out_an %&gt;% mutate(TY_state = ifelse(TY_pre == 1 &amp; TY_out == 1, &quot;TY_out&quot;, ifelse(TY_pre == 1 &amp; TY_out == 0, &quot;TY_stay&quot;, ifelse(TY_pre == 0, &quot;TY_absent&quot;, NA)))) %&gt;% mutate(TY_state = fct_relevel(TY_state, &quot;TY_stay&quot;, &quot;TY_absent&quot;)) %&gt;% mutate(IT_state = ifelse(IT_pre == 1 &amp; IT_out == 1, &quot;IT_out&quot;, ifelse(IT_pre == 1 &amp; IT_out == 0, &quot;IT_stay&quot;, ifelse(IT_pre == 0, &quot;IT_absent&quot;, NA)))) %&gt;% mutate(IT_state = fct_relevel(IT_state, &quot;IT_stay&quot;, &quot;IT_absent&quot;)) モデル式と説明変数の説明は以下の通り。なお、\\(i, j, k\\)はそれぞれデータ番号、日付番号、メスIDの番号を表す。なお、連続変数は全て標準化している。 \\(TY\\_state(TY\\_stay, TY\\_absent, TY\\_out)/IT\\_state(IT\\_stay, IT\\_absent, IT\\_out))\\): TY/ITの動向 \\(CSI\\_TY/CSI\\_IT\\): 各メスとTY/ITとの親密度 \\(rate\\_agg\\_all\\): 前日の群れ内のオスの攻撃頻度 \\(no_ntm\\): 前日の群れ外オス数 \\(infant\\): アカンボウの有無 \\(age\\): 年齢 \\(rank\\): 0から1にスケール化された順位 \\(kin\\_01\\): 同じ日に群れを離れたメスがいたか否か \\(study\\_period(m19,m20,m21)\\): 調査期間 \\[ \\begin{aligned} female\\_out_i &amp;\\sim Bernoulli(p_i) \\\\ logit(p_i) = &amp;\\beta_0 + \\beta_1 \\times TY\\_out_i + \\beta_2 \\times TY\\_absent_i + \\beta_3 \\times CSI\\_TY_i + \\beta_4 \\times TY\\_out_i \\times CSI\\_TY_i + \\beta_5 \\times TY\\_absent_i \\times CSI\\_TY_i +\\\\ &amp;\\beta_6 \\times IT\\_out_i + \\beta_7 \\times IT\\_absent_i + \\beta_8 \\times CSI\\_IT_i + \\beta_9 \\times IT\\_out_i \\times CSI\\_IT_i + \\beta_{10} \\times IT\\_absent_i \\times CSI\\_IT_i \\\\ &amp;\\beta_{11} \\times age_i + \\beta_{12} \\times rank_i + \\beta_{13} \\times rate\\_agg\\_all_i + \\beta_{14} \\times no\\_ntm_i + \\beta_{14} \\times infant_i + \\beta_{15} \\times kin\\_01 + \\\\ &amp;\\beta_{16} \\times m20_i + \\beta_{17} \\times m21_i + r_j + \\gamma_k\\\\ r_j &amp;\\sim Normal(0, \\sigma_r)\\\\ \\gamma_k &amp;\\sim Normal(0, \\sigma_{\\gamma})\\\\ \\beta_0 &amp;\\sim student\\_t(4,0,20)\\\\ \\beta_{1,2,\\dots,12} &amp;\\sim student_t(0,4,10)\\\\ \\sigma_{r, \\gamma} &amp;\\sim student_t(0,4,10)\\\\ \\end{aligned} \\] モデルは以下のように実行する。 ## オスの攻撃との交互作用なし m_female_out_an_TYstate &lt;- brm(data = female_out_an_b %&gt;% mutate(date = as.factor(date)), female_out ~ rate_agg_all_std + TY_state*CSI_TY_std + IT_state*CSI_IT_std + ntm_std + prop_std + infant_pre + age_std + rank_std + kin_01 + study_period + (1|femaleID) + (1|date), family = &quot;bernoulli&quot;, prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd, lb = 0)), iter = 11000, warmup = 1000, seed = 223, control=list(adapt_delta = 0.999, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_out_an_TYstate&quot;) # 2021年を除外 female_out_an_b %&gt;% filter(study_period != &quot;m21&quot;) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), rank_std = standardize(rank_scaled), age_std = standardize(age), kin_std = standardize(max_kin), ntm_std = standardize(no_ntm), prop_std = standardize(prop_female), rate_agg_all_std = standardize(rate_agg_all_pre)) -&gt; female_out_an_b_no21 ## TY_stateとCSI_TY_stdのVIFが10以上だったので交互作用を除く m_female_out_an_TYstate_no21 &lt;- brm(data = female_out_an_b_no21 %&gt;% mutate(date = as.factor(date)), female_out ~ rate_agg_all_std + TY_state + CSI_TY_std + IT_state*CSI_IT_std + ntm_std + prop_std + infant_pre + age_std + rank_std + + kin_01 + study_period + (1|femaleID) + (1|date), family = &quot;bernoulli&quot;, prior = c(prior(student_t(4,0,20),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,10), class = sd)), iter = 11000, warmup = 1000, seed = 223, control=list(adapt_delta = 0.999, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_out_an_TYstate_no21&quot;) 9.3.1.3.1 モデルチェック まず、DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。いずれのモデルでも特に問題はないよう。 ## 全期間 dh_female_out_an_TYstate &lt;- dh_check_brms(m_female_out_an_TYstate, quantreg = T) ## 2021年を除く dh_female_out_an_TYstate_no21 &lt;- dh_check_brms(m_female_out_an_TYstate_no21, quantreg = T) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## 全期間 pp_check(m_female_out_an_TYstate, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) ## 2021年を除く pp_check(m_female_out_an_TYstate_no21, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) 多重共線性のチェックも行ったが、VIFに問題はない。 ## 全期間 check_collinearity(m_female_out_an_TYstate) ## 2021年を除く check_collinearity(m_female_out_an_TYstate_no21) Rhatにも問題はなく、収束の問題はないよう。 data.frame(Rhat = brms::rhat(m_female_out_an_TYstate)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) data.frame(Rhat = brms::rhat(m_female_out_an_TYstate_no21)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 最後に残差の時系列相関のチェックを行う。 まず全期間のデータを用いたモデルでは、残差の自己相関をプロットすると明確なパターンは見られなかった。また、Ljung-Box検定で5時点前までの残差との自己相関を検定したところ、有意な自己相関を示した個体はMifとTenだけだった。 res_female_out_an_TYstate &lt;- female_out_an_b %&gt;% mutate(resid = dh_female_out_an_TYstate$scaledResiduals) %&gt;% mutate(date = as_date(date)) %&gt;% group_by(femaleID) %&gt;% complete(date = seq.Date(min(date), max(date), by = &quot;1 day&quot;)) %&gt;% ungroup() females &lt;- unique(female_out_an_b$femaleID) acf_female_out_an_TYstate &lt;- NULL for(i in seq_along(females)){ data &lt;- res_female_out_an_TYstate %&gt;% filter(femaleID == females[i]) out.acf &lt;- acf(data$resid, lag.max = 5, na.action = na.pass, plot = F) box_test &lt;- Box.test(data$resid, type = &quot;Ljung-Box&quot;, lag = 5) out.df &lt;- data.frame(Timelag = out.acf$lag, Acf = out.acf$acf, femaleID = females[i], p = box_test$p.value) acf_female_out_an_TYstate &lt;- bind_rows(acf_female_out_an_TYstate, out.df) } acf_female_out_an_TYstate %&gt;% mutate(p = str_c(&quot;p = &quot;,round(p,2))) %&gt;% ggplot(aes(x = Timelag, y = 0))+ geom_segment(aes(xend = Timelag, yend = Acf))+ geom_text(aes(x = 4, y = 0.8, label = p), size = 3.5, family = &quot;Arial&quot;)+ theme_bw()+ theme(aspect.ratio = 1)+ facet_rep_wrap(~femaleID, repeat.tick.labels = TRUE) 2021年のデータを除いたモデルでは、AkaとHotのみで自己相関が有意になった。 res_female_out_an_TYstate_no21 &lt;- female_out_an_b_no21 %&gt;% mutate(resid = dh_female_out_an_TYstate_no21$scaledResiduals) %&gt;% mutate(date = as_date(date)) %&gt;% group_by(femaleID) %&gt;% complete(date = seq.Date(min(date), max(date), by = &quot;1 day&quot;)) %&gt;% ungroup() females &lt;- unique(female_out_an_b_no21$femaleID) acf_female_out_an_TYstate_no21 &lt;- NULL for(i in seq_along(females)){ data &lt;- res_female_out_an_TYstate_no21 %&gt;% filter(femaleID == females[i]) out.acf &lt;- acf(data$resid, lag.max = 5, na.action = na.pass, plot = F) box_test &lt;- Box.test(data$resid, type = &quot;Ljung-Box&quot;, lag = 5) out.df &lt;- data.frame(Timelag = out.acf$lag, Acf = out.acf$acf, femaleID = females[i], p = box_test$p.value) acf_female_out_an_TYstate_no21 &lt;- bind_rows(acf_female_out_an_TYstate_no21, out.df) } acf_female_out_an_TYstate_no21 %&gt;% mutate(p = str_c(&quot;p = &quot;,round(p,2))) %&gt;% ggplot(aes(x = Timelag, y = 0))+ geom_segment(aes(xend = Timelag, yend = Acf))+ geom_text(aes(x = 4, y = 0.8, label = p), size = 3.5, family = &quot;Arial&quot;)+ theme_bw()+ theme(aspect.ratio = 1)+ facet_rep_wrap(~femaleID, repeat.tick.labels = TRUE) 9.3.1.3.2 結果の確認 9.3.1.3.2.1 推定された係数 結果は以下の通り。まずは全期間を含むデータについて確認する。 .cl-d7605844{table-layout:auto;width:100%;}.cl-d75666b8{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d75666c2{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d75666cc{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d75666d6{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d75a7730{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d75a773a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d75a9094{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a909e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a909f{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90a0{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90a8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90a9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90b2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90b3{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90bc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90bd{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90c6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90d0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90d1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90da{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90e4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90e5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90e6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90ee{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90ef{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90f0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90f8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a90f9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9102{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a910c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9116{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9117{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9120{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9121{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a912a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9134{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9135{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9136{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a913e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a913f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9140{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9148{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9149{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9152{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9153{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a915c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a915d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a915e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9166{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9170{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d75a9171{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-10.23[-14.28,-7.45]1.009,035.60TY(absent vs stay)1.49[0.17,3.14]1.0015,787.22TY(leave vs stay)2.63[0.80,5.02]1.0013,770.60TYとの親密度(CSI)-1.13[-3.02,0.49]1.0016,423.99TY(absent vs stay) ×TYとの親密度0.20[-1.00,1.67]1.0022,643.90TY(leave vs stay) ×TYとの親密度1.74[0.42,3.36]1.0021,258.03IT(absent vs stay)2.16[0.55,4.25]1.0018,643.72IT(leave vs stay)1.77[-0.88,4.44]1.0023,299.24ITとの親密度(CSI)-0.03[-1.26,1.09]1.0020,271.31IT(absent vs stay) ×ITとの親密度0.42[-0.29,1.30]1.0030,978.91IT(leave vs stay) ×ITとの親密度0.26[-1.11,1.77]1.0039,836.80前日のオスからの攻撃頻度0.10[-0.51,0.75]1.0019,723.68前日の群れ外オス数0.08[-0.69,0.79]1.0027,408.13血縁のメスが群れを離れたか(vs 否)2.21[1.23,3.13]1.0022,657.55順位0.15[-1.12,1.34]1.0016,941.03年齢0.64[-0.39,1.68]1.0018,657.42アカンボウの有無 (vs 無)1.10[-0.05,2.33]1.0039,652.37前日確認したメスの割合0.08[-0.50,0.77]1.0023,540.78調査期間(m20 vs m19)1.33[-0.52,3.55]1.0016,374.99調査期間(m21 vs m19)0.43[-1.58,2.66]1.0016,806.66 続いて、2021年を除いたモデルの結果を確認する。結果はほとんど変わらず。 .cl-dd01f7bc{table-layout:auto;width:100%;}.cl-dcf8c192{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dcf8c19c{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dcf8c1a6{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dcf8c1a7{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dcfc4db2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dcfc4dbc{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dcfc6ef0{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6efa{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6efb{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f04{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f05{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f0e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f0f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f10{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f18{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f19{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f22{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f2c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f2d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f2e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f36{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f37{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f38{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f40{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f41{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f4a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f4b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f4c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f4d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f54{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f55{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f56{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f57{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f5e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f5f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f60{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f68{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f69{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f72{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f73{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f7c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f7d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f7e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f7f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f80{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f86{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f87{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f90{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f91{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f92{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfc6f9a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-11.66[-17.45,-8.05]1.006,839.07TY(absent vs stay)2.20[0.30,4.72]1.0012,920.08TY(leave vs stay)3.76[1.43,7.19]1.0010,107.65TYとの親密度(CSI)-0.07[-1.56,1.48]1.0016,131.89IT(absent vs stay)2.39[0.70,4.63]1.0015,850.68IT(leave vs stay)1.84[-0.88,4.64]1.0019,768.02ITとの親密度(CSI)0.01[-1.33,1.26]1.0017,894.78IT(absent vs stay) ×ITとの親密度0.73[-0.06,1.73]1.0022,367.31IT(leave vs stay) ×ITとの親密度0.46[-0.87,1.97]1.0034,516.51前日のオスからの攻撃頻度0.80[-0.04,2.00]1.008,923.69前日の群れ外オス数-0.40[-1.59,0.48]1.0015,388.89血縁のメスが群れを離れたか(vs 否)2.12[0.88,3.28]1.0015,694.48順位0.26[-1.20,1.69]1.0015,706.64年齢0.45[-0.80,1.63]1.0017,088.90アカンボウの有無 (vs 無)0.84[-0.40,2.26]1.0039,966.77前日確認したメスの割合0.63[-0.18,1.81]1.0010,724.66調査期間(m20 vs m19)1.99[-0.21,5.02]1.0011,962.57 9.3.1.3.2.2 交互作用項の推定 さらに交互作用項のある変数について検討を行う。 全期間を含むモデル 以下は、TY/ITとのCSIの値によって、TY/IT_stateの各水準のときにおいてメスが群れを離れる確率がどのように違うかを調べたものである。Differenceはログオッズの差を表している。 cont_female_out_an_TYstate &lt;- estimate_contrasts( m_female_out_an_TYstate, contrast = &quot;TY_state = c(&#39;TY_out&#39;,&#39;TY_absent&#39;,&#39;TY_stay&#39;)&quot;, at = &quot;CSI_TY_std = seq(-1,2.5, 0.2)&quot;, transform = &quot;none&quot;) %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(female_out_an_b$CSI_TY)*CSI_TY + mean(female_out_an_b$CSI_TY)) TYが群れにいなかったときは、TYが群れにとどまったときよりメスが群れを離れる確率がおおむね高い。ただし、TYとのCSIが高いときと低いときには95%確信区間が0をまたいでしまっている。これは、CSIが低いところと高いところはデータ数が少ないからだと思われる。 ### absent vs stay cont_female_out_an_TYstate %&gt;% data.frame() %&gt;% filter(Level1 == &quot;TY_absent&quot;, Level2 == &quot;TY_stay&quot;) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 続いて、TYが群れを離れたときは、TYが群れにとどまったときより、CSIがおよそ0.6より高ければメスが群れを離れる確率が有意に高い。 ### out vs stay cont_female_out_an_TYstate %&gt;% data.frame() %&gt;% filter(Level1 == &quot;TY_out&quot;, Level2 == &quot;TY_stay&quot;) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 最後に、TYが群れを離れたときは、TYが群れにとどまったときより、CSIがおよそ1.4より高ければメスが群れを離れる確率が有意に高い。 ### out vs absent cont_female_out_an_TYstate %&gt;% data.frame() %&gt;% filter(Level1 == &quot;TY_out&quot;, Level2 == &quot;TY_absent&quot;) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 続いて、ITについても調べる。 cont_female_out_an_ITstate &lt;- estimate_contrasts( m_female_out_an_TYstate, contrast = &quot;IT_state = c(&#39;IT_out&#39;,&#39;IT_absent&#39;,&#39;IT_stay&#39;)&quot;, at = &quot;CSI_IT_std = seq(-0.67,3.56, 0.2)&quot;, transform = &quot;none&quot;) %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_an_b$CSI_IT)*CSI_IT + mean(female_out_an_b$CSI_IT)) ITが群れにいなかったときは、ITが群れにとどまったときよりメスが群れを離れる確率がおおむね高い。 ### absent vs stay cont_female_out_an_ITstate %&gt;% data.frame() %&gt;% filter(Level1 == &quot;IT_absent&quot;, Level2 == &quot;IT_stay&quot;) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 続いて、ITが群れを離れたときとITが群れにいないときは、メスが群れを離れる確率に違いはなかった。 ### out vs stay cont_female_out_an_ITstate %&gt;% data.frame() %&gt;% filter(Level1 == &quot;IT_out&quot;, Level2 == &quot;IT_stay&quot;) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 最後に、ITが群れを離れたときとITが群れにとどまったときは、メスが群れを離れる確率に違いはなかった。 ### out vs stay cont_female_out_an_ITstate %&gt;% data.frame() %&gt;% filter(Level1 == &quot;IT_out&quot;, Level2 == &quot;IT_stay&quot;) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 2021年を除くモデル 続いて、2021年を除く結果について調べる。 cont_female_out_an_ITstate_no21 &lt;- estimate_contrasts( m_female_out_an_TYstate_no21, contrast = &quot;IT_state = c(&#39;IT_out&#39;,&#39;IT_absent&#39;,&#39;IT_stay&#39;)&quot;, at = &quot;CSI_IT_std = seq(-0.66,3.59, 0.2)&quot;, transform = &quot;none&quot;) %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_an_b_no21$CSI_IT)*CSI_IT + mean(female_out_an_b_no21$CSI_IT)) CSIにかからわず、ITが群れにいなかったときは、ITが群れにとどまったときよりメスが群れを離れる確率が高い。 ### absent vs stay cont_female_out_an_ITstate_no21 %&gt;% data.frame() %&gt;% filter(Level1 == &quot;IT_absent&quot;, Level2 == &quot;IT_stay&quot;) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 続いて、ITが群れを離れたときとITが群れにいないときは、メスが群れを離れる確率に違いはなかった。 ### out vs stay cont_female_out_an_ITstate_no21 %&gt;% data.frame() %&gt;% filter(Level1 == &quot;IT_out&quot;, Level2 == &quot;IT_stay&quot;) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 最後に、ITが群れを離れたときとITが群れにとどまったときは、メスが群れを離れる確率に違いはなかった。 ### out vs stay cont_female_out_an_ITstate_no21 %&gt;% data.frame() %&gt;% filter(Level1 == &quot;IT_out&quot;, Level2 == &quot;IT_stay&quot;) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 9.3.1.3.3 結果の図示 9.3.1.3.3.1 TYの動向・ CSIとメスが群れを出る確率の関連 まずは、estimate_contrasts関数を用いて、TYとのCSIに応じてオッズ比の対数をとったものがどのように変わるかを図示する。 # cont_female_out_an_TYstate_b &lt;- estimate_contrasts(m_female_out_an_TYstate, # contrast = # &quot;TY_state = c(&#39;TY_out&#39;,&#39;TY_absent&#39;,&#39;TY_stay&#39;)&quot;, # at = &quot;CSI_TY_std&quot;, # length = 70) # # saveRDS(cont_female_out_an_TYstate_b, &quot;model/cont_female_out_an_TYstate_b.rds&quot;) cont_female_out_an_TYstate_b &lt;- readRDS(&quot;model/cont_female_out_an_TYstate_b.rds&quot;) cont_female_out_an_TYstate_b %&gt;% data.frame() %&gt;% mutate(type = str_c(Level1, &quot; vs &quot;, Level2)) %&gt;% mutate(type = str_replace_all(type, &quot;TY_&quot;, &quot;&quot;)) %&gt;% mutate(type = str_replace_all(type, &quot;out&quot;, &quot;leave&quot;)) %&gt;% mutate(type = fct_relevel(type, &quot;absent vs stay&quot;, &quot;leave vs stay&quot;, &quot;leave vs absent&quot;)) %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(female_out_an$CSI_TY)*CSI_TY + mean(female_out_an$CSI_TY)) %&gt;% ggplot(aes(x = CSI_TY, y = Difference)) + geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 0.7)+ geom_segment(data = CSI_TY %&gt;% expand(data.frame(type = c(&quot;absent vs stay&quot;, &quot;leave vs absent&quot;, &quot;leave vs stay&quot;)) %&gt;% mutate(type = fct_relevel(type, &quot;absent vs stay&quot;, &quot;leave vs stay&quot;, &quot;leave vs absent&quot;)), nesting(subject, CSI_TY)) %&gt;% mutate(y = c(rep(-0.8,18), rep(-1.35, 18), rep(-1,18))), aes(xend = CSI_TY, y= y, yend = -0.02), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.4, arrow = arrow(length = unit(9, &quot;points&quot;))) + geom_line(aes(group = type))+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high, group = type), alpha = 0.2)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;TY&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,0.5))+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(hjust = 0))+ scale_y_continuous(breaks = seq(-6,12,2))+ facet_rep_wrap(~type, repeat.tick.labels = TRUE, scales = &quot;free_y&quot;) -&gt; p_female_out_an_TYstate_csi p_female_out_an_TYstate_csi # ggsave(&quot;figures/p_female_out_an_TYstate_csi.png&quot;, # p_female_out_an_TYstate_csi, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 100) # ggsave(&quot;figures/p_female_out_an_TYstate_csi_noarrow.png&quot;, # p_female_out_an_TYstate_csi, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 100) 9.3.1.3.3.2 ITの動向・ CSIとメスが群れを出る確率の関連 続いて、estimate_contrasts関数を用いて、ITとのCSIに応じてオッズ比の対数をとったものがどのように変わるかを図示する。 # cont_female_out_an_ITstate_b &lt;- estimate_contrasts( # m_female_out_an_TYstate, # contrast = &quot;IT_state = c(&#39;IT_out&#39;,&#39;IT_absent&#39;,&#39;IT_stay&#39;)&quot;, # at = &quot;CSI_IT_std&quot;, # length = 70) # # saveRDS(cont_female_out_an_ITstate_b, &quot;model/cont_female_out_an_ITstate_b.rds&quot;) cont_female_out_an_ITstate_b &lt;- readRDS(&quot;model/cont_female_out_an_ITstate_b.rds&quot;) cont_female_out_an_ITstate_b %&gt;% data.frame() %&gt;% mutate(type = str_c(Level1, &quot; vs &quot;, Level2)) %&gt;% mutate(type = str_replace_all(type, &quot;IT_&quot;, &quot;&quot;)) %&gt;% mutate(type = str_replace_all(type, &quot;out&quot;, &quot;leave&quot;)) %&gt;% mutate(type = fct_relevel(type, &quot;absent vs stay&quot;, &quot;leave vs stay&quot;, &quot;leave vs absent&quot;)) %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_an$CSI_IT)*CSI_IT + mean(female_out_an$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference)) + geom_segment(data = CSI_IT %&gt;% expand(data.frame(type = c(&quot;absent vs stay&quot;, &quot;leave vs absent&quot;, &quot;leave vs stay&quot;)) %&gt;% mutate(type = fct_relevel(type, &quot;absent vs stay&quot;, &quot;leave vs stay&quot;, &quot;leave vs absent&quot;)), nesting(subject, CSI_IT)) %&gt;% mutate(y = c(rep(-0.8,18), rep(-1, 18), rep(-1,18))), aes(xend = CSI_IT, y= y, yend = -0.02), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.4, arrow = arrow(length = unit(9, &quot;points&quot;))) + geom_line(aes(group = type))+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high, group = type), alpha = 0.2)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,7,1))+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(hjust = 0))+ scale_y_continuous(breaks = seq(-6,12,2))+ facet_rep_wrap(~type, repeat.tick.labels = TRUE, scales = &quot;free_y&quot;) -&gt; p_female_out_an_ITstate_csi p_female_out_an_ITstate_csi # ggsave(&quot;figures/p_female_out_an_ITstate_csi.png&quot;, # p_female_out_an_ITstate_csi, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 100) # ggsave(&quot;figures/p_female_out_an_ITstate_csi_noarrow.png&quot;, # p_female_out_an_ITstate_csi, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 100) 2021年を除いたモデルについて図示すると以下のようになる。 # cont_female_out_an_ITstate_no21_b &lt;- estimate_contrasts( # m_female_out_an_TYstate_no21, # contrast = &quot;IT_state = c(&#39;IT_out&#39;,&#39;IT_absent&#39;,&#39;IT_stay&#39;)&quot;, # at = &quot;CSI_IT_std&quot;, # length = 70) # saveRDS(cont_female_out_an_ITstate_no21_b, &quot;model/cont_female_out_an_ITstate_no21_b.rds&quot;) cont_female_out_an_ITstate_no21_b &lt;- readRDS(&quot;model/cont_female_out_an_ITstate_no21_b.rds&quot;) cont_female_out_an_ITstate_no21_b %&gt;% data.frame() %&gt;% mutate(type = str_c(Level1, &quot; vs &quot;, Level2)) %&gt;% mutate(type = str_replace_all(type, &quot;IT_&quot;, &quot;&quot;)) %&gt;% mutate(type = str_replace_all(type, &quot;out&quot;, &quot;leave&quot;)) %&gt;% mutate(type = fct_relevel(type, &quot;absent vs stay&quot;, &quot;leave vs stay&quot;, &quot;leave vs absent&quot;)) %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_an_b_no21$CSI_IT)*CSI_IT + mean(female_out_an_b_no21$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference)) + geom_segment(data = CSI_IT %&gt;% expand(data.frame(type = c(&quot;absent vs stay&quot;, &quot;leave vs absent&quot;, &quot;leave vs stay&quot;)) %&gt;% mutate(type = fct_relevel(type, &quot;absent vs stay&quot;, &quot;leave vs stay&quot;, &quot;leave vs absent&quot;)), nesting(subject, CSI_IT)) %&gt;% mutate(y = c(rep(-0.8,18), rep(-1, 18), rep(-1,18))), aes(xend = CSI_IT, y= y, yend = -0.02), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.4, arrow = arrow(length = unit(9, &quot;points&quot;))) + geom_line(aes(group = type))+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high, group = type), alpha = 0.2)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,7,1))+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(hjust = 0))+ scale_y_continuous(breaks = seq(-6,12,2))+ facet_rep_wrap(~type, repeat.tick.labels = TRUE, scales = &quot;free_y&quot;) -&gt; p_female_out_an_no21_ITstate_csi p_female_out_an_no21_ITstate_csi # ggsave(&quot;figures/p_female_out_an_no21_ITstate_csi.png&quot;, # p_female_out_an_no21_ITstate_csi, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 100) # # ggsave(&quot;figures/p_female_out_an_no21_ITstate_csi_noarrow.png&quot;, # p_female_out_an_no21_ITstate_csi, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 100) 9.3.1.4 モデリング3 先ほどのモデルではTYとITがTYとITが前日群れにいなかったとき、翌日に彼らが戻ったか否かにかかわらずabsentに分類していた。以下では、これを更に2つに分類する。 前日に群れにおらず、翌日もいない(TY_absent) 前日に群れにおらず、翌日に群れで確認された(TY_return) 以下のように変数を作成する。 female_out_an_c &lt;- female_out_an_b %&gt;% mutate(date = as_date(date)) %&gt;% left_join(TYIT_presence_over0.5, by = c(&quot;date&quot;,&quot;groupID&quot;,&quot;study_period&quot;)) %&gt;% replace_na(list(IT = 0)) %&gt;% mutate(TY_state4 = ifelse(TY_pre == 1 &amp; TY == 1, &quot;TY_stay&quot;, ifelse(TY_pre == 1 &amp; TY == 0, &quot;TY_out&quot;, ifelse(TY_pre == 0 &amp; TY == 1, &quot;TY_return&quot;, ifelse(TY_pre == 0 &amp; TY == 0, &quot;TY_absent&quot;, NA))))) %&gt;% mutate(TY_state4 = fct_relevel(TY_state4, &quot;TY_stay&quot;, &quot;TY_absent&quot;,&quot;TY_return&quot;)) %&gt;% mutate(IT_state4 = ifelse(IT_pre == 1 &amp; IT == 1, &quot;IT_stay&quot;, ifelse(IT_pre == 1 &amp; IT == 0, &quot;IT_out&quot;, ifelse(IT_pre == 0 &amp; IT == 0, &quot;IT_absent&quot;, ifelse(IT_pre == 0 &amp; IT == 1, &quot;IT_return&quot;, NA))))) %&gt;% mutate(IT_state4 = fct_relevel(IT_state4, &quot;IT_stay&quot;, &quot;IT_absent&quot;,&quot;IT_return&quot;)) モデルは以下のように実行する。 ## オスの攻撃との交互作用なし m_female_out_an_TY4cat &lt;- brm(data = female_out_an_c %&gt;% mutate(date = as.factor(date)), female_out ~ rate_agg_all_std + TY_state4*CSI_TY_std + IT_state4*CSI_IT_std + ntm_std + prop_std + infant_pre + age_std + rank_std + kin_01 + study_period + (1|femaleID) + (1|date), family = &quot;bernoulli&quot;, prior = c(prior(student_t(4,0,20),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,10), class = sd)), iter = 11000, warmup = 1000, seed = 223, control=list(adapt_delta = 0.999, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_out_an_TY4cat&quot;) # 2021年を除外 female_out_an_c %&gt;% filter(study_period != &quot;m21&quot;) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), rank_std = standardize(rank_scaled), age_std = standardize(age), kin_std = standardize(max_kin), ntm_std = standardize(no_ntm), prop_std = standardize(prop_female), rate_agg_all_std = standardize(rate_agg_all_pre)) -&gt; female_out_an_c_no21 ## TYstate4とCSI_TY_stdのVIFが高いので交互作用は除く m_female_out_an_TY4cat_no21 &lt;- brm(data = female_out_an_c_no21 %&gt;% mutate(date = as.factor(date)), female_out ~ rate_agg_all_std + TY_state4 + CSI_TY_std + IT_state4*CSI_IT_std + ntm_std + prop_std + infant_pre + age_std + rank_std + kin_01 + study_period + (1|femaleID) + (1|date), family = &quot;bernoulli&quot;, prior = c(prior(student_t(4,0,20),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,10), class = sd)), iter = 11000, warmup = 1000, seed = 223, control=list(adapt_delta = 0.999, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_out_an_TY4cat_no21&quot;) 9.3.1.4.1 モデルチェック まず、DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。特に問題はないよう。 ## 全期間を含む dh_female_out_an_TY4cat &lt;- dh_check_brms(m_female_out_an_TY4cat, quantreg = T) ## 2021年を除く dh_female_out_an_TY4cat_no21 &lt;- dh_check_brms(m_female_out_an_TY4cat_no21, quantreg = T) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## 全期間を含む pp_check(m_female_out_an_TY4cat, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) ## 2021年を除く pp_check(m_female_out_an_TY4cat_no21, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) 多重共線性のチェックもお個あったが、VIFに大きな問題はない。 ## 全期間を含む check_collinearity(m_female_out_an_TY4cat) ## 2021年を除く check_collinearity(m_female_out_an_TY4cat_no21) Rhatにも問題はなく、収束の問題はないよう。 ## 全期間 data.frame(Rhat = brms::rhat(m_female_out_an_TY4cat)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) ## 2021年を除く data.frame(Rhat = brms::rhat(m_female_out_an_TY4cat_no21)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 最後に残差の時系列相関のチェックを行う。 全期間を含むモデルについて残差の自己相関をプロットすると、明確なパターンは見られなかった。また、Ljung-Box検定で5時点前までの残差との自己相関を検定したところ、有意な自己相関を示した個体はMifとTenのみだった。 res_female_out_an_TY4cat &lt;- female_out_an_c %&gt;% mutate(resid = dh_female_out_an_TY4cat$scaledResiduals) %&gt;% mutate(date = as_date(date)) %&gt;% group_by(femaleID) %&gt;% complete(date = seq.Date(min(date), max(date), by = &quot;1 day&quot;)) %&gt;% ungroup() females &lt;- unique(female_out_an_c$femaleID) acf_female_out_an_TY4cat &lt;- NULL for(i in seq_along(females)){ data &lt;- res_female_out_an_TY4cat %&gt;% filter(femaleID == females[i]) out.acf &lt;- acf(data$resid, lag.max = 5, na.action = na.pass, plot = F) box_test &lt;- Box.test(data$resid, type = &quot;Ljung-Box&quot;, lag = 5) out.df &lt;- data.frame(Timelag = out.acf$lag, Acf = out.acf$acf, femaleID = females[i], p = box_test$p.value) acf_female_out_an_TY4cat &lt;- bind_rows(acf_female_out_an_TY4cat, out.df) } acf_female_out_an_TY4cat %&gt;% mutate(p = str_c(&quot;p = &quot;,round(p,2))) %&gt;% ggplot(aes(x = Timelag, y = 0))+ geom_segment(aes(xend = Timelag, yend = Acf))+ geom_text(aes(x = 4, y = 0.8, label = p), size = 3.5, family = &quot;Arial&quot;)+ theme_bw()+ theme(aspect.ratio = 1)+ facet_rep_wrap(~femaleID, repeat.tick.labels = TRUE) 2021年を除くモデルについては、有意な自己相関はAkaとHotのみで見られた。 res_female_out_an_TY4cat_no21 &lt;- female_out_an_c_no21 %&gt;% mutate(resid = dh_female_out_an_TY4cat_no21$scaledResiduals) %&gt;% mutate(date = as_date(date)) %&gt;% group_by(femaleID) %&gt;% complete(date = seq.Date(min(date), max(date), by = &quot;1 day&quot;)) %&gt;% ungroup() females &lt;- unique(female_out_an_c_no21$femaleID) acf_female_out_an_TY4cat_no21 &lt;- NULL for(i in seq_along(females)){ data &lt;- res_female_out_an_TY4cat_no21 %&gt;% filter(femaleID == females[i]) out.acf &lt;- acf(data$resid, lag.max = 5, na.action = na.pass, plot = F) box_test &lt;- Box.test(data$resid, type = &quot;Ljung-Box&quot;, lag = 5) out.df &lt;- data.frame(Timelag = out.acf$lag, Acf = out.acf$acf, femaleID = females[i], p = box_test$p.value) acf_female_out_an_TY4cat_no21 &lt;- bind_rows(acf_female_out_an_TY4cat_no21, out.df) } acf_female_out_an_TY4cat_no21 %&gt;% mutate(p = str_c(&quot;p = &quot;,round(p,2))) %&gt;% ggplot(aes(x = Timelag, y = 0))+ geom_segment(aes(xend = Timelag, yend = Acf))+ geom_text(aes(x = 4, y = 0.8, label = p), size = 3.5, family = &quot;Arial&quot;)+ theme_bw()+ theme(aspect.ratio = 1)+ facet_rep_wrap(~femaleID, repeat.tick.labels = TRUE) 9.3.1.4.1.1 推定された係数 結果は以下の通り。まずは全期間を含むデータについて確認する。 .cl-8cb8ddec{table-layout:auto;width:100%;}.cl-8cae98e6{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8cae98fa{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8cae98fb{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8cae9904{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8cb2c7ae{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8cb2c7b8{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8cb2eb62{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb76{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb77{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb78{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb80{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb81{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb82{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb8a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb8b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb94{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb95{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb96{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb97{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb9e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eb9f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eba8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2eba9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebaa{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebab{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebb2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebb3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebbc{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebbd{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebc6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebc7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebc8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebd0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebd1{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebd2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebd3{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebda{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebdb{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebdc{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebe4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebe5{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebe6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebe7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebee{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebef{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebf0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebf8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ebf9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ec02{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ec03{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb2ec04{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-10.78[-15.39,-7.73]1.008,273.72TY(absent vs stay)1.61[0.14,3.47]1.0015,088.11TY(return vs stay)-0.07[-4.57,3.30]1.0022,192.81TY(leave vs stay)2.87[0.86,5.57]1.0012,531.26TYとの親密度(CSI)-1.23[-3.19,0.44]1.0016,895.57TY(absent vs stay) ×TYとの親密度0.33[-0.92,1.85]1.0023,758.42TY(return vs stay) ×TYとの親密度-2.33[-8.22,1.41]1.0025,927.48TY(leave vs stay) ×TYとの親密度1.84[0.48,3.51]1.0021,388.46IT(absent vs stay)2.25[0.48,4.57]1.0015,935.40IT(return vs stay)2.80[-0.16,6.08]1.0019,469.48IT(leave vs stay)1.85[-1.06,4.80]1.0021,381.19ITとの親密度(CSI)-0.10[-1.37,1.05]1.0019,757.66IT(absent vs stay) ×ITとの親密度0.46[-0.26,1.38]1.0025,205.00IT(return vs stay) ×ITとの親密度0.60[-1.06,2.13]1.0026,235.30IT(leave vs stay) ×ITとの親密度0.37[-1.04,1.90]1.0031,466.96前日のオスからの攻撃頻度0.14[-0.50,0.84]1.0017,277.14前日の群れ外オス数0.04[-0.80,0.83]1.0022,846.00血縁のメスが群れを離れたか(vs 否)2.14[1.14,3.09]1.0020,716.57順位0.15[-1.17,1.37]1.0016,410.93年齢0.67[-0.40,1.77]1.0019,048.21アカンボウの有無 (vs 無)1.12[-0.07,2.38]1.0038,940.28前日確認したメスの割合0.12[-0.52,0.90]1.0018,307.52調査期間(m20 vs m19)1.40[-0.55,3.87]1.0016,395.83調査期間(m21 vs m19)0.57[-1.59,3.00]1.0016,836.07 ## [1] &quot;tables/table_female_out_an_TY4cat.tiff&quot; 続いて、2021年を除いたモデルの結果を確認する。ITに関する推定結果にわずかな違いがあるよう。ITが群れに戻った時にもメスが群れを離れる確率が有意に増加するよう。 .cl-934c98d8{table-layout:auto;width:100%;}.cl-93439670{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-93439684{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-93439685{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9343968e{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-93475472{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9347547c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-934773bc{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-934773c6{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-934773d0{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-934773d1{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-934773d2{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-934773e4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-934773e5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-934773e6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-934773ee{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-934773ef{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-934773f8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-934773f9{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477402{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477403{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477404{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9347740c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9347740d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9347740e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9347740f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477416{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477417{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477418{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477419{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477420{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477421{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477422{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477423{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9347742a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9347742b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9347742c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477434{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477435{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477436{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9347743e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477448{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477449{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9347744a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477452{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477453{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477454{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9347745c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9347745d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477466{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477467{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93477468{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-12.24[-18.99,-8.17]1.005,783.64TY(absent vs stay)2.41[0.34,5.31]1.0010,276.95TY(return vs stay)1.56[-1.75,5.16]1.0015,422.87TY(leave vs stay)4.11[1.56,8.03]1.008,284.93TYとの親密度(CSI)-0.07[-1.57,1.52]1.0015,017.73IT(absent vs stay)2.38[0.53,4.95]1.0012,860.56IT(return vs stay)3.17[0.13,6.88]1.0014,407.13IT(leave vs stay)1.83[-1.21,4.94]1.0020,173.99ITとの親密度(CSI)0.01[-1.37,1.29]1.0015,925.14IT(absent vs stay) ×ITとの親密度0.78[-0.04,1.81]1.0019,513.98IT(return vs stay) ×ITとの親密度0.70[-1.03,2.39]1.0017,842.16IT(leave vs stay) ×ITとの親密度0.50[-0.89,2.05]1.0032,421.56前日のオスからの攻撃頻度0.95[0.05,2.33]1.007,888.10前日の群れ外オス数-0.52[-1.88,0.46]1.0013,599.23血縁のメスが群れを離れたか(vs 否)2.03[0.78,3.25]1.0016,897.93順位0.28[-1.22,1.79]1.0013,753.25年齢0.46[-0.82,1.72]1.0016,580.09アカンボウの有無 (vs 無)0.87[-0.41,2.31]1.0035,644.51前日確認したメスの割合0.75[-0.16,2.18]1.008,551.48調査期間(m20 vs m19)2.10[-0.26,5.55]1.0010,160.96 ## [1] &quot;tables/table_female_out_an_TY4cat_no21.tiff&quot; 9.3.1.4.2 結果の図示 9.3.1.4.2.1 TYの動向・ CSIとメスが群れを出る確率の関連 まずは、estimate_contrasts関数を用いて、TYとのCSIに応じてオッズ比の対数をとったものがどのように変わるかを図示する。 # cont_female_out_an_TY4cat &lt;- estimate_contrasts(m_female_out_an_TY4cat, # at = &quot;CSI_TY_std&quot;, # length = 50) # saveRDS(cont_female_out_an_TY4cat, &quot;model/cont_female_out_an_TY4cat.rds&quot;) cont_female_out_an_TY4cat &lt;- readRDS(&quot;model/cont_female_out_an_TY4cat.rds&quot;) ## メモリの調整 breaks_fun &lt;- function(x) { if (max(abs(x)) &gt; 15) { seq(-32, 32, 4) } else { seq(-14, 14, 2) } } cont_female_out_an_TY4cat %&gt;% rename(Level1 = Level2, Level2 = Level1) %&gt;% mutate(Difference = -Difference) %&gt;% data.frame() %&gt;% mutate(type = str_c(Level1, &quot; vs &quot;, Level2)) %&gt;% mutate(type = str_replace_all(type, &quot;TY_&quot;, &quot;&quot;)) %&gt;% mutate(type = str_replace_all(type, &quot;out&quot;, &quot;leave&quot;)) %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(female_out_an_c$CSI_TY)*CSI_TY + mean(female_out_an$CSI_TY)) %&gt;% ggplot(aes(x = CSI_TY, y = Difference)) + geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ geom_segment(data = CSI_TY %&gt;% expand(data.frame(type = c(&quot;absent vs stay&quot;, &quot;leave vs absent&quot;, &quot;leave vs stay&quot;, &quot;leave vs return&quot;, &quot;return vs absent&quot;, &quot;return vs stay&quot;)) %&gt;% mutate(type = fct_relevel(type, &quot;absent vs stay&quot;, &quot;leave vs absent&quot;, &quot;leave vs stay&quot;, &quot;leave vs return&quot;, &quot;return vs absent&quot;, &quot;return vs stay&quot;)), nesting(subject, CSI_TY)) %&gt;% mutate(y = c(rep(-0.8,18), rep(-1, 18), rep(-1.3,18), rep(-3,18), rep(-3, 18), rep(-3,18))), aes(xend = CSI_TY, y= y, yend = -0.02), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.4, arrow = arrow(length = unit(9, &quot;points&quot;))) + geom_line(aes(group = type))+ geom_ribbon(aes(ymin = -CI_low, ymax = -CI_high, group = type), alpha = 0.2)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;TY&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,0.5))+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(hjust = 0))+ scale_y_continuous(breaks = breaks_fun)+ facet_rep_wrap(~type, repeat.tick.labels = TRUE, scales = &quot;free_y&quot;) -&gt; p_female_out_an_TY4cat_csi p_female_out_an_TY4cat_csi # ggsave(&quot;figures/p_female_out_an_TY4cat_csi.png&quot;, # p_female_out_an_TY4cat_csi, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 200) # ggsave(&quot;figures/p_female_out_an_TY4cat_csi_noarrow.png&quot;, # p_female_out_an_TYstate_csi, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 100) 9.3.1.4.2.2 ITの動向・ CSIとメスが群れを出る確率の関連 続いて、estimate_contrasts関数を用いて、ITとのCSIに応じてオッズ比の対数をとったものがどのように変わるかを図示する。 # cont_female_out_an_IT4cat &lt;- estimate_contrasts(m_female_out_an_TY4cat, # contrast = &quot;IT_state4&quot;, # at = &quot;CSI_IT_std&quot;, # length = 50) # saveRDS(cont_female_out_an_IT4cat, &quot;model/cont_female_out_an_IT4cat.rds&quot;) cont_female_out_an_IT4cat &lt;- readRDS(&quot;model/cont_female_out_an_IT4cat.rds&quot;) cont_female_out_an_IT4cat %&gt;% data.frame() %&gt;% rename(Level1 = Level2, Level2 = Level1) %&gt;% mutate(Difference = -Difference) %&gt;% mutate(type = str_c(Level1, &quot; vs &quot;, Level2)) %&gt;% mutate(type = str_replace_all(type, &quot;IT_&quot;, &quot;&quot;)) %&gt;% mutate(type = str_replace_all(type, &quot;out&quot;, &quot;leave&quot;)) %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_an_c$CSI_IT)*CSI_IT + mean(female_out_an_c$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference)) + geom_segment(data = CSI_IT %&gt;% expand(data.frame(type = c(&quot;absent vs stay&quot;, &quot;leave vs absent&quot;, &quot;leave vs stay&quot;, &quot;leave vs return&quot;, &quot;return vs absent&quot;, &quot;return vs stay&quot;)) %&gt;% mutate(type = fct_relevel(type, &quot;absent vs stay&quot;, &quot;leave vs absent&quot;, &quot;leave vs stay&quot;, &quot;leave vs return&quot;, &quot;return vs absent&quot;, &quot;return vs stay&quot;)), nesting(subject, CSI_IT)) %&gt;% mutate(y = c(rep(-0.8,18), rep(-1, 18), rep(-1.3,18), rep(-1.3,18), rep(-1.3, 18), rep(-1.3,18))), aes(xend = CSI_IT, y= y, yend = 0), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.4, arrow = arrow(length = unit(9, &quot;points&quot;))) + geom_line(aes(group = type))+ geom_ribbon(aes(ymin = -CI_low, ymax = -CI_high, group = type), alpha = 0.2)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,7,1))+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(hjust = 0))+ scale_y_continuous(breaks = seq(-6,12,2))+ facet_rep_wrap(~type, repeat.tick.labels = TRUE, scales = &quot;free_y&quot;) -&gt; p_female_out_an_IT4cat_csi p_female_out_an_IT4cat_csi # ggsave(&quot;figures/p_female_out_an_IT4cat_csi.png&quot;, # p_female_out_an_IT4cat_csi, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 200) # ggsave(&quot;figures/p_female_out_an_IT4cat_csi_noarrow.png&quot;, # p_female_out_an_IT4cat_csi, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 200) 2021年のデータを除いたものは以下のようになる。 # cont_female_out_an_IT4cat_no21 &lt;- estimate_contrasts(m_female_out_an_TY4cat_no21, # contrast = &quot;IT_state4&quot;, # at = &quot;CSI_IT_std&quot;, # length = 50) # saveRDS(cont_female_out_an_IT4cat_no21, &quot;model/cont_female_out_an_IT4cat_no21.rds&quot;) cont_female_out_an_IT4cat_no21 &lt;- readRDS(&quot;model/cont_female_out_an_IT4cat_no21.rds&quot;) cont_female_out_an_IT4cat_no21 %&gt;% data.frame() %&gt;% rename(Level1 = Level2, Level2 = Level1) %&gt;% mutate(Difference = -Difference) %&gt;% mutate(type = str_c(Level1, &quot; vs &quot;, Level2)) %&gt;% mutate(type = str_replace_all(type, &quot;IT_&quot;, &quot;&quot;)) %&gt;% mutate(type = str_replace_all(type, &quot;out&quot;, &quot;leave&quot;)) %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_an_c$CSI_IT)*CSI_IT + mean(female_out_an_c$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference)) + geom_segment(data = CSI_IT %&gt;% expand(data.frame(type = c(&quot;absent vs stay&quot;, &quot;leave vs absent&quot;, &quot;leave vs stay&quot;, &quot;leave vs return&quot;, &quot;return vs absent&quot;, &quot;return vs stay&quot;)) %&gt;% mutate(type = fct_relevel(type, &quot;absent vs stay&quot;, &quot;leave vs absent&quot;, &quot;leave vs stay&quot;, &quot;leave vs return&quot;, &quot;return vs absent&quot;, &quot;return vs stay&quot;)), nesting(subject, CSI_IT)) %&gt;% mutate(y = c(rep(-0.8,18), rep(-1, 18), rep(-1.3,18), rep(-1.3,18), rep(-1.3, 18), rep(-1.3,18))), aes(xend = CSI_IT, y= y, yend = 0), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.4, arrow = arrow(length = unit(9, &quot;points&quot;))) + geom_line(aes(group = type))+ geom_ribbon(aes(ymin = -CI_low, ymax = -CI_high, group = type), alpha = 0.2)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,7,1))+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(hjust = 0))+ scale_y_continuous(breaks = seq(-6,12,2))+ facet_rep_wrap(~type, repeat.tick.labels = TRUE, scales = &quot;free_y&quot;) -&gt; p_female_out_an_IT4cat_csi_no21 p_female_out_an_IT4cat_csi_no21 # ggsave(&quot;figures/p_female_out_an_IT4cat_csi_no21.png&quot;, # p_female_out_an_IT4cat_csi_no21, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 200) # # ggsave(&quot;figures/p_female_out_an_IT4cat_csi_no21_noarrow.png&quot;, # p_female_out_an_IT4cat_csi_no21, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 200) 9.3.2 交尾期(発情メス) 続いて、発情メスについて分析を行う。 9.3.2.1 データの加工 female_out_es &lt;- female_out_final %&gt;% filter(!str_detect(study_period, &quot;nm&quot;)) %&gt;% filter(rs_pre == &quot;1&quot;) %&gt;% ## TYとITとのCSIがないメスは除く drop_na(CSI_TY) %&gt;% mutate(rate_agg_6yo_std = standardize(rate_agg_6yo_pre), rate_agg_all_std = standardize(rate_agg_all_pre)) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), rank_std = standardize(rank_scaled), age_std = standardize(age), kin_std = standardize(max_kin), ntm_std = standardize(no_ntm)) %&gt;% mutate(date = as.factor(date)) %&gt;% ## 2021年はIT_outを全て0とする replace_na(list(IT_out = 0, IT_pre = 0)) 9.3.2.2 モデリング1 モデル式は非発情メスと同様である。 モデルは以下のように実行する。 ## 全個体への攻撃 ### 攻撃頻度とオスの出入りの交互作用なし m_female_out_es &lt;- brm(data = female_out_es, female_out ~ rate_agg_all_pre + TY_out*CSI_TY_std + IT_out*CSI_IT_std + age + rank_scaled + kin_01 + ntm_std + study_period + (1|femaleID) + (1|date), family = &quot;bernoulli&quot;, prior = c(prior(student_t(4,0,20),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,10), class = sd)), iter = 11000, warmup = 1000, seed = 223, control=list(adapt_delta = 0.999, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_out_es&quot;) ## 2021交尾期を除く female_out_es %&gt;% filter(study_period != &quot;m21&quot;) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), rank_std = standardize(rank_scaled), age_std = standardize(age), kin_std = standardize(max_kin), ntm_std = standardize(no_ntm), prop_std = standardize(prop_female), rate_agg_all_std = standardize(rate_agg_all_pre), ntm_std = standardize(no_ntm)) %&gt;% mutate(date = as.factor(date)) -&gt; female_out_es_no21 m_female_out_es_bf21 &lt;- brm(data = female_out_es_no21, female_out ~ rate_agg_all_pre + TY_out*CSI_TY_std + IT_out*CSI_IT_std + age + rank_scaled + kin_01 + ntm_std + study_period + (1|femaleID) + (1|date), family = &quot;bernoulli&quot;, prior = c(prior(student_t(4,0,40),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,10), class = sd)), iter = 11000, warmup = 1000, seed = 223, control=list(adapt_delta = 0.999, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_out_es_bf21&quot;) 9.3.2.2.1 モデルチェック まず、DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。特に問題はないよう。 ## 全期間 dh_female_out_es &lt;- dh_check_brms(m_female_out_es) ## 2021年を除く dh_female_out_es_bf21 &lt;- dh_check_brms(m_female_out_es_bf21) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## 全期間 pp_check(m_female_out_es, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) ## 2021年を除く pp_check(m_female_out_es_bf21, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) 多重共線性のチェックもお個あったが、VIFに問題はない。 ## 全期間 check_collinearity(m_female_out_es) ## 2021年を除く check_collinearity(m_female_out_es_bf21) Rhatにも問題はなく、収束の問題はないよう。 ## 全期間 data.frame(Rhat = brms::rhat(m_female_out_es)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) ## 2021年を除く data.frame(Rhat = brms::rhat(m_female_out_es_bf21)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 最後に残差の時系列相関のチェックを行う。 まず全期間のデータを調べた。残差の自己相関をプロットすると、明確なパターンは見られなかった。また、Ljung-Box検定で3時点前(発情時のデータは少ないため、4時点以降だとデータがない個体が多い)までの残差との自己相関を検定したところ、有意な自己相関を示した個体はKit,Meiのみだった。 res_female_out_es &lt;- female_out_es %&gt;% mutate(resid = dh_female_out_es$scaledResiduals) %&gt;% mutate(date = as_date(date)) %&gt;% group_by(femaleID) %&gt;% complete(date = seq.Date(min(date), max(date), by = &quot;1 day&quot;)) %&gt;% ungroup() females &lt;- unique(female_out_es$femaleID) acf_female_out_es &lt;- NULL for(i in seq_along(females)){ data &lt;- res_female_out_es %&gt;% filter(femaleID == females[i]) out.acf &lt;- acf(data$resid, lag.max = 5, na.action = na.pass, plot = F) box_test &lt;- Box.test(data$resid, type = &quot;Ljung-Box&quot;, lag = 3) out.df &lt;- data.frame(Timelag = out.acf$lag, Acf = out.acf$acf, femaleID = females[i], p = box_test$p.value) acf_female_out_es &lt;- bind_rows(acf_female_out_es, out.df) } acf_female_out_es %&gt;% mutate(p = str_c(&quot;p = &quot;,round(p,2))) %&gt;% ggplot(aes(x = Timelag, y = 0))+ geom_segment(aes(xend = Timelag, yend = Acf))+ geom_text(aes(x = 4, y = 0.8, label = p), size = 3.5, family = &quot;Arial&quot;)+ theme_bw()+ theme(aspect.ratio = 1)+ facet_rep_wrap(~femaleID, repeat.tick.labels = TRUE) 2021年を除いたモデルについても見てみる。有意な自己相関を示した個体はHotだけだった。 res_female_out_es_bf21 &lt;- female_out_es_no21 %&gt;% mutate(resid = dh_female_out_es_bf21$scaledResiduals) %&gt;% mutate(date = as_date(date)) %&gt;% group_by(femaleID) %&gt;% complete(date = seq.Date(min(date), max(date), by = &quot;1 day&quot;)) %&gt;% ungroup() females &lt;- unique(female_out_es_no21$femaleID) acf_female_out_es_bf21 &lt;- NULL for(i in seq_along(females)){ data &lt;- res_female_out_es_bf21 %&gt;% filter(femaleID == females[i]) out.acf &lt;- acf(data$resid, lag.max = 5, na.action = na.pass, plot = F) box_test &lt;- Box.test(data$resid, type = &quot;Ljung-Box&quot;, lag = 3) out.df &lt;- data.frame(Timelag = out.acf$lag, Acf = out.acf$acf, femaleID = females[i], p = box_test$p.value) acf_female_out_es_bf21 &lt;- bind_rows(acf_female_out_es_bf21, out.df) } acf_female_out_es_bf21 %&gt;% mutate(p = str_c(&quot;p = &quot;,round(p,2))) %&gt;% ggplot(aes(x = Timelag, y = 0))+ geom_segment(aes(xend = Timelag, yend = Acf))+ geom_text(aes(x = 4, y = 0.8, label = p), size = 3.5, family = &quot;Arial&quot;)+ theme_bw()+ theme(aspect.ratio = 1)+ facet_rep_wrap(~femaleID, repeat.tick.labels = TRUE) 9.3.2.2.2 結果の確認 9.3.2.2.2.1 推定された係数 結果は以下の通り。有意な変数は一つもなかった。 .cl-acdd486a{table-layout:auto;width:90%;}.cl-acd3806e{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-acd38078{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-acd38082{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-acd7bd3c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-acd7bd50{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-acd7d7b8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-acd7d7b9{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-acd7d7ba{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-acd7d7c2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-acd7d7c3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-acd7d7c4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-3.78[-8.43,0.61]1.0026,489.71TYが群れを離れたか (vs 否)-0.03[-2.99,2.40]1.0021,600.12TYとの親密度(CSI)-0.27[-1.31,0.67]1.0019,266.81TYが群れを離れたか ×TYとの親密度-1.15[-5.46,1.06]1.0021,016.76ITが群れを離れたか (vs 否)-7.76[-38.85,2.05]1.0012,121.39ITとの親密度(CSI)-0.02[-0.86,0.87]1.0021,028.24ITが群れを離れたか ×ITとの親密度-5.78[-34.74,4.93]1.0011,680.70前日のオスからの攻撃頻度-0.12[-0.69,0.44]1.0025,849.85前日の群れ外オス数0.19[-0.35,0.77]1.0031,987.01血縁のメスが群れを離れたか0.24[-1.56,1.74]1.0040,139.94順位0.31[-2.83,3.53]1.0020,244.84年齢0.04[-0.32,0.33]1.0021,585.10調査期間(m20 vs m19)0.71[-1.43,3.05]1.0021,214.26調査期間(m21 vs m19)0.92[-0.59,2.80]1.0017,878.59 2021年を除いたモデルでも同様。ただし、かなりデータの推定幅が大きいようだ。 .cl-b06746d4{table-layout:auto;width:90%;}.cl-af16c8ea{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-af16c8eb{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-af16c8f4{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b0622e10{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b0622e24{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b0624d6e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b0624d78{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b0624d79{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b0624d82{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b0624d83{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b0624d84{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-23.50[-85.84,15.19]1.0014,529.08TYが群れを離れたか (vs 否)-7.21[-30.72,8.86]1.0024,620.69TYとの親密度(CSI)2.58[-3.47,9.97]1.0016,646.30TYが群れを離れたか ×TYとの親密度8.60[-3.43,28.39]1.0024,758.57ITが群れを離れたか (vs 否)-3.02[-31.54,15.69]1.0015,205.88ITとの親密度(CSI)-6.12[-22.20,3.24]1.0020,217.41ITが群れを離れたか ×ITとの親密度-2.41[-29.53,14.73]1.0022,263.33前日のオスからの攻撃頻度-0.82[-7.45,3.73]1.0016,447.95前日の群れ外オス数-1.28[-9.30,5.32]1.0017,190.22血縁のメスが群れを離れたか1.73[-17.33,21.05]1.0036,427.10順位-4.81[-25.34,13.04]1.0027,997.67年齢0.58[-2.54,4.58]1.0016,178.71調査期間(m20 vs m19)7.01[-5.14,24.17]1.0022,808.34 9.3.2.2.2.2 交互作用項の検討 全期間を含むモデル さらに交互作用項のある変数について検討を行う。以下は、TYとのCSIに応じて、TYが群れを離れた日に群れを離れる確率が、そうでない日に比べて有意に高いかを調べたものである。Differenceはログオッズ比を示し、0より大きければ、TYが群れを離れなかった日に比べて、TYが群れを離れた日にメスが群れを離れる確率が高かったことを表す。この結果から、いずれのCSIでも有意な差はなかったことが分かった。 estimate_contrasts(m_female_out_es, contrast = &quot;TY_out = c(1,0)&quot;, at = &quot;CSI_TY_std = seq(-0.85,2.70, 0.2)&quot;, transform = &quot;none&quot;) %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(female_out_es$CSI_TY)*CSI_TY + mean(female_out_es$CSI_TY)) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) ITについては、CSIが高い個体(&gt; 1.5くらい)はITが群れから離れない日の方がそうでない日よりもメスが群れを離れる可能性が有意に高くなることが分かった。 estimate_contrasts(m_female_out_es, contrast = &quot;IT_out = c(1,0)&quot;, at = &quot;CSI_IT_std = seq(-0.67,3.08, 0.2)&quot;, transform = &quot;none&quot;) %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_es$CSI_IT)*CSI_IT + mean(female_out_es$CSI_IT)) %&gt;% select(1:6) %&gt;% mutate(across(3:6, ~round(.,2))) 2021年を除くモデル 2021年を除いたモデルでも、TYについては同様。 estimate_contrasts(m_female_out_es_bf21, contrast = &quot;TY_out = c(1,0)&quot;, at = &quot;CSI_TY_std = seq(-1.34,7.02, 0.2)&quot;, transform = &quot;none&quot;) %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(female_out_es$CSI_TY)*CSI_TY + mean(female_out_es$CSI_TY)) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) ITについても有意な結果は得られなかった。 estimate_contrasts(m_female_out_es_bf21, contrast = &quot;IT_out = c(1,0)&quot;, at = &quot;CSI_IT_std = seq(-0.66,2.74,0.2)&quot;, transform = &quot;none&quot;) %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_es$CSI_IT)*CSI_IT + mean(female_out_es$CSI_IT)) %&gt;% select(1:6) %&gt;% mutate(across(3:6, ~round(.,2))) 9.3.2.2.3 結果の図示 9.3.2.2.3.1 TYの群れへの出入り、CSIとの関連 まず、TYとのCSIに応じてオッズ比(TYと同じ日に群れを離れるオッズ/そうでない日に離れるオッズ)の対数をとったものがどのように変わるかを図示する。特に有意な効果はない。 # cont_female_out_es_TYcsi &lt;- estimate_contrasts(m_female_out_es, # contrast = &quot;TY_out = c(1,0)&quot;, # at = &quot;CSI_TY_std&quot;, # length = 50, # transform = &quot;none&quot;) # # saveRDS(cont_female_out_es_TYcsi, &quot;model/cont_female_out_es_TYcsi.rds&quot;) cont_female_out_es_TYcsi &lt;- readRDS(&quot;model/cont_female_out_es_TYcsi.rds&quot;) cont_female_out_es_TYcsi %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(female_out_es$CSI_TY)*CSI_TY + mean(female_out_es$CSI_TY)) %&gt;% ggplot(aes(x = CSI_TY, y = Difference))+ geom_segment(data = CSI_TY, aes(xend = CSI_TY, y=-2, yend = 0), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.6, arrow = arrow(length = unit(11, &quot;points&quot;))) + geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;TY&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,0.5))+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1) -&gt; p_female_out_es_TYcsi p_female_out_es_TYcsi # ggsave(&quot;figures/p_female_out_es_TYcsi.png&quot;,p_female_out_es_TYcsi, dpi = 600, units = &quot;mm&quot;, # width = 100, height = 100) 9.3.2.2.3.2 ITの群れへの出入り、CSIとの関連 続いて、ITとのCSIに応じてオッズ比(ITと同じ日に群れを離れるオッズ/そうでない日に離れるオッズ)の対数をとったものがどのように変わるかを図示する。こちらはCSIが大きいメスは逆にITが群れを離れた日にメスが群れを離れる確率の方が低くなることが示唆された。ただし、これはおそらく2021年交尾期のIT_outが全て0になっていることによると思われる? # cont_female_out_es_ITcsi &lt;- estimate_contrasts(m_female_out_es, # contrast = &quot;IT_out = c(1,0)&quot;, # at = &quot;CSI_IT_std&quot;, # length = 50, # transform = &quot;none&quot;) # # saveRDS(cont_female_out_es_ITcsi, &quot;model/cont_female_out_es_ITcsi.rds&quot;) cont_female_out_es_ITcsi &lt;- readRDS(&quot;model/cont_female_out_es_ITcsi.rds&quot;) cont_female_out_es_ITcsi %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_es$CSI_IT)*CSI_IT + mean(female_out_es$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference))+ geom_segment(data = CSI_IT, aes(xend = CSI_IT, y=-10, yend = 0), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.6, arrow = arrow(length = unit(11, &quot;points&quot;))) + geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,6,1))+ scale_y_continuous(breaks = seq(-130,30,10)) + theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1) -&gt; p_female_out_es_ITcsi p_female_out_es_ITcsi ggsave(&quot;figures/p_female_out_es_ITcsi.png&quot;,p_female_out_es_ITcsi, dpi = 600, units = &quot;mm&quot;, width = 100, height = 100) 2021年を除いたモデルについても図示する。 # cont_female_out_es_ITcsi_bf21 &lt;- estimate_contrasts(m_female_out_es_bf21, # contrast = &quot;IT_out = c(1,0)&quot;, # at = &quot;CSI_IT_std&quot;, # length = 50, # transform = &quot;none&quot;) # # saveRDS(cont_female_out_es_ITcsi_bf21, &quot;model/cont_female_out_es_ITcsi_bf21.rds&quot;) cont_female_out_es_ITcsi_bf21 &lt;- readRDS(&quot;model/cont_female_out_es_ITcsi_bf21.rds&quot;) cont_female_out_es_ITcsi_bf21 %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_out_es_no21$CSI_IT)*CSI_IT + mean(female_out_es_no21$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference))+ geom_segment(data = CSI_IT, aes(xend = CSI_IT, y=-10, yend = 0), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.6, arrow = arrow(length = unit(11, &quot;points&quot;))) + geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,6,1))+ scale_y_continuous(breaks = seq(-130,30,10)) + theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1) -&gt; p_female_out_es_ITcsi_bf21 p_female_out_es_ITcsi_bf21 # ggsave(&quot;figures/p_female_out_es_ITcsi_bf21.png&quot;,p_female_out_es_ITcsi_bf21, dpi = 600, units = &quot;mm&quot;, # width = 100, height = 100) 9.3.2.3 モデリング2 モデル式は非発情メスと同様。以下のように変数を作成する。 female_out_es_b &lt;- female_out_es %&gt;% mutate(TY_state = ifelse(TY_pre == 1 &amp; TY_out == 1, &quot;TY_out&quot;, ifelse(TY_pre == 1 &amp; TY_out == 0, &quot;TY_stay&quot;, ifelse(TY_pre == 0, &quot;TY_absent&quot;, NA)))) %&gt;% mutate(TY_state = fct_relevel(TY_state, &quot;TY_stay&quot;, &quot;TY_absent&quot;)) %&gt;% mutate(IT_state = ifelse(IT_pre == 1 &amp; IT_out == 1, &quot;IT_out&quot;, ifelse(IT_pre == 1 &amp; IT_out == 0, &quot;IT_stay&quot;, ifelse(IT_pre == 0, &quot;IT_absent&quot;, NA)))) %&gt;% mutate(IT_state = fct_relevel(IT_state, &quot;IT_stay&quot;, &quot;IT_absent&quot;)) モデルは以下のように実行する。 ## オスの攻撃との交互作用なし ### IT_stateちCSI_IT_stdの交互作用はVIFが高いため除外 m_female_out_es_TYstate &lt;- brm(data = female_out_es_b %&gt;% mutate(date = as.factor(date)), female_out ~ rate_agg_all_pre + TY_state*CSI_TY_std + IT_state + CSI_IT_std + ntm_std + age + rank_scaled + kin_01 + study_period + (1|femaleID) + (1|date), family = &quot;bernoulli&quot;, prior = c(prior(student_t(4,0,20),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,10), class = sd)), iter = 11000, warmup = 1000, seed = 223, control=list(adapt_delta = 0.999, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_out_es_TYstate&quot;) ## 2021交尾期を除く female_out_es_b %&gt;% filter(study_period != &quot;m21&quot;) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), rank_std = standardize(rank_scaled), age_std = standardize(age), kin_std = standardize(max_kin), ntm_std = standardize(no_ntm), prop_std = standardize(prop_female), rate_agg_all_std = standardize(rate_agg_all_pre)) -&gt; female_out_es_b_no21 m_female_out_es_TYstate_bf21 &lt;- brm(data = female_out_es_b_no21 %&gt;% mutate(date = as.factor(date)), female_out ~ rate_agg_all_pre + TY_state*CSI_TY_std + IT_state + CSI_IT_std + ntm_std + age + rank_scaled + kin_01 + study_period + (1|femaleID) + (1|date), family = &quot;bernoulli&quot;, prior = c(prior(student_t(4,0,40),class = Intercept), prior(student_t(4,0,15), class = b), prior(student_t(4,0,15), class = sd)), iter = 11000, warmup = 1000, seed = 123, control=list(adapt_delta = 0.999, max_treedepth = 20), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_out_es_TYstate_bf21&quot;) 9.3.2.3.1 モデルチェック まず、DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。 ## 全期間 dh_female_out_es_TYstate &lt;- dh_check_brms(m_female_out_es_TYstate) ## 2021年を除く dh_female_out_es_TYstate_bf21 &lt;- dh_check_brms(m_female_out_es_TYstate_bf21) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## 全期間 pp_check(m_female_out_es_TYstate, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) ## 2021年を除く pp_check(m_female_out_es_TYstate_bf21, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) 多重共線性のチェックもお個あったが、VIFに問題はない。 ## 全期間 check_collinearity(m_female_out_es_TYstate) ## 2021年を除く check_collinearity(m_female_out_es_TYstate_bf21) Rhatにも問題はなく、収束の問題はないよう。 ## 全期間 data.frame(Rhat = brms::rhat(m_female_out_es_TYstate)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) ## 2021年を除く data.frame(Rhat = brms::rhat(m_female_out_es_TYstate_bf21)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) 最後に残差の時系列相関のチェックを行う。 残差の自己相関をプロットする。 全期間のデータを用いたモデルでは、多くの個体では明確なパターンは見られなかった。また、Ljung-Box検定で3時点前(発情時のデータは少ないため、4時点以降だとデータがない個体がいる)までの残差との自己相関を検定したところ、有意な自己相関を示した個体はKitとMeiのみだった。 res_female_out_es_TYstate &lt;- female_out_es_b %&gt;% mutate(resid = dh_female_out_es_TYstate$scaledResiduals) %&gt;% mutate(date = as_date(date)) %&gt;% group_by(femaleID) %&gt;% complete(date = seq.Date(min(date), max(date), by = &quot;1 day&quot;)) %&gt;% ungroup() females &lt;- unique(female_out_es_b$femaleID) acf_female_out_es_TYstate &lt;- NULL for(i in seq_along(females)){ data &lt;- res_female_out_es_TYstate %&gt;% filter(femaleID == females[i]) out.acf &lt;- acf(data$resid, lag.max = 5, na.action = na.pass, plot = F) box_test &lt;- Box.test(data$resid, type = &quot;Ljung-Box&quot;, lag = 3) out.df &lt;- data.frame(Timelag = out.acf$lag, Acf = out.acf$acf, femaleID = females[i], p = box_test$p.value) acf_female_out_es_TYstate &lt;- bind_rows(acf_female_out_es_TYstate, out.df) } acf_female_out_es_TYstate %&gt;% mutate(p = str_c(&quot;p = &quot;,round(p,2))) %&gt;% ggplot(aes(x = Timelag, y = 0))+ geom_segment(aes(xend = Timelag, yend = Acf))+ geom_text(aes(x = 4, y = 0.8, label = p), size = 3.5, family = &quot;Arial&quot;)+ theme_bw()+ theme(aspect.ratio = 1)+ facet_rep_wrap(~femaleID, repeat.tick.labels = TRUE) 2021年ではHotのみで有意な自己相関がみられた。 res_female_out_es_TYstate_bf21 &lt;- female_out_es_b_no21 %&gt;% mutate(resid = dh_female_out_es_TYstate_bf21$scaledResiduals) %&gt;% mutate(date = as_date(date)) %&gt;% group_by(femaleID) %&gt;% complete(date = seq.Date(min(date), max(date), by = &quot;1 day&quot;)) %&gt;% ungroup() females &lt;- unique(female_out_es_b_no21$femaleID) acf_female_out_es_TYstate_bf21 &lt;- NULL for(i in seq_along(females)){ data &lt;- res_female_out_es_TYstate_bf21 %&gt;% filter(femaleID == females[i]) out.acf &lt;- acf(data$resid, lag.max = 5, na.action = na.pass, plot = F) box_test &lt;- Box.test(data$resid, type = &quot;Ljung-Box&quot;, lag = 3) out.df &lt;- data.frame(Timelag = out.acf$lag, Acf = out.acf$acf, femaleID = females[i], p = box_test$p.value) acf_female_out_es_TYstate_bf21 &lt;- bind_rows(acf_female_out_es_TYstate_bf21, out.df) } acf_female_out_es_TYstate_bf21 %&gt;% mutate(p = str_c(&quot;p = &quot;,round(p,2))) %&gt;% ggplot(aes(x = Timelag, y = 0))+ geom_segment(aes(xend = Timelag, yend = Acf))+ geom_text(aes(x = 4, y = 0.8, label = p), size = 3.5, family = &quot;Arial&quot;)+ theme_bw()+ theme(aspect.ratio = 1)+ facet_rep_wrap(~femaleID, repeat.tick.labels = TRUE) 9.3.2.3.2 結果の確認 9.3.2.3.2.1 推定された係数 結果は以下の通り。 .cl-d79df3ce{table-layout:auto;width:100%;}.cl-d6974084{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d697408e{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d6974098{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d796fcfe{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d796fd08{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d797221a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972224{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797222e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797222f{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972238{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972239{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797223a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972242{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972243{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797224c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797224d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972256{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972257{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972258{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972259{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972260{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972261{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797226a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797226b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797226c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972274{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797227e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797227f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972280{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972281{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972288{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972289{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797228a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972292{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972293{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d7972294{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797229c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797229d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d797229e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d79722a6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d79722a7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d79722b0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d79722b1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d79722ba{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d79722c4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-3.96[-9.24,1.01]1.0028,866.57TY(absent vs stay)0.07[-1.24,1.37]1.0029,602.21TY(leave vs stay)0.07[-3.07,2.80]1.0023,110.08TYとの親密度(CSI)-0.41[-1.68,0.64]1.0017,358.19TY(absent vs stay) ×TYとの親密度0.27[-0.84,1.36]1.0041,160.36TY(leave vs stay) ×TYとの親密度-1.03[-5.31,1.23]1.0025,690.03IT(absent vs stay)-0.00[-2.10,2.15]1.0038,242.86IT(leave vs stay)-7.74[-34.30,0.72]1.009,267.50ITとの親密度(CSI)-0.03[-0.95,0.96]1.0018,934.72前日のオスからの攻撃頻度-0.09[-0.73,0.53]1.0022,783.32前日の群れ外オス数0.18[-0.42,0.85]1.0030,346.10血縁のメスが群れを離れたか0.21[-1.64,1.76]1.0047,477.00順位0.25[-3.11,3.72]1.0017,471.17年齢0.03[-0.35,0.35]1.0021,568.22調査期間(m20 vs m19)0.78[-1.46,3.31]1.0022,912.40調査期間(m21 vs m19)1.02[-0.77,3.26]1.0015,988.00 2021を除いたモデルの結果は以下の通り。明らかに推定の幅が大きすぎる。以後、このモデルの結果は用いないものとする。 .cl-db3826b2{table-layout:auto;width:100%;}.cl-db2d5c00{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-db2d5c14{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-db2d5c15{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-db31feea{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-db31fef4{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-db32316c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db323180{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db323181{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db323182{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db32318a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db323194{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db323195{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db32319e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231a8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231b2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231b3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231b4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231b5{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231bc{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231bd{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231be{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231c6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231c7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231c8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231c9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231d0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231d1{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231da{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231db{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231e4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231e5{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231e6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231ee{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231ef{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231f0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231f1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231f8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231f9{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db3231fa{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db323202{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db323203{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db323204{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db32320c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db32320d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-db32320e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-54.47[-154.65,17.32]1.0021,682.45TY(absent vs stay)9.11[-8.80,34.18]1.0027,520.05TY(leave vs stay)-7.49[-44.39,19.71]1.0038,435.78TYとの親密度(CSI)5.33[-6.06,18.18]1.0022,058.04TY(absent vs stay) ×TYとの親密度1.94[-14.11,17.46]1.0030,362.21TY(leave vs stay) ×TYとの親密度14.09[-7.14,47.85]1.0027,382.37IT(absent vs stay)-1.34[-20.81,17.44]1.0025,605.50IT(leave vs stay)-3.54[-45.20,25.56]1.0019,982.89ITとの親密度(CSI)-8.70[-32.85,7.07]1.0029,239.03前日のオスからの攻撃頻度-2.95[-14.64,5.96]1.0023,311.97前日の群れ外オス数-2.10[-15.59,9.94]1.0023,939.57血縁のメスが群れを離れたか4.25[-25.86,36.54]1.0052,706.28順位-5.86[-38.41,22.20]1.0043,367.83年齢1.51[-4.05,8.00]1.0022,207.36調査期間(m20 vs m19)11.05[-10.24,39.34]1.0028,425.43 9.3.2.3.2.2 交互作用項の推定 さらに交互作用項のある変数について検討を行う。以下は、TY/ITとのCSIの値によって、TY/IT_stateの各水準のときにおいてメスが群れを離れる確率がどのように違うかを調べたものである。Differenceはログオッズの差を表している。 cont_female_out_es_TYstate &lt;- estimate_contrasts( m_female_out_es_TYstate, contrast = &quot;TY_state = c(&#39;TY_out&#39;,&#39;TY_absent&#39;,&#39;TY_stay&#39;)&quot;, at = &quot;CSI_TY_std = seq(-0.85,2.70, 0.2)&quot;, transform = &quot;none&quot;) %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(female_out_es_b$CSI_TY)*CSI_TY + mean(female_out_es_b$CSI_TY)) TYが群れにいなかったときもTYが群れにとどまったときもメスが群れを離れる確率に有意な違いはない。 ### absent vs stay cont_female_out_es_TYstate %&gt;% data.frame() %&gt;% filter(Level1 == &quot;TY_absent&quot;, Level2 == &quot;TY_stay&quot;) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 続いて、TYが群れを離れたときもTYが群れにとどまったときと比べて有意な差はない。 ### out vs stay cont_female_out_es_TYstate %&gt;% data.frame() %&gt;% filter(Level1 == &quot;TY_out&quot;, Level2 == &quot;TY_stay&quot;) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) TYが群れを離れたときとTYが群れにとどまったときも有意な差はなし。 ### out vs absent cont_female_out_es_TYstate %&gt;% data.frame() %&gt;% filter(Level1 == &quot;TY_out&quot;, Level2 == &quot;TY_absent&quot;) %&gt;% select(1:6) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 9.3.2.3.3 結果の図示 9.3.2.3.3.1 TYの動向・ CSIとメスが群れを出る確率の関連 まずは、estimate_contrasts関数を用いて、TYとのCSIに応じてオッズ比の対数をとったものがどのように変わるかを図示する。先ほど見たように、いずれの組み合わせでも有意な差はない。 # cont_female_out_es_TYstate_b &lt;- estimate_contrasts( # m_female_out_es_TYstate, # contrast = &quot;TY_state = c(&#39;TY_out&#39;,&#39;TY_absent&#39;,&#39;TY_stay&#39;)&quot;, # at = &quot;CSI_TY_std&quot;, # length = 50) # saveRDS(cont_female_out_es_TYstate_b, &quot;model/cont_female_out_es_TYstate_b.rds&quot;) cont_female_out_es_TYstate_b &lt;- readRDS(&quot;model/cont_female_out_es_TYstate_b.rds&quot;) cont_female_out_es_TYstate_b %&gt;% data.frame() %&gt;% mutate(type = str_c(Level1, &quot; vs &quot;, Level2)) %&gt;% mutate(type = str_replace_all(type, &quot;TY_&quot;, &quot;&quot;)) %&gt;% mutate(type = str_replace_all(type, &quot;out&quot;, &quot;leave&quot;)) %&gt;% mutate(type = fct_relevel(type, &quot;absent vs stay&quot;, &quot;leave vs stay&quot;, &quot;leave vs absent&quot;)) %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(female_out_es$CSI_TY)*CSI_TY + mean(female_out_es$CSI_TY)) %&gt;% ggplot(aes(x = CSI_TY, y = Difference)) + geom_segment(data = CSI_TY %&gt;% expand(data.frame(type = c(&quot;absent vs stay&quot;, &quot;leave vs absent&quot;, &quot;leave vs stay&quot;)) %&gt;% mutate(type = fct_relevel(type, &quot;absent vs stay&quot;, &quot;leave vs stay&quot;, &quot;leave vs absent&quot;)), nesting(subject, CSI_TY)) %&gt;% mutate(y = c(rep(-0.6,18), rep(-1.8, 18), rep(-1.8,18))), aes(xend = CSI_TY, y= y, yend = 0), color = &quot;firebrick3&quot;, alpha = 0.8, size = 0.4, arrow = arrow(length = unit(9, &quot;points&quot;))) + geom_line(aes(group = type))+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high, group = type), alpha = 0.2)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;TY&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,0.5))+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(hjust = 0))+ scale_y_continuous(breaks = seq(-16,12,2))+ facet_rep_wrap(~type, repeat.tick.labels = TRUE, scales = &quot;free_y&quot;) -&gt; p_female_out_es_TYstate_csi p_female_out_es_TYstate_csi # ggsave(&quot;figures/p_female_out_es_TYstate_csi.png&quot;, # p_female_out_es_TYstate_csi, dpi = 1000, units = &quot;mm&quot;, # width = 280, height = 100) # # ggsave(&quot;figures/p_female_out_es_TYstate_csi_noarrow.png&quot;, # p_female_out_es_TYstate_csi, dpi = 600, units = &quot;mm&quot;, # width = 280, height = 100) 9.3.3 非交尾期 続いて、非交尾期について分析を行う。 9.3.3.1 データの加工 female_out_nm &lt;- female_out_final %&gt;% ## 非交尾期のデータのみを抽出 filter(str_detect(study_period, &quot;nm&quot;)) %&gt;% ## TYとITとのCSIがないメスは除く drop_na(CSI_TY) %&gt;% mutate(rate_agg_6yo_std = standardize(rate_agg_6yo_pre), rate_agg_all_std = standardize(rate_agg_all_pre)) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), rank_std = standardize(rank_scaled), age_std = standardize(age), kin_std = standardize(max_kin)) %&gt;% mutate(date = as.factor(date)) %&gt;% ## 2021年はIT_outを全て0とする replace_na(list(IT_out = 0, IT_pre = 0)) データを確認すると、メスが群れを離れた日は1日だけで、TYやITとのCSIのデータがある個体は4個体のみである(データ数は643)。なお、これらの個体はITと同じ日に群れを離れた。 female_out_nm %&gt;% filter(female_out == 1) %&gt;% select(date, femaleID, female_out, TY_out, IT_out) よって非交尾期については分析を行わないものとする。 References Gabry, J., &amp; Mahr, T. (2022). Bayesplot: Plotting for bayesian models. https://mc-stan.org/bayesplot Hartig, F. (2022). DHARMa: Residual diagnostics for hierarchical (multi-level / mixed) regression models. https://CRAN.R-project.org/package=DHARMa Rodríguez-Sánchez, F. (2023). DHARMa.helpers: Helper functions to check models not (yet) directly supported by DHARMa. "],["11_female_out_network.html", "10 メス間の社会関係と離合集散の関係(ネットワーク分析) 10.1 メス間の社会関係と同じ日に群れ本体にいた割合(SRI)の関連 10.2 メス間の社会関係と同じ日に群れを離れた割合の関連", " 10 メス間の社会関係と離合集散の関係(ネットワーク分析) 以下では、メス同士が群れ本体で同じ日に確認された割合や、メス同士が同じ日に群れを離れた割合とメス同士の社会関係(血縁度、CSI、順位差など)をネットワーク分析を用いて検討する。 分析には、MRQAP検定(Dekker et al., 2007)を用いる。MRQAP検定は、簡単に言ってしまえばネットワークデータを用いた回帰分析である。MRQAP検定では、通常のGLMやGLMMと同様に、複数の隣接行列を用いた回帰分析を行うことができる(図10.1)。また、aninetパッケージ(Weiss &amp; Hart, 2023)のglmqap関数を用いれば、応答変数となる隣接行列の分布として様々なもの(e.g.,正規分布、ポワソン分布、二項分布など)を仮定することができるので、データ形式に合った適切な分析を行うこともできる。 図10.1: MRQAP検定のイメージ図 10.1 メス間の社会関係と同じ日に群れ本体にいた割合(SRI)の関連 10.1.1 データの加工 まず、メス同士が群れ本体にいた割合(以後、SRI)を算出する。用いるのは、2018年時点で6歳以上で、全期間生存していた以下の15頭である。 femaleID &lt;- sort(c(&quot;Kil&quot;,&quot;Mik&quot;,&quot;Koh&quot;,&quot;Aka&quot;,&quot;Ten&quot;,&quot;Ntr&quot;,&quot;Hen&quot;,&quot;Hot&quot;,&quot;Tot&quot;,&quot;Mei&quot;,&quot;Ako&quot;,&quot;Kol&quot;,&quot;Mal&quot;,&quot;Kit&quot;,&quot;Kun&quot;)) 以下のように算出し、オスの出入りがあった期間の群れ本体でのSRIのマトリックスを作成する。 no_female_over0.5 %&gt;% select(date, groupID) %&gt;% left_join(group_all, by = c(&quot;date&quot;, &quot;groupID&quot;)) %&gt;% select(date, study_period, one_of(femaleID)) %&gt;% filter(study_period %in% c(&quot;m19&quot;, &quot;m20&quot;,&quot;m21&quot;, &quot;nm20&quot;, &quot;nm21&quot;)) %&gt;% select(-date, -study_period) -&gt; no_female_over0.5_gbi ## SRIの分子 sri_denom &lt;- get_denominator(no_female_over0.5_gbi, index = &quot;SRI&quot;, return = &quot;matrix&quot;) diag(sri_denom) &lt;- NA ## SROマトリックス sri_mat &lt;- get_network(no_female_over0.5_gbi, data_format = &quot;GBI&quot;, association_index = &quot;SRI&quot;) ## Generating 15 x 15 matrix diag(sri_mat) &lt;- NA 続いて、血縁と順位、年齢のマトリックスを作成する。 ## 血縁マトリックス kin %&gt;% complete(femaleID, femaleID2) %&gt;% rename(fem1 = femaleID, fem2 = femaleID2) %&gt;% filter(fem1 %in% femaleID &amp; fem2 %in% femaleID) %&gt;% replace_na(list(kin = 0)) %&gt;% pivot_wider(names_from = fem1, values_from = kin) %&gt;% datawizard::column_as_rownames(var = &quot;fem2&quot;) %&gt;% as.matrix() -&gt; kin_mat rownames(kin_mat) &lt;- femaleID diag(kin_mat) &lt;- NA ## 順位マトリックス rank &lt;- read_csv(&quot;data/rank.csv&quot;) kin %&gt;% complete(femaleID, femaleID2) %&gt;% left_join(rank, by = &quot;femaleID&quot;) %&gt;% rename(rank1 = rank) %&gt;% left_join(rank, by = c(&quot;femaleID2&quot; = &quot;femaleID&quot;)) %&gt;% rename(rank2 = rank) %&gt;% rename(fem1 = femaleID, fem2 = femaleID2) %&gt;% filter(fem1 %in% femaleID &amp; fem2 %in% femaleID) %&gt;% mutate(diff_rank = abs(rank1 - rank2)) %&gt;% select(fem1, fem2, diff_rank) %&gt;% replace_na(list(diff_rank = 0)) %&gt;% pivot_wider(names_from = fem1, values_from = diff_rank) %&gt;% datawizard::column_as_rownames(var = &quot;fem2&quot;) %&gt;% as.matrix() -&gt; rank_mat rownames(rank_mat) &lt;- femaleID diag(rank_mat) &lt;- NA ### 年齢マトリックス kin %&gt;% complete(femaleID, femaleID2) %&gt;% left_join(rank, by = &quot;femaleID&quot;) %&gt;% rename(age1 = age) %&gt;% left_join(rank, by = c(&quot;femaleID2&quot; = &quot;femaleID&quot;)) %&gt;% rename(age2 = age) %&gt;% rename(fem1 = femaleID, fem2 = femaleID2) %&gt;% filter(fem1 %in% femaleID &amp; fem2 %in% femaleID) %&gt;% mutate(diff_age = abs(age1 - age2)) %&gt;% select(fem1, fem2, diff_age) %&gt;% replace_na(list(diff_age = 0)) %&gt;% pivot_wider(names_from = fem1, values_from = diff_age) %&gt;% datawizard::column_as_rownames(var = &quot;fem2&quot;) %&gt;% as.matrix() -&gt; age_mat rownames(age_mat) &lt;- femaleID diag(age_mat) &lt;- NA 10.1.2 GLMQAP検定 10.1.2.1 モデリング それでは、分析を行う。SRIは0~1の間をとるため、応答変数の分布には二項分布を用いた。また、説明変数にはメス同士のCSI、血縁度、順位差を用いた。 まず、説明変数に用いるマトリックスを標準化する。 diag(CSI_female) &lt;- NA CSI_female_std &lt;- (CSI_female - mean(CSI_female, na.rm = TRUE))/sd(CSI_female, na.rm = TRUE) kin_mat_std &lt;- (kin_mat - mean(kin_mat, na.rm = TRUE))/sd(kin_mat, na.rm = TRUE) rank_mat_std &lt;- (rank_mat - mean(rank_mat, na.rm = TRUE))/sd(rank_mat, na.rm = TRUE) age_mat_std &lt;- (age_mat - mean(age_mat, na.rm = TRUE))/sd(age_mat, na.rm = TRUE) 分析は以下のように実行する。 # sri_qap &lt;- glmqap(sri_mat ~ CSI_female_std + kin_mat_std + rank_mat_std, # weights = sri_denom, # family = &quot;binomial&quot;, # nperm = 10000, # permutation = &quot;DSP&quot;) # # saveRDS(sri_qap, &quot;model/sri_qap.rds&quot;) sri_qap &lt;- readRDS(&quot;model/sri_qap.rds&quot;) 10.1.2.2 結果の確認 結果は以下の通り。いずれも有意な関連は見られなかった。 sri_qap ## GLMQAP with Doube-Semi-Partialling ## ## Formula: sri_mat ~ CSI_female_std + kin_mat_std + rank_mat_std ## Family: binomial ## Weights: sri_denom ## Offset: NULL ## Permutations: 10000 ## ## Coefficients: ## Estimate Std. Error Z P(two-tailed) ## Intercept 1.411108203 0.015649464 ## CSI_female_std 0.190938115 0.031209331 6.117981737 0.183381662 ## kin_mat_std -0.002294871 0.026423152 -0.086850756 0.997900210 ## rank_mat_std 0.188720669 0.017684248 10.671681624 0.166183382 ## ## log-likelihood: -1501.172 AIC: 3010.345 BIC: 3020.961 10.1.2.3 ネットワークの確認 SRIネットワークを図示すると以下のようになる。ノードの大きさはネットワーク内における固有ベクトル中心性を表す。 set.seed(1223) diag(sri_mat) &lt;- 0 att_sri &lt;- met.eigen(sri_mat, df = rank %&gt;% mutate(rank_cat = ifelse(rank &lt;= 5, &quot;high&quot;, ifelse(rank &lt;= 10, &quot;mid&quot;, &quot;low&quot;))), dfid = 1) sri_mat %&gt;% as_tbl_graph(directed = FALSE) %&gt;% ## 個体の属性を結合 left_join(att_sri %&gt;% mutate(rank_cat = fct_relevel(rank_cat,&quot;high&quot;,&quot;mid&quot;)), by = c(&quot;name&quot; = &quot;femaleID&quot;)) %&gt;% ggraph(layout = &quot;nicely&quot;)+ geom_edge_link(start_cap = circle(0.5,&quot;cm&quot;), end_cap = circle(0.5,&quot;cm&quot;), color = &quot;grey55&quot;, aes(width = weight), alpha = 0.6)+ geom_node_point(aes(color = rank_cat, size = eigen),shape = 19)+ scale_edge_width(range = c(0.2,1.5))+ geom_node_text(aes(label = name), color = &quot;white&quot;)+ scale_size(range = c(8,12))+ theme_graph()+ scale_color_nejm()+ labs(color = &quot;rank&quot;) + guides(size = &quot;none&quot;) + theme(aspect.ratio = 0.9)+ scale_x_continuous(expand = c(0.1,0.1))+ scale_y_continuous(expand = c(0.12,0.11)) -&gt; p_sri_mat p_sri_mat # ggsave(&quot;figures/p_sri_mat.png&quot;,p_sri_mat, # width = 140, height = 100, dpi = 600, units = &quot;mm&quot;) 10.2 メス間の社会関係と同じ日に群れを離れた割合の関連 10.2.1 データの加工 まず、メス同士が群れを同じ日に出た割合を表すマトリックスを作成する。 tidyr::crossing(date = unique(female_out_final$date), femaleID1 = femaleID, femaleID2 = femaleID) %&gt;% filter(!(femaleID1 == femaleID2)) %&gt;% left_join(female_out_final %&gt;% select(date, femaleID, female_out, presence_pre), by = c(&quot;date&quot;, &quot;femaleID1&quot; = &quot;femaleID&quot;)) %&gt;% rename(out1 = female_out, presence_pre1 = presence_pre) %&gt;% left_join(female_out_final %&gt;% select(date, femaleID, female_out, presence_pre), by = c(&quot;date&quot;, &quot;femaleID2&quot; = &quot;femaleID&quot;)) %&gt;% rename(out2 = female_out, presence_pre2 = presence_pre) %&gt;% filter(presence_pre1 == 1 &amp; presence_pre2 == 1) %&gt;% mutate(co_out = ifelse(out1 == 1 &amp; out2 == 1, 1, 0), out_a = ifelse(out1 == 1 &amp; out2 == 0,1,0), out_b = ifelse(out1 == 0 &amp; out2 == 1,1,0)) %&gt;% group_by(femaleID1, femaleID2) %&gt;% summarise(sum_co_out = sum(co_out), sum_out_a = sum(out_a), sum_out_b = sum(out_b)) %&gt;% ungroup() %&gt;% mutate(denom = sum_co_out + sum_out_a + sum_out_b) %&gt;% mutate(sri = sum_co_out/denom) -&gt; female_out_sri ## 分母 out_sri_denom &lt;- female_out_sri %&gt;% select(femaleID1, femaleID2, denom) %&gt;% arrange(femaleID2) %&gt;% pivot_wider(names_from = femaleID2, values_from = denom) %&gt;% arrange(femaleID1) %&gt;% column_as_rownames(var = &quot;femaleID1&quot;) %&gt;% as.matrix() rownames(out_sri_denom) &lt;- femaleID ## sri out_sri_mat &lt;- female_out_sri %&gt;% select(femaleID1, femaleID2, sri) %&gt;% arrange(femaleID2) %&gt;% pivot_wider(names_from = femaleID2, values_from = sri) %&gt;% arrange(femaleID1) %&gt;% column_as_rownames(var = &quot;femaleID1&quot;) %&gt;% as.matrix() rownames(out_sri_mat) &lt;- femaleID 10.2.2 GLMQAP検定 10.2.2.1 モデリング それでは、分析を行う。SRIは先ほど同様に0~1の間をとるため、応答変数の分布には二項分布を用いた。また、説明変数にも先ほどと同じくメス同士のCSI、血縁度、順位差、年齢差を用いた。 分析は以下のように実行する。 # out_sri_qap &lt;- glmqap(out_sri_mat ~ CSI_female_std + kin_mat_std + rank_mat_std, # weights = out_sri_denom, # family = &quot;binomial&quot;, # nperm = 10000, # permutation = &quot;DSP&quot;) # saveRDS(out_sri_qap, &quot;model/out_sri_qap.rds&quot;) out_sri_qap &lt;- readRDS(&quot;model/out_sri_qap.rds&quot;) 10.2.2.2 結果の確認 結果は以下の通り。CSIと順位差と有意に関連していることが分かった。 out_sri_qap ## GLMQAP with Doube-Semi-Partialling ## ## Formula: out_sri_mat ~ CSI_female_std + kin_mat_std + rank_mat_std ## Family: binomial ## Weights: out_sri_denom ## Offset: NULL ## Permutations: 10000 ## ## Coefficients: ## Estimate Std. Error Z P(two-tailed) ## Intercept -2.84179882 0.13728755 ## CSI_female_std 0.38160515 0.10962314 3.48106396 0.01019898 ## kin_mat_std 0.04826786 0.15759486 0.30627815 0.74692531 ## rank_mat_std 0.37664468 0.15225615 2.47375673 0.01739826 ## ## log-likelihood: -101.3394 AIC: 210.6787 BIC: 221.2945 CSIとSRIの関連を図示すると以下のようになる。 ## モデルに基づく回帰曲線 coef &lt;- coef(out_sri_qap) fit_out_sri &lt;- tidyr::crossing(CSI = seq(0,10.2,length = 100), kin = mean(kin_mat_std, na.rm = TRUE), rank = mean(rank_mat_std, na.rm = TRUE)) %&gt;% mutate(CSI_std = (CSI - mean(CSI_female, na.rm = TRUE))/sd(CSI_female, na.rm = TRUE)) %&gt;% mutate(Estimate = inv_logit_scaled(coef[1] + coef[2]*CSI_std + coef[3]*kin + coef[4]*rank)) ## CSIマトリックスを縦型に CSI_female %&gt;% data.frame() %&gt;% rownames_as_column(var = &quot;femaleID1&quot;) %&gt;% pivot_longer(2:16, names_to = &quot;femaleID2&quot;, values_to = &quot;CSI&quot;) %&gt;% filter(!(femaleID1 == femaleID2)) %&gt;% ## 重複を削除 mutate(pair = ifelse(femaleID &gt; femaleID2, str_c(femaleID1,&quot;-&quot;,femaleID2), str_c(femaleID2,&quot;-&quot;,femaleID1))) %&gt;% distinct(pair, CSI) -&gt; CSI_female_long ## SRIマトリックスを縦型に out_sri_mat %&gt;% data.frame() %&gt;% rownames_as_column(var = &quot;femaleID1&quot;) %&gt;% pivot_longer(2:16, names_to = &quot;femaleID2&quot;, values_to = &quot;SRI&quot;) %&gt;% filter(!(femaleID1 == femaleID2)) %&gt;% mutate(pair = ifelse(femaleID &gt; femaleID2, str_c(femaleID1,&quot;-&quot;,femaleID2), str_c(femaleID2,&quot;-&quot;,femaleID1))) %&gt;% distinct(pair, SRI) %&gt;% left_join(CSI_female_long) %&gt;% ## 図示 ggplot(aes(x = CSI, y = SRI))+ geom_point(size = 2, alpha = 0.8, shape = 1)+ geom_line(data = fit_out_sri, aes(y = Estimate))+ theme_bw(base_size = 15) 順位とSRIの関連を図示すると以下のようになる。 ## モデルに基づく回帰曲線 coef &lt;- coef(out_sri_qap) fit_out_sri_b &lt;- tidyr::crossing(CSI = mean(CSI_female_std, na.rm = TRUE), kin = mean(kin_mat_std, na.rm = TRUE), rank = seq(1,14, length = 100)) %&gt;% mutate(rank_std = (rank - mean(rank_mat, na.rm = TRUE))/sd(rank_mat, na.rm = TRUE)) %&gt;% mutate(Estimate = inv_logit_scaled(coef[1] + coef[2]*CSI + coef[3]*kin + coef[4]*rank_std)) ## CSIマトリックスを縦型に rank_mat %&gt;% data.frame() %&gt;% rownames_as_column(var = &quot;femaleID1&quot;) %&gt;% pivot_longer(2:16, names_to = &quot;femaleID2&quot;, values_to = &quot;rank&quot;) %&gt;% filter(!(femaleID1 == femaleID2)) %&gt;% ## 重複を削除 mutate(pair = ifelse(femaleID &gt; femaleID2, str_c(femaleID1,&quot;-&quot;,femaleID2), str_c(femaleID2,&quot;-&quot;,femaleID1))) %&gt;% distinct(pair, rank) -&gt; rank_female_long ## SRIマトリックスを縦型に out_sri_mat %&gt;% data.frame() %&gt;% rownames_as_column(var = &quot;femaleID1&quot;) %&gt;% pivot_longer(2:16, names_to = &quot;femaleID2&quot;, values_to = &quot;SRI&quot;) %&gt;% filter(!(femaleID1 == femaleID2)) %&gt;% mutate(pair = ifelse(femaleID &gt; femaleID2, str_c(femaleID1,&quot;-&quot;,femaleID2), str_c(femaleID2,&quot;-&quot;,femaleID1))) %&gt;% distinct(pair, SRI) %&gt;% left_join(rank_female_long) %&gt;% group_by(rank) %&gt;% summarise(mean = mean(SRI)) %&gt;% ## 図示 ggplot(aes(x = rank, y = mean))+ geom_count(alpha = 0.8, shape = 1)+ geom_line(data = fit_out_sri_b, aes(y = Estimate))+ theme_bw(base_size = 15) 10.2.3 SRIマトリックスに関する分析 10.2.3.1 下位集団の検出 モジュラリティ―が最大になるように、ネットワークを複数の下位集団に分類する。 diag(out_sri_mat) &lt;- 0 graph_sri_out &lt;- graph_from_adjacency_matrix(out_sri_mat, ## 有向グラフなら &quot;directed&quot; mode= &quot;undirected&quot;, ## 重みなしなら NULL weighted = TRUE) cluster_sri_out &lt;- cluster_optimal(graph_sri_out, weights = E(graph_sri_out)$weight) 結果は以下の通り。4つの集団に分類され、モジュラリティ―は0.33になった。 cluster_sri_out ## IGRAPH clustering optimal, groups: 4, mod: 0.33 ## + groups: ## $`1` ## [1] &quot;Aka&quot; &quot;Ako&quot; &quot;Mik&quot; ## ## $`2` ## [1] &quot;Hen&quot; &quot;Hot&quot; &quot;Kil&quot; &quot;Kit&quot; &quot;Koh&quot; &quot;Mal&quot; ## ## $`3` ## [1] &quot;Kol&quot; &quot;Kun&quot; &quot;Mei&quot; &quot;Ten&quot; ## ## $`4` ## + ... omitted several groups/vertices 図示すると以下のようになる。 att_out_sri &lt;- met.eigen(out_sri_mat, df = rank, dfid = 1) set.seed(123) out_sri_mat %&gt;% as_tbl_graph(directed = FALSE) %&gt;% ## 個体の属性を結合 left_join(att_out_sri, by = c(&quot;name&quot; = &quot;femaleID&quot;)) %&gt;% mutate(member = as.factor(cluster_sri_out$membership)) %&gt;% ggraph(layout = &quot;nicely&quot;)+ geom_edge_link(start_cap = circle(0.2,&quot;cm&quot;), end_cap = circle(0.2,&quot;cm&quot;), color = &quot;grey55&quot;, aes(width = weight), alpha = 0.6)+ geom_node_point(aes(color = member, size = eigen), shape = 19)+ scale_edge_width(range = c(0.2,1.5))+ geom_node_text(aes(label = name), color = &quot;white&quot;, size = 2.5)+ # geom_mark_hull(aes(x=x,y=y,group = member), # concavity = 10)+ scale_size(range = c(5,9))+ theme_graph()+ scale_color_nejm()+ labs(color = &quot;cluster id&quot;) + guides(size = &quot;none&quot;) + theme(aspect.ratio = 0.9)+ scale_x_continuous(expand = c(0.1,0.1))+ scale_y_continuous(expand = c(0.12,0.11)) -&gt; p_out_sri_mat p_out_sri_mat # ggsave(&quot;figures/p_out_sri_mat.png&quot;,p_out_sri_mat, # width = 140, height = 100, dpi = 600, units = &quot;mm&quot;) References Dekker, D., Krackhardt, D., &amp; Snijders, T. A. B. (2007). Sensitivity of MRQAP tests to collinearity and autocorrelation conditions. Psychometrika, 72(4), 563–581. Weiss, M., &amp; Hart, J. (2023). Aninet: Statistical models for animal social networks. "],["12_female_in_analysis.html", "11 メスが群れに戻るときのメカニズム 11.1 データの加工 11.2 分析(モデリング)", " 11 メスが群れに戻るときのメカニズム 本章では、メスが群れに戻るのはどのようなときなのかに関する分析を行う。以下では、メスの毎日の確認状況のデータからメスが群れに戻る要因を探る(図11.1)。 図11.1: メスの確認状況に影響する要因 11.1 データの加工 11.1.1 オスの出入り情報 まず、オスの出入り情報について算出する。第9.3.1.4でやったように4通りの場合を考える。 TYIT_presence_pre %&gt;% mutate(TY_state4 = ifelse(TY_pre == 1 &amp; TY == 1, &quot;TY_stay&quot;, ifelse(TY_pre == 1 &amp; TY == 0, &quot;TY_out&quot;, ifelse(TY_pre == 0 &amp; TY == 1, &quot;TY_return&quot;, ifelse(TY_pre == 0 &amp; TY == 0, &quot;TY_absent&quot;, NA))))) %&gt;% mutate(TY_state4 = fct_relevel(TY_state4, &quot;TY_stay&quot;, &quot;TY_absent&quot;,&quot;TY_return&quot;)) %&gt;% mutate(IT_state4 = ifelse(IT_pre == 1 &amp; IT == 1, &quot;IT_stay&quot;, ifelse(IT_pre == 1 &amp; IT == 0, &quot;IT_out&quot;, ifelse(IT_pre == 0 &amp; IT == 0, &quot;IT_absent&quot;, ifelse(IT_pre == 0 &amp; IT == 1, &quot;IT_return&quot;, NA))))) %&gt;% mutate(IT_state4 = fct_relevel(IT_state4, &quot;IT_stay&quot;, &quot;IT_absent&quot;,&quot;IT_return&quot;)) %&gt;% mutate(TY_state = ifelse(TY_pre == 0 &amp; TY == 1, &quot;TY_return&quot;, ifelse(TY_pre == 0 &amp; TY == 0, &quot;TY_absent&quot;, ifelse(TY_pre == 1, &quot;TY_present&quot;, NA)))) %&gt;% mutate(TY_state = fct_relevel(TY_state, &quot;TY_present&quot;, &quot;TY_absent&quot;,&quot;TY_return&quot;)) %&gt;% mutate(IT_state = ifelse(IT_pre == 0 &amp; IT == 1, &quot;IT_return&quot;, ifelse(IT_pre == 0 &amp; IT == 0, &quot;IT_absent&quot;, ifelse(IT_pre == 1, &quot;IT_present&quot;, NA)))) %&gt;% mutate(IT_state = fct_relevel(IT_state, &quot;IT_present&quot;, &quot;IT_absent&quot;,&quot;IT_return&quot;)) %&gt;% mutate(TY_return = ifelse(TY_state4 == &quot;TY_return&quot;, 1, 0), IT_return = ifelse(IT_state4 == &quot;IT_return&quot;, 1, 0)) %&gt;% replace_na(list(IT_state4 = &quot;IT_absent&quot;, IT_state = &quot;IT_absent&quot;, IT_return = 0)) -&gt; male_state 11.1.2 メスが群れに戻った日の同定 続いて、各メスが群れに戻ったか否かを記したデータフレームを作成する。 ## 発情状態とアカンボウの有無を結合 female_pre_long %&gt;% mutate(date_pre = date - 1) %&gt;% left_join(female_pre_long %&gt;% select(date, femaleID, presence) %&gt;% rename(presence_pre = presence), by = c(&quot;date_pre&quot; = &quot;date&quot;, &quot;femaleID&quot;)) %&gt;% mutate(female_in = ifelse(is.na(presence_pre), NA, ifelse(presence_pre == 0 &amp; presence == 1,1,0))) %&gt;% ## 前日にメスがいない日のみを抽出 filter(presence_pre == 0) %&gt;% ## オスの出入りがある期間のみを抽出 filter(study_period %in% c(&quot;m19&quot;, &quot;m20&quot;, &quot;m21&quot;, &quot;nm20&quot;, &quot;nm21&quot;)) %&gt;% left_join(female_all %&gt;% select(date,femaleID, rs2), by = c(&quot;date&quot;,&quot;femaleID&quot;)) -&gt; female_in 11.1.3 血縁個体が群れに戻ったか否か 続いて、各観察日に血縁個体が群れに戻ったか否かを算出する。 kin &lt;- read_csv(&quot;../Data/data/others/kin.csv&quot;) female_in %&gt;% select(groupID, date, study_period, femaleID, female_in, presence_pre) %&gt;% ## 他のメスのデータを結合 left_join(att %&gt;% filter(age &gt;= 6) %&gt;% select(study_period, femaleID) %&gt;% rename(femaleID2 = femaleID), by = &quot;study_period&quot;) %&gt;% filter(femaleID != femaleID2) %&gt;% ## 他のメスが群れを離れたか否かの列を作成 left_join(female_in %&gt;% select(groupID, date, femaleID, female_in) %&gt;% rename(female_in2 = female_in, femaleID2 = femaleID), by = c(&quot;groupID&quot;,&quot;date&quot;, &quot;femaleID2&quot;)) %&gt;% replace_na(list(female_in2 = 0)) %&gt;% ## 相手のメスとの血縁度を結合 left_join(kin, by = c(&quot;femaleID&quot;, &quot;femaleID2&quot;)) %&gt;% filter(female_in2 == 1) %&gt;% ## それぞれの日で離れたメスの最大の血縁度を算出 group_by(groupID, date, femaleID) %&gt;% summarise(max_kin = max(kin), ## 血縁カテゴリーも作成する kin_cat = as.character(max(kin))) %&gt;% mutate(kin_01 = ifelse(max_kin &gt; 0, 1,0)) -&gt; kin_female_in 11.1.4 全データの結合 最後に、全データを結合する。 female_in %&gt;% left_join(no_female_over0.5 %&gt;% select(date, prop_female) %&gt;% rename(date_pre = date), by = c(&quot;date_pre&quot;)) %&gt;% left_join(male_state %&gt;% select(date, groupID, TY_state4, IT_state4, TY_state, IT_state, TY_return, IT_return), by = c(&quot;date&quot;, &quot;groupID&quot;)) %&gt;% left_join(CSI_TY %&gt;% rename(femaleID = subject) %&gt;% select(femaleID, CSI_TY), by = &quot;femaleID&quot;) %&gt;% left_join(CSI_IT %&gt;% rename(femaleID = subject) %&gt;% select(femaleID, CSI_IT), by = &quot;femaleID&quot;) %&gt;% left_join(no_female_over0.5_b %&gt;% select(date, TY, IT) %&gt;% mutate(date = date + 1) %&gt;% rename(TY_pre = TY, IT_pre = IT)) %&gt;% left_join(kin_female_in, by = c(&quot;groupID&quot;,&quot;date&quot;, &quot;femaleID&quot;)) %&gt;% left_join(sum_ntm, by = c(&quot;date_pre&quot; = &quot;date&quot;)) %&gt;% left_join(agg_rate_all %&gt;% select(date, rate_agg_all) %&gt;% mutate(date = date + 1) %&gt;% rename(rate_agg_all_pre = rate_agg_all), by = c(&quot;date&quot;)) %&gt;% replace_na(list(max_kin = 0, kin_cat = &quot;no&quot;)) %&gt;% mutate(kin_01 = ifelse(max_kin &gt; 0, 1,0)) %&gt;% mutate(kin_cat = as.factor(kin_cat)) %&gt;% group_by(study_period) %&gt;% ## 相対順位を算出 mutate(max_rank = max(rank)) %&gt;% ungroup() %&gt;% mutate(rank_scaled = rank/max_rank) -&gt; female_in_final 11.2 分析(モデリング) 以下では、交尾期と非交尾期に分けて分析を行う。分析に含まれるのは、6歳以上でかつTY、ITとのCSIが算出できる個体(= 2019年時点で6歳以上の個体)である。 11.2.1 交尾期 11.2.1.1 データの加工 まず、データの加工を行う。データ数が少ないのと、区別が難しいので発情/非発情は分けない。 female_in_m &lt;- female_in_final %&gt;% filter(!str_detect(study_period, &quot;nm&quot;)) %&gt;% drop_na(CSI_TY) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), ntm_std = standardize(no_ntm), prop_std = standardize(prop_female), rank_std = standardize(rank_scaled), age_std = standardize(age), rate_agg_all_std = standardize(rate_agg_all_pre)) %&gt;% mutate(N = 1:n()) 11.2.1.2 モデリング1 まず、TYとITが群れに戻ったか否かという2水準の変数を用いてモデリングを行う。モデルの詳細は以下のとおりである。なお、連続変数はすべて標準化している。 応答変数: メスが群れに戻ったか否か(\\(female_in\\)) 説明変数: TYが群れに戻ったか(\\(TY_return\\))、TYとの親密度(\\(CSI_TY\\))、これらの交互作用、ITが群れに戻ったか(\\(IT_return\\))、ITとの親密度(\\(CSI_IT\\))、これらの交互作用、年齢(\\(age_std\\))、順位\\(rank_std\\)、前日の確認メス割合\\(prop_std\\)、前日の群れ外オス数\\(ntm_std\\)、前日のオスの攻撃頻度(\\(rate_agg_std\\)) ランダム切片: メスID(\\(femaleID\\))、日付(\\(date\\)) モデルは以下のように実行する。 ### ITとCSIの交互作用はVIFが高いので除く m_female_in_m &lt;- brm(data = female_in_m %&gt;% mutate(date = as.factor(date)), female_in ~ TY_return*CSI_TY_std + IT_return*CSI_IT_std + kin_01 + rank_std + age_std + ntm_std + prop_std + rate_agg_all_std + study_period + (1|femaleID) + (1|date) + (1|N), family = &quot;bernoulli&quot;, prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd)), iter = 11000, warmup = 1000, seed = 112, control=list(adapt_delta = 0.999, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_in_m&quot;) ## 2021年を除く female_in_m_bf21 &lt;- female_in_m %&gt;% filter(study_period != &quot;m21&quot;) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), ntm_std = standardize(no_ntm), prop_std = standardize(prop_female), rank_std = standardize(rank_scaled), age_std = standardize(age), rate_agg_all_std = standardize(rate_agg_all_pre)) ## TYの動向とCSIの交互作用はVIFが高いので除外 m_female_in_m_bf21 &lt;- brm(data = female_in_m_bf21 %&gt;% mutate(date = as.factor(date)), female_in ~ TY_return*CSI_TY_std + IT_return*CSI_IT_std + kin_01 + rank_std + age_std + ntm_std + prop_std + rate_agg_all_std + study_period + (1|femaleID) + (1|date) + (1|N), family = &quot;bernoulli&quot;, prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd)), iter = 11000, warmup = 1000, seed = 124, control=list(adapt_delta = 0.999, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/m_female_in_m_bf21&quot;) 11.2.1.2.1 モデルチェック まず、DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。特に問題はないよう。 ## 全個体への攻撃 dh_female_in_m &lt;- dh_check_brms(m_female_in_m, quantreg = TRUE) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## 全個体への攻撃 pp_check(m_female_in_m, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) 多重共線性のチェックもお個あったが、VIFに問題はない。 check_collinearity(m_female_in_m) 最後に残差の時系列相関のチェックを行う。残差の自己相関をプロットすると、明確なパターンは見られなかった。また、Ljung-Box検定で3時点前までの残差との自己相関を検定したところ、有意な自己相関を示したのはNreだけだった。 res_female_in_m &lt;- female_in_m %&gt;% mutate(resid = dh_female_in_m$scaledResiduals) %&gt;% mutate(date = as_date(date)) %&gt;% group_by(femaleID) %&gt;% complete(date = seq.Date(min(date), max(date), by = &quot;1 day&quot;)) %&gt;% ungroup() females &lt;- unique(female_in_m$femaleID) acf_female_in_m &lt;- NULL for(i in seq_along(females)){ data &lt;- res_female_in_m %&gt;% filter(femaleID == females[i]) out.acf &lt;- acf(data$resid, lag.max = 5, na.action = na.pass, plot = F) box_test &lt;- Box.test(data$resid, type = &quot;Ljung-Box&quot;, lag = 3) out.df &lt;- data.frame(Timelag = out.acf$lag, Acf = out.acf$acf, femaleID = females[i], p = box_test$p.value) acf_female_in_m &lt;- bind_rows(acf_female_in_m, out.df) } acf_female_in_m %&gt;% mutate(p = str_c(&quot;p = &quot;,round(p,2))) %&gt;% ggplot(aes(x = Timelag, y = 0))+ geom_segment(aes(xend = Timelag, yend = Acf))+ geom_text(aes(x = 4, y = 0.8, label = p), size = 3.5, family = &quot;Arial&quot;)+ theme_bw()+ theme(aspect.ratio = 1)+ facet_rep_wrap(~femaleID, repeat.tick.labels = TRUE) 11.2.1.2.2 結果の確認 結果は以下の通り。 .cl-4ed48b14{table-layout:auto;width:100%;}.cl-4ecbacf6{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4ecbad00{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4ecbad01{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4ecbad0a{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4ecebb62{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4ecebb6c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4eced3fe{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced3ff{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced408{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced412{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced413{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced414{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced415{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced416{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced41c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced41d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced41e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced41f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced420{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced421{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced426{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced427{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced428{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced429{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced430{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced431{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced432{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced43a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced43b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced43c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced43d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced444{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced445{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced446{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced447{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced44e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced44f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced458{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced459{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced45a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced45b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced462{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced463{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced464{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced465{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4eced46c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-15.91[-30.52,-5.80]1.0015,269.41TYが戻ったか(vs 否)3.93[-9.62,18.80]1.0040,937.28TYとの親密度(CSI)-2.37[-7.87,2.45]1.0025,322.45TYが戻ったか(vs 否) ×TYとの親密度12.46[1.05,28.90]1.0028,057.80ITが戻ったか(vs 否)13.52[-1.63,34.16]1.0029,323.65ITとの親密度(CSI)-4.94[-11.26,0.77]1.0018,680.27ITが戻ったか(vs 否) ×ITとの親密度-2.46[-17.12,9.78]1.0040,838.21前日のオスからの攻撃頻度-0.80[-7.34,5.52]1.0026,044.72前日の群れ外オス数-0.68[-6.31,4.90]1.0023,545.89血縁のメスが群れに戻ったか(vs 否)15.13[6.32,29.42]1.0014,562.27順位-4.29[-9.14,-0.21]1.0018,718.17年齢-4.61[-10.60,-0.12]1.0022,673.85前日確認したメスの割合6.95[2.06,14.37]1.0017,194.10調査期間(m20 vs m19)-5.85[-18.82,5.50]1.0028,486.60調査期間(m21 vs m19)1.91[-8.44,13.14]1.0028,571.84 11.2.1.2.3 結果の図示 11.2.1.2.3.1 TYの動向・ CSIとメスに戻る確率の関連 まずは、estimate_contrasts関数を用いて、TYとのCSIに応じてオッズ比の対数をとったものがどのように変わるかを図示する。TYと親密度が高いメスは同じ日に群れに戻る確率が高いことが分かる。 cont_female_in_m &lt;- estimate_contrasts(m_female_in_m, contrast = &quot;TY_return = c(0,1)&quot;, at = &quot;CSI_TY_std&quot;, length = 50) cont_female_in_m %&gt;% rename(Level1 = Level2, Level2 = Level1) %&gt;% mutate(Difference = -Difference) %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(female_in_m$CSI_TY)*CSI_TY + mean(female_in_m$CSI_TY)) %&gt;% ggplot(aes(x = CSI_TY, y = Difference)) + geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ geom_line()+ geom_ribbon(aes(ymin = -CI_low, ymax = -CI_high), alpha = 0.2)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;TY&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,0.5))+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(hjust = 0))+ scale_y_continuous(breaks = seq(-40,100,10)) -&gt; p_female_in_m_TYcsi p_female_in_m_TYcsi # ggsave(&quot;figures/p_female_in_m_TYcsi.png&quot;, # p_female_in_m_TYcsi, dpi = 900, units = &quot;mm&quot;, # width = 100, height = 100) 11.2.1.2.3.2 ITの動向・ CSIとメスに戻る確率の関連 続いて、2021年までのデータを用いたモデルをもとに、ITとのCSIに応じてオッズ比の対数をとったものがどのように変わるかを図示する。TYと親密度が高いメスは同じ日に群れに戻る確率が高いことが分かる。 cont_female_in_m_IT &lt;- estimate_contrasts(m_female_in_m_bf21, contrast = &quot;IT_return = c(0,1)&quot;, at = &quot;CSI_IT_std&quot;, length = 50) cont_female_in_m_IT %&gt;% rename(Level1 = Level2, Level2 = Level1) %&gt;% mutate(Difference = -Difference) %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(female_in_m_bf21$CSI_IT)*CSI_IT + mean(female_in_m_bf21$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference)) + geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ geom_line()+ geom_ribbon(aes(ymin = -CI_low, ymax = -CI_high), alpha = 0.2)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = &quot;Log odds ratio&quot;, x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,0.5))+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;, size = 12), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(hjust = 0))+ scale_y_continuous(breaks = seq(-40,100,10)) -&gt; p_female_in_m_ITcsi p_female_in_m_ITcsi # ggsave(&quot;figures/p_female_in_m_ITcsi.png&quot;, # p_female_in_m_ITcsi, dpi = 900, units = &quot;mm&quot;, # width = 100, height = 100) 11.2.1.2.3.3 メス同士の血縁度との関連 female_in_m %&gt;% mutate(kin_01 = as.factor(kin_01)) %&gt;% group_by(kin_01, femaleID) %&gt;% summarise(prop = mean(female_in), n = n()) %&gt;% ungroup() %&gt;% filter(n &gt;= 3) %&gt;% ggplot(aes(x = kin_01, y = prop))+ geom_count(alpha = 0.5)+ geom_line(aes(group = femaleID))+ scale_size(range = c(2,8))+ theme_bw(base_size = 13)+ labs(x = &quot;If kin females returned the group&quot;, y = &quot;Probability of female returning main group&quot;, color = &quot;Study period&quot;, fill = &quot;Study period&quot;)+ coord_cartesian(xlim = c(1.2,1.7), ylim = c(0,1.15))+ scale_x_discrete(labels = c(&quot;No&quot;, &quot;Yes&quot;)) + theme(axis.title.y = element_text(family = &quot;YArial&quot;, size = 12), axis.title.x = element_text(family = &quot;Arial&quot;, size =12), axis.text = element_text(family = &quot;Arial&quot;, size = 12), legend.title = element_text(family = &quot;Arial&quot;), legend.text = element_text(family = &quot;Arial&quot;), aspect.ratio = 0.9) + geom_signif(xmin = 1, xmax = 2, y_position = 1.1, annotation = &quot;***&quot;, vjust = 0.01, textsize = 5) -&gt; p_female_in_kin p_female_in_kin # ggsave(&quot;figures/p_female_in_kin.png&quot;,p_female_in_kin, dpi = 600, units = &quot;mm&quot;, # width = 120, height = 100) References Gabry, J., &amp; Mahr, T. (2022). Bayesplot: Plotting for bayesian models. https://mc-stan.org/bayesplot Hartig, F. (2022). DHARMa: Residual diagnostics for hierarchical (multi-level / mixed) regression models. https://CRAN.R-project.org/package=DHARMa Rodríguez-Sánchez, F. (2023). DHARMa.helpers: Helper functions to check models not (yet) directly supported by DHARMa. "],["13_male_presence_aggression.html", "12 TY、ITの有無とオスからの被攻撃頻度 12.1 データの加工 12.2 分析", " 12 TY、ITの有無とオスからの被攻撃頻度 第9章の結果から、メスたちはTYやITが群れにいない日や、TYが群れから離れたのと同じ日に群れを離れやすい傾向があることが分かった。 Yamaguchi &amp; Kazahari (2022) が正しければ、これはTYやITがメスにとって他のオスからの「用心棒」となっているため、オスの攻撃を回避するために彼らの動きに応じてメスたちが動いた結果だと考えられる。 本章では、実際に彼らが群れにいなかった日にはメスが受ける攻撃は増加したのかを検討する。 12.1 データの加工 12.1.1 各観察日の被攻撃頻度 まず各観察日におけるそれぞれのメスの被攻撃頻度とそれぞれのメスの発情の有無を算出する。なお、分析には群れ本体を観察し、240分以上観察できた日のみを用いる。 ## 日ごとの被攻撃頻度の算出 agg_daily_each &lt;- no_female_over0.5 %&gt;% select(groupID, prop_female, dur) %&gt;% left_join(group_all %&gt;% select(-c(TY,IT,KR,LK,KM,TG))) %&gt;% select(-(start:fin)) %&gt;% ## 縦型にする pivot_longer(Kur:Yun, names_to = &quot;femaleID&quot;, values_to = &quot;presence&quot;) %&gt;% left_join(att, by = c(&quot;study_period&quot;, &quot;femaleID&quot;)) %&gt;% filter(age &gt;= 6) %&gt;% filter(presence == 1) %&gt;% filter(study_period != &quot;m18&quot; &amp; !str_detect(study_period, &quot;nm&quot;)) %&gt;% ## 攻撃頻度を結合 left_join(agg_rate_each %&gt;% select(groupID, femaleID, rate_agg, no_agg), by = c(&quot;groupID&quot;, &quot;femaleID&quot;)) %&gt;% left_join(female_all %&gt;% select(date, femaleID, rs2), by = c(&quot;date&quot;,&quot;femaleID&quot;)) %&gt;% ## 発情の記録がない2019/9/27は除外 filter(!is.na(rs2)) %&gt;% ## 攻撃が一度もない日の値を補完 replace_na(list(rate_agg = 0, no_agg = 0)) 12.1.2 TYとITの確認状況 続いて、これらにTYとITの確認状況や発情メス数、確認した合計オス数のデータを結合する。TYやITが群れにいるか否かの効果を見たいため、彼らが少なくとも3時間以上確認できた日と、一度も確認できなかった日を比較する。 まず、TYとITが3時間以上確認できたか否かについて算出する。 male_time_19m_3h &lt;- read_excel(&quot;../Data/data/2019mating/2019mating_raw.xlsx&quot;, sheet = &quot;male_presence_long&quot;) %&gt;% mutate(study_period = &quot;m19&quot;) %&gt;% mutate(groupID = str_c(study_period,&quot;_&quot;, groupID)) %&gt;% ## 確認時間の算出 mutate(dur = ifelse(is.na(first), 0, difftime(last, first, units = &quot;mins&quot;))) %&gt;% ## 180以上は1, 1~179分は2, 0分は0とした。 mutate(presence_3h = ifelse(dur &gt;= 180,1, ifelse(0 &lt; dur &amp; dur &lt; 180, 2, 0))) %&gt;% select(maleID, date, groupID, presence_3h) %&gt;% pivot_wider(names_from = maleID, values_from = presence_3h) male_time_20m_3h &lt;- read_excel(&quot;../Data/data/2020mating/2020mating_raw.xlsx&quot;, sheet = &quot;male_presence_long&quot;) %&gt;% mutate(study_period = &quot;m20&quot;) %&gt;% mutate(groupID = str_c(study_period,&quot;_&quot;, groupID)) %&gt;% ## 確認時間の算出 mutate(dur = ifelse(is.na(first), 0, difftime(last, first, units = &quot;mins&quot;))) %&gt;% mutate(presence_3h = ifelse(dur &gt;= 180,1, ifelse(0 &lt; dur &amp; dur &lt; 180, 2, 0))) %&gt;% select(maleID, date, groupID, presence_3h) %&gt;% pivot_wider(names_from = maleID, values_from = presence_3h) male_time_21m_3h &lt;- read_excel(&quot;../Data/data/2021mating/2021mating_raw.xlsx&quot;, sheet = &quot;male_presence_long&quot;) %&gt;% mutate(study_period = &quot;m21&quot;) %&gt;% mutate(groupID = str_c(study_period,&quot;_&quot;, groupID)) %&gt;% ## 確認時間の算出 mutate(dur = ifelse(is.na(first), 0, difftime(last, first, units = &quot;mins&quot;))) %&gt;% mutate(presence_3h = ifelse(dur &gt;= 180,1, ifelse(0 &lt; dur &amp; dur &lt; 180, 2, 0))) %&gt;% select(maleID, date, groupID, presence_3h) %&gt;% pivot_wider(names_from = maleID, values_from = presence_3h) male_time_3h &lt;- bind_rows(male_time_19m_3h, male_time_20m_3h, male_time_21m_3h) %&gt;% replace_na(list(IT = 0)) 12.1.3 確認オス数と発情メス数 まず、各観察日の確認オス数を算出する。 no_ntm_m19 &lt;- male_19m %&gt;% filter(!(maleID %in% c(&quot;TY&quot;, &quot;IT&quot;, &quot;KR&quot;, &quot;LK&quot;))) %&gt;% group_by(date) %&gt;% summarise(no_ntm = sum(presence, na.rm = TRUE)) no_ntm_m20 &lt;- male_20m %&gt;% filter(!(maleID %in% c(&quot;TY&quot;, &quot;IT&quot;, &quot;KR&quot;, &quot;LK&quot;, &quot;KM&quot;, &quot;TG&quot;))) %&gt;% group_by(date) %&gt;% summarise(no_ntm = sum(presence, na.rm = TRUE)) no_ntm_m21 &lt;- male_21m %&gt;% filter(!(maleID %in% c(&quot;TY&quot;, &quot;IT&quot;, &quot;KR&quot;, &quot;LK&quot;, &quot;KM&quot;, &quot;TG&quot;))) %&gt;% group_by(date) %&gt;% summarise(no_ntm = sum(presence, na.rm = TRUE)) no_ntm &lt;- bind_rows(no_ntm_m19, no_ntm_m20, no_ntm_m21) no_male &lt;- no_female_over0.5 %&gt;% filter(study_period != &quot;m18&quot; &amp; !str_detect(study_period, &quot;nm&quot;)) %&gt;% select(groupID, prop_female, dur) %&gt;% left_join(group_all %&gt;% select(-c(Kur:Kun,Mif:Har,Cur:Yun))) %&gt;% select(-(start:fin)) %&gt;% rowwise() %&gt;% mutate(no_tm = sum(TY,IT,LK,KR,KM,TG, na.rm = TRUE)) %&gt;% ungroup() %&gt;% left_join(no_ntm, by = &quot;date&quot;) %&gt;% mutate(no_male = no_ntm + no_tm) %&gt;% select(date, groupID, no_male) 続いて、各観察日の発情メス数を算出する。 no_est &lt;- agg_daily_each %&gt;% group_by(date, groupID) %&gt;% summarise(no_est = sum(rs2)) 12.1.4 個体追跡状況 各メスが各観察日に個体追跡された時間と、一日の追跡時間に占める割合を算出する。 focal_combined %&gt;% group_by(no_focal, date, subject) %&gt;% summarise(dur_focal = max(time)) %&gt;% mutate(date = as_date(date)) %&gt;% rename(femaleID = subject) %&gt;% ungroup() %&gt;% group_by(date, femaleID) %&gt;% summarise(dur_focal = sum(dur_focal)) %&gt;% ungroup() -&gt; focal_summary 12.1.5 データの結合 最後に、上記のデータを全て結合する。 agg_daily_all &lt;- agg_daily_each %&gt;% left_join(male_time_3h, by = c(&quot;date&quot;, &quot;groupID&quot;)) %&gt;% left_join(no_male, by = c(&quot;date&quot;, &quot;groupID&quot;)) %&gt;% left_join(no_est, by = c(&quot;date&quot;, &quot;groupID&quot;)) %&gt;% left_join(CSI_TY %&gt;% rename(femaleID = subject) %&gt;% select(femaleID, CSI_TY), by = &quot;femaleID&quot;) %&gt;% left_join(CSI_IT %&gt;% rename(femaleID = subject) %&gt;% select(femaleID, CSI_IT), by = &quot;femaleID&quot;) %&gt;% left_join(focal_summary, by = c(&quot;femaleID&quot;, &quot;date&quot;)) %&gt;% replace_na(list(dur_focal = 0)) %&gt;% mutate(prop_focal = dur_focal/dur) %&gt;% group_by(study_period) %&gt;% mutate(rank_scaled = rank/max(rank)) %&gt;% ungroup() 12.2 分析 12.2.1 発情と非発情を分けない 12.2.1.1 全期間 + TY/ITの有無 まず、全期間のデータを用いて分析を行う。 12.2.1.1.1 データの加工 TYとITが3時間以上確認されたか、一度も確認されていない日だけを抽出する。 agg_daily_all_b &lt;- agg_daily_all %&gt;% filter(TY != 2) %&gt;% mutate(logdur = log(dur/60)) %&gt;% mutate(date = as.factor(date)) %&gt;% drop_na(CSI_TY) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), est_std = standardize(no_est), male_std = standardize(no_male), rank_std = standardize(rank_scaled), age_std = standardize(age), prop_std = standardize(prop_female), focal_std = standardize(prop_focal)) agg_daily_all_b2 &lt;- agg_daily_all %&gt;% filter(TY != 2 &amp; IT != 2) %&gt;% mutate(logdur = log(dur/60)) %&gt;% mutate(date = as.factor(date)) %&gt;% drop_na(CSI_TY) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), est_std = standardize(no_est), male_std = standardize(no_male), rank_std = standardize(rank_scaled), age_std = standardize(age), prop_std = standardize(prop_female), focal_std = standardize(prop_focal)) 12.2.1.1.2 モデリング モデルの概要は以下の通り。データは各観察日におけるそれぞれのメスのデータである。 応答変数: オスからの被攻撃回数 説明変数: 発情の有無、TYの有無、TYとのCSI、発情の有無×TYの有無、TYとのCSI×TYの有無、発情メス数、確認オス数、確認メス割合、調査期間、年齢、順位 オフセット項: 群れの追跡時間 分布: 負の二項分布 リンク関数: log関数 事前分布: 弱情報分布 ## TYの有無だけを含むモデル m_agg_TYIT &lt;- brm(no_agg ~ TY*rs2 + TY*CSI_TY_std + est_std + male_std + rank_std + age_std + prop_std + focal_std + study_period + offset(logdur) + (1|femaleID) + (1|date), family = negbinomial, iter = 11000, warmup = 1000, seed = 134, prior = c(prior(student_t(4,0,5), class = &quot;b&quot;), prior(student_t(4,0,10), class = &quot;Intercept&quot;), prior(student_t(4,0,10), class = &quot;sd&quot;), prior(gamma(0.01,0.01), class = &quot;shape&quot;)), control=list(adapt_delta = 0.99, max_treedepth = 20), backend = &quot;cmdstanr&quot;, data = agg_daily_all_b, file = &quot;model/m_agg_TYIT.rds&quot;) ## ITの有無も含める m_agg_TYIT2 &lt;- brm(no_agg ~ TY*rs2 + TY*CSI_TY_std + IT*rs2 + IT*CSI_IT_std + est_std + male_std + rank_std + prop_std + focal_std + age_std + study_period + offset(logdur) + (1|femaleID) + (1|date), family = negbinomial, iter = 11000, warmup = 1000, seed = 134, prior = c(prior(student_t(4,0,5), class = &quot;b&quot;), prior(student_t(4,0,10), class = &quot;Intercept&quot;), prior(student_t(4,0,10), class = &quot;sd&quot;), prior(gamma(0.01,0.01), class = &quot;shape&quot;)), control=list(adapt_delta = 0.99, max_treedepth = 20), backend = &quot;cmdstanr&quot;, data = agg_daily_all_b2, file = &quot;model/m_agg_TYIT2.rds&quot;) 12.2.1.1.2.1 モデルのチェック DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。特に問題はないよう。 ## 全個体への攻撃 dh_check_brms(m_agg_TYIT2, quantreg = TRUE) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## 全個体への攻撃 pp_check(m_agg_TYIT2, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) 多重共線性のチェックも行ったが、VIFに問題はない。 check_collinearity(m_agg_TYIT2) Rhatにも問題はなく、収束の問題はないよう。 ## 全個体への攻撃 data.frame(Rhat = brms::rhat(m_agg_TYIT2)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) -&gt; p_rhat_agg_TYIT p_rhat_agg_TYIT 12.2.1.1.2.2 結果の確認 結果は以下の通り。太字になっている変数は95%確信区間が0をまたいでおらず、有意な影響があるといえる。 .cl-88cf60d2{table-layout:auto;width:90%;}.cl-88c7d218{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88c7d222{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88c7d223{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88c7d22c{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88ca4fa2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-88ca4fac{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-88ca5ec0{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5ec1{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5eca{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5ed4{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5ed5{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5ede{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5edf{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5ee0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5ee1{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5ee8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5ee9{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5eea{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5ef2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5ef3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5ef4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5efc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5efd{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f06{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f07{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f08{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f09{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f0a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f10{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f11{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f12{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f1a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f1b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f24{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f25{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f26{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f2e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f2f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f30{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f38{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f39{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f3a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f3b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f42{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f43{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f4c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f4d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f4e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f4f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f56{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f57{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f58{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f60{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f61{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f62{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ca5f63{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-2.37[-2.67,-2.07]1.0013,049.34TYの在否 (在 vs 否)-0.56[-0.86,-0.28]1.0018,705.25ITの在否 (在 vs 否)-1.13[-1.54,-0.74]1.0016,758.41TYとの親密度(CSI)0.06[-0.14,0.24]1.0016,740.92ITとの親密度(CSI)0.01[-0.13,0.16]1.0017,111.29メスの発情 (有 vs 無)0.92[0.71,1.13]1.0029,953.79TYの在否 ×TYとの親密度(CSI)-0.08[-0.21,0.05]1.0044,792.71TYの在否 ×メスの発情の有無0.01[-0.33,0.36]1.0029,856.03ITの在否 ×ITとの親密度(CSI)-0.01[-0.20,0.17]1.0046,503.23ITの在否 ×メスの発情の有無0.75[0.07,1.41]1.0039,039.40確認オス数0.28[0.12,0.45]1.0016,405.73発情メス数0.41[0.27,0.55]1.0018,099.20確認メス割合-0.19[-0.30,-0.06]1.0012,373.85個体追跡時間割合0.28[0.22,0.34]1.0039,191.01順位-0.18[-0.38,-0.01]1.0015,457.58年齢-0.09[-0.24,0.05]1.0016,631.72調査期間(m20 vs m19)-1.56[-1.90,-1.22]1.0016,928.78調査期間(m21 vs m19)-1.82[-2.18,-1.48]1.0013,031.85 続いて、交互作用がある変数について検討する。 TYとのCSIと発情状態によってTYの有無による被攻撃頻度の違いがどのように変わるかを示したのが以下である。Differenceはoffsetが\\(log(1) = 0\\)のとき、すなわち1時間当たりの被攻撃頻度の比(\\(\\frac{\\mu_{TY = 0}}{\\mu_{TY=1}}\\))を表している2。 いずれの場合でもDifferenceは1より大きく、95%確信区間も全ての期間において1をまたがないので、CSIや発情状態に関わらずTYがいない日はTYがいる日よりも攻撃を受ける頻度が低くなる。 estimate_contrasts(m_agg_TYIT2, contrast = &quot;TY = c(0,1)&quot;, at = c(&quot;CSI_TY_std = seq(-1,1.5, 0.2)&quot;, &quot;rs2 = c(0,1)&quot;), transform = &quot;none&quot;, offset = log(1)) %&gt;% data.frame() %&gt;% select(-.offset.) %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(agg_daily_all_b2$CSI_TY)*CSI_TY + mean(agg_daily_all_b2$CSI_TY)) %&gt;% select(1:7) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) ITについては、非発情メスではそのような傾向。 estimate_contrasts(m_agg_TYIT2, contrast = &quot;IT = c(0,1)&quot;, at = c(&quot;CSI_IT_std = seq(-0.67,3.5, 0.2)&quot;, &quot;rs2 = c(0,1)&quot;), transform = &quot;none&quot;, offset = log(1)) %&gt;% data.frame() %&gt;% select(-.offset.) %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(agg_daily_all_b2$CSI_IT)*CSI_IT + mean(agg_daily_all_b2$CSI_IT)) %&gt;% select(1:7) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 12.2.1.1.2.3 結果の図示 交互作用項の結果について図示する。 まずはTYについて図示する。結果は以下の通り。発情メス、非発情メスいずれについてもTYがいない日にはCSIに関わらずオスからの攻撃頻度が有意に多くなった。 # cont_agg_TY &lt;- estimate_contrasts(m_agg_TYIT2, # contrast = &quot;TY = c(0,1)&quot;, # at = c(&quot;CSI_TY_std&quot;, # &quot;rs2 = c(0,1)&quot;), # transform = &quot;response&quot;, # offset = log(1), # length = 50) # # saveRDS(cont_agg_TY, &quot;model/cont_agg_TY.rds&quot;) cont_agg_TY &lt;- readRDS(&quot;model/cont_agg_TY.rds&quot;) cont_agg_TY %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(agg_daily_all_b2$CSI_TY)*CSI_TY + mean(agg_daily_all_b2$CSI_TY)) %&gt;% ggplot(aes(x = CSI_TY, y = Difference))+ geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 1), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = expression(frac(mu[TY不在],mu[TY在])), x = expression(paste(&quot;CSI with &quot;,italic(&quot;TY&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,1))+ scale_y_continuous(breaks = seq(1,7,1))+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;, angle = 0, vjust = 0.5, hjust = -0.5), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0))+ facet_rep_wrap(~rs2, repeat.tick.labels = TRUE, labeller = as_labeller(c(`1` = &quot;発情メス&quot;, `0` = &quot;非発情メス&quot;))) -&gt; p_cont_agg_TY p_cont_agg_TY # ggsave(&quot;figures/p_cont_agg_TY.png&quot;,p_cont_agg_TY, dpi = 600, units = &quot;mm&quot;, # width = 200, height = 100) 実データとmarginal meanを共に図示する。なお、3日以上観察できた個体のデータのみを用いて図示した。 emm_agg_TY &lt;- estimate_means(m_agg_TYIT2, at = c(&quot;TY = c(0,1)&quot;, &quot;rs2 = c(0,1)&quot;), offset = 0) %&gt;% data.frame() %&gt;% mutate(TY = as.factor(TY)) df_signif &lt;- tidyr::crossing(rs2 = c(0,1)) %&gt;% mutate(start = &quot;0&quot;, end = &quot;1&quot;, y = c(0.082, 0.85), label = &quot;***&quot;) agg_daily_all_b2 %&gt;% group_by(femaleID, TY, rs2) %&gt;% summarise(mean = mean(rate_agg), n = n()) %&gt;% ungroup() %&gt;% filter(n &gt;= 5) %&gt;% mutate(TY = as.factor(TY)) %&gt;% ggplot(aes(x = TY, y = mean))+ geom_line(aes(group = femaleID), alpha = 0.7)+ geom_point(alpha = 0.7)+ coord_cartesian(xlim = c(1.3,1.7))+ # geom_errorbar(data = emm_agg_TY, # aes(y = Mean, # ymin = CI_low, # ymax = CI_high), # width = 0.15, # color = &quot;red3&quot;, # alpha = 0.3)+ # geom_pointrange(data = emm_agg_TY, # aes(y = Mean, # ymin = CI_low, # ymax = CI_high), # color = &quot;red3&quot;, # size = 0.7, # linewidth = 1, # alpha = 0.3)+ theme_bw(base_size = 16)+ scale_x_discrete(labels = c(expression(paste(italic(&quot;TY&quot;), &quot;absent&quot;)), expression(paste(italic(&quot;TY&quot;), &quot;present&quot;))))+ labs(x = &quot;&quot;, y = &quot;Rate of aggression (times/h)&quot;)+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), strip.background = element_blank(), strip.text = element_text(hjust = 0, family = &quot;Yu Gothic&quot;), aspect.ratio = 1)+ facet_rep_wrap(~rs2, scales = &quot;free&quot;, labeller = as_labeller(c(`0` = &quot;非発情メス&quot;, `1` = &quot;発情メス&quot;))) -&gt; p_agg_TY_raw p_agg_TY_raw # ggsave(&quot;figures/p_agg_TY_raw.png&quot;,p_agg_TY_raw, dpi = 600, units = &quot;mm&quot;, # width = 200, height = 100) 続いて、ITについて図示する。結果は以下の通り。非発情メスのみついては、ITがいない日にはCSIに関わらずオスからの攻撃頻度が有意に多くなった。 # cont_agg_IT &lt;- estimate_contrasts(m_agg_TYIT2, # contrast = &quot;IT = c(0,1)&quot;, # at = c(&quot;CSI_IT_std&quot;, # &quot;rs2 = c(0,1)&quot;), # transform = &quot;response&quot;, # offset = log(1), # length = 50) # # saveRDS(cont_agg_IT, &quot;model/cont_agg_IT.rds&quot;) cont_agg_IT &lt;- readRDS(&quot;model/cont_agg_IT.rds&quot;) cont_agg_IT %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(agg_daily_all_b2$CSI_IT)*CSI_IT + mean(agg_daily_all_b2$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference))+ geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 1), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = expression(frac(mu[IT不在],mu[IT在])), x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,7,1))+ scale_y_continuous(breaks = seq(1,7,1))+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;, angle = 0, vjust = 0.5, hjust = -0.5), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0))+ facet_rep_wrap(~rs2, repeat.tick.labels = TRUE, labeller = as_labeller(c(`1` = &quot;発情メス&quot;, `0` = &quot;非発情メス&quot;))) -&gt; p_cont_agg_IT p_cont_agg_IT # ggsave(&quot;figures/p_cont_agg_IT.png&quot;,p_cont_agg_IT, dpi = 600, units = &quot;mm&quot;, # width = 200, height = 100) 実データとmarginal meanを共に図示する。ただし、観察が3日以上あるもののみを図示した。 emm_agg_IT &lt;- estimate_means(m_agg_TYIT2, at = c(&quot;IT = c(0,1)&quot;, &quot;rs2 = c(0,1)&quot;), offset = 0) %&gt;% data.frame() %&gt;% mutate(IT = as.factor(IT)) df_signif &lt;- tidyr::crossing(rs2 = c(0,1)) %&gt;% mutate(start = &quot;0&quot;, end = &quot;1&quot;, y = c(0.082, 0.85), label = &quot;***&quot;) agg_daily_all_b2 %&gt;% group_by(femaleID, IT, rs2) %&gt;% summarise(mean = mean(rate_agg), n = n()) %&gt;% ungroup() %&gt;% filter(n &gt;= 3) %&gt;% mutate(IT = as.factor(IT)) %&gt;% ggplot(aes(x = IT, y = mean))+ geom_line(aes(group = femaleID), alpha = 0.7)+ geom_point(alpha = 0.7)+ coord_cartesian(xlim = c(1.3,1.7))+ # geom_errorbar(data = emm_agg_IT, # aes(y = Mean, # ymin = CI_low, # ymax = CI_high), # width = 0.15, # color = &quot;red3&quot;, # alpha = 0.3)+ # geom_pointrange(data = emm_agg_IT, # aes(y = Mean, # ymin = CI_low, # ymax = CI_high), # color = &quot;red3&quot;, # size = 0.7, # linewidth = 1, # alpha = 0.3)+ theme_bw(base_size = 16)+ scale_x_discrete(labels = c(expression(paste(italic(&quot;IT&quot;), &quot;absent&quot;)), expression(paste(italic(&quot;IT&quot;), &quot;present&quot;))))+ labs(x = &quot;&quot;, y = &quot;Rate of aggression (times/h)&quot;)+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), strip.background = element_blank(), strip.text = element_text(hjust = 0, family = &quot;Yu Gothic&quot;), aspect.ratio = 1)+ facet_rep_wrap(~rs2, scales = &quot;free&quot;, labeller = as_labeller(c(`0` = &quot;非発情メス&quot;, `1` = &quot;発情メス&quot;))) -&gt; p_agg_IT_raw p_agg_IT_raw # ggsave(&quot;figures/p_agg_IT_raw.png&quot;,p_agg_IT_raw, dpi = 600, units = &quot;mm&quot;, # width = 200, height = 100) 12.2.1.2 2019~2020交尾期 + TYの有無 + ITの有無 続いて2019~2020交尾期のデータを用い、TYとITの有無両方を考慮したモデルを考える。 12.2.1.2.1 データの加工 TYとITが3時間以上確認されたか、一度も確認されていない日だけを抽出する。 agg_daily_all_c &lt;- agg_daily_all %&gt;% filter(study_period != &quot;m21&quot;) %&gt;% filter(TY != 2 &amp; IT != 2) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), est_std = standardize(no_est), male_std = standardize(no_male), rank_std = standardize(rank_scaled), age_std = standardize(age), prop_std = standardize(prop_female), focal_std = standardize(prop_focal)) %&gt;% mutate(logdur = log(dur/60)) %&gt;% mutate(date = as.factor(date)) %&gt;% drop_na(CSI_TY, CSI_IT) 12.2.1.2.2 モデリング モデルの概要は以下の通り。データは各観察日におけるそれぞれのメスのデータである。 応答変数: オスからの被攻撃回数 説明変数: メスの発情の有無、TYの有無、それらの交互作用、発情メス数、確認オス数、調査期間、TYとのCSI、年齢、順位 オフセット項: 群れの追跡時間 分布: 負の二項分布 リンク関数: log関数 事前分布: 関数にある通り弱情報分布 m_agg_TYIT_bf21 &lt;- brm(no_agg ~ TY*rs2 + TY*CSI_TY_std + IT*rs2 + IT*CSI_IT_std + est_std + male_std + rank_std + prop_std + focal_std + age_std + study_period + offset(logdur) + (1|femaleID) + (1|date), family = negbinomial, iter = 11000, warmup = 1000, seed = 13, prior = c(prior(student_t(4,0,5), class = &quot;b&quot;), prior(student_t(4,0,10), class = &quot;Intercept&quot;), prior(student_t(4,0,10), class = &quot;sd&quot;), prior(gamma(0.01,0.01), class = &quot;shape&quot;)), control=list(adapt_delta = 0.99, max_treedepth = 20), backend = &quot;cmdstanr&quot;, data = agg_daily_all_c, file = &quot;model/m_agg_TYIT_bf21.rds&quot;) 12.2.1.2.2.1 モデルのチェック DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。特に問題はないよう。 ## 全個体への攻撃 dh_check_brms(m_agg_TYIT_bf21, quantreg = TRUE) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## 全個体への攻撃 pp_check(m_agg_TYIT_bf21, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) 多重共線性のチェックもお個あったが、VIFに問題はない。 check_collinearity(m_agg_TYIT_bf21) Rhatにも問題はなく、収束の問題はないよう。 ## 全個体への攻撃 data.frame(Rhat = brms::rhat(m_agg_TYIT_bf21)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) -&gt; p_rhat_agg_TYIT_bf21 p_rhat_agg_TYIT_bf21 12.2.1.2.2.2 結果の確認 結果は以下の通り。太字になっている変数は95%確信区間が0をまたいでおらず、有意な影響があるといえる。 .cl-a345e2e2{table-layout:auto;width:90%;}.cl-a33f761e{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a33f7628{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a33f7632{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a33f7633{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a3420de8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a3420df2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a3421ebe{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421ebf{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421ec8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421ec9{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421ed2{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421ed3{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421edc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421edd{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421ee6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421ee7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421ee8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421ef0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421ef1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421ef2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f04{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f05{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f0e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f0f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f10{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f18{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f19{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f1a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f22{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f23{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f2c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f2d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f2e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f36{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f37{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f40{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f41{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f4a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f54{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f55{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f56{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f5e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f5f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f60{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f68{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f69{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f6a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f72{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f73{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f7c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f7d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f7e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f7f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f86{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f87{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a3421f88{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-2.70[-3.06,-2.35]1.0019,676.44TYの在否 (在 vs 否)-0.46[-0.89,-0.04]1.0021,683.68ITの在否 (在 vs 否)-1.17[-1.61,-0.75]1.0021,525.08TYとの親密度(CSI)0.02[-0.24,0.27]1.0017,750.76ITとの親密度(CSI)-0.02[-0.22,0.19]1.0020,559.37メスの発情 (有 vs 無)0.74[0.47,1.01]1.0041,551.78TYの在否 ×TYとの親密度(CSI)-0.08[-0.29,0.13]1.0053,729.69TYの在否 ×メスの発情の有無0.18[-0.32,0.67]1.0043,188.75ITの在否 ×ITとの親密度(CSI)0.02[-0.19,0.23]1.0047,761.34ITの在否 ×メスの発情の有無0.82[0.12,1.50]1.0042,815.43確認オス数0.35[0.10,0.62]1.0019,016.52発情メス数0.07[-0.11,0.26]1.0016,541.32確認メス割合-0.25[-0.41,-0.09]1.0016,793.23個体追跡時間割合0.24[0.17,0.31]1.0052,949.54順位-0.13[-0.37,0.12]1.0016,737.81年齢-0.13[-0.37,0.09]1.0020,519.00調査期間(m20 vs m19)-1.49[-1.89,-1.11]1.0020,175.79 続いて、交互作用がある変数について検討する。 TY/ITとのCSIと発情状態によってTY/ITの有無による被攻撃頻度の違いがどのように変わるかを示したのが以下である。Differenceはoffsetが\\(log(1) = 0\\)のとき、すなわち1時間当たりの被攻撃頻度の比(\\(\\frac{\\mu_{TY = 0}}{\\mu_{TY=1}}\\))を表している。 まずはTYについてみていく。非発情メスについては、ほとんどのCSIで差が有意であった。一方で、発情メスについてはいずれのCSIでも差が有意でない。 estimate_contrasts(m_agg_TYIT_bf21, contrast = &quot;TY = c(0,1)&quot;, at = c(&quot;CSI_TY_std = seq(-1,1.5, 0.2)&quot;, &quot;rs2 = c(0,1)&quot;), transform = &quot;none&quot;, offset = log(1)) %&gt;% data.frame() %&gt;% select(-.offset.) %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(agg_daily_all_b$CSI_TY)*CSI_TY + mean(agg_daily_all_b$CSI_TY)) %&gt;% select(1:7) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) ITについても、発情メスのみで有意な差が見られるようだ。 estimate_contrasts(m_agg_TYIT_bf21, contrast = &quot;IT = c(0,1)&quot;, at = c(&quot;CSI_IT_std = seq(-0.7,3.5, 0.2)&quot;, &quot;rs2 = c(0,1)&quot;), transform = &quot;none&quot;, offset = log(1)) %&gt;% data.frame() %&gt;% select(-.offset.) %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(agg_daily_all_b$CSI_IT)*CSI_IT + mean(agg_daily_all_b$CSI_IT)) %&gt;% select(1:7) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 12.2.1.2.2.3 結果の図示 交互作用項の結果について図示する。 まずは、TYについて図示する。非発情メスについては、ほとんどのCSIで差が有意であった。一方で、発情メスについてはいずれのCSIでも差が有意でない。 # cont_agg_TY_bf21 &lt;- estimate_contrasts(m_agg_TYIT_bf21, # contrast = &quot;TY = c(0,1)&quot;, # at = c(&quot;CSI_TY_std&quot;, # &quot;rs2 = c(0,1)&quot;), # transform = &quot;response&quot;, # offset = log(1), # length = 50) # # saveRDS(cont_agg_TY_bf21, &quot;model/cont_agg_TY_bf21.rds&quot;) cont_agg_TY_bf21 &lt;- readRDS(&quot;model/cont_agg_TY_bf21.rds&quot;) cont_agg_TY_bf21 %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(agg_daily_all_c$CSI_TY)*CSI_TY + mean(agg_daily_all_c$CSI_TY)) %&gt;% ggplot(aes(x = CSI_TY, y = Difference))+ geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 1), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = expression(frac(mu[TY不在],mu[TY在])), x = expression(paste(&quot;CSI with &quot;,italic(&quot;TY&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,1))+ scale_y_continuous(breaks = seq(1,7,1))+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;, angle = 0, vjust = 0.5, hjust = -0.5), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0))+ facet_rep_wrap(~rs2, repeat.tick.labels = TRUE, labeller = as_labeller(c(`1` = &quot;発情メス&quot;, `0` = &quot;非発情メス&quot;))) -&gt; p_cont_agg_TY_bf21 p_cont_agg_TY_bf21 # ggsave(&quot;figures/p_cont_agg_TY_bf21.png&quot;,p_cont_agg_TY_bf21, dpi = 600, units = &quot;mm&quot;, # width = 200, height = 100) 次に、ITについて図示する。こちらは2021年を除かない場合と同じ傾向を示した。 # cont_agg_IT_bf21 &lt;- estimate_contrasts(m_agg_TYIT_bf21, # contrast = &quot;IT = c(0,1)&quot;, # at = c(&quot;CSI_IT_std&quot;, # &quot;rs2 = c(0,1)&quot;), # transform = &quot;response&quot;, # offset = log(1), # length = 50) # # saveRDS(cont_agg_IT_bf21, &quot;model/cont_agg_IT_bf21.rds&quot;) cont_agg_IT_bf21 &lt;- readRDS(&quot;model/cont_agg_IT_bf21.rds&quot;) cont_agg_IT_bf21 %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(agg_daily_all_b$CSI_IT)*CSI_IT + mean(agg_daily_all_b$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference))+ geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 1), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = expression(frac(mu[IT不在],mu[IT在])), x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,6,1))+ scale_y_continuous(breaks = seq(1,10,2))+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;, angle = 0, vjust = 0.5, hjust = -0.5), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0))+ facet_rep_wrap(~rs2, repeat.tick.labels = TRUE, labeller = as_labeller(c(`1` = &quot;発情メス&quot;, `0` = &quot;非発情メス&quot;))) -&gt; p_cont_agg_IT_bf21 p_cont_agg_IT_bf21 # ggsave(&quot;figures/p_cont_agg_IT_bf21.png&quot;,p_cont_agg_IT_bf21, dpi = 600, units = &quot;mm&quot;, # width = 200, height = 100) 実データとmarginal meanを共に図示する。ただし、\\(n \\ge 3\\)の個体のみを図示に用いた。 emm_agg_TYIT_bf21_IT &lt;- estimate_means(m_agg_TYIT_bf21, at = c(&quot;IT = c(0,1)&quot;, &quot;rs2 = c(0,1)&quot;), offset = 0) %&gt;% data.frame() %&gt;% mutate(IT = as.factor(IT)) agg_daily_all_c %&gt;% group_by(femaleID, IT, rs2) %&gt;% summarise(mean = mean(rate_agg), n = n()) %&gt;% ungroup() %&gt;% filter(n &gt;= 3) %&gt;% mutate(IT = as.factor(IT)) %&gt;% ggplot(aes(x = IT, y = mean))+ geom_line(aes(group = femaleID), alpha = 0.7)+ geom_point(alpha = 0.7)+ coord_cartesian(xlim = c(1.3,1.7))+ # geom_errorbar(data = emm_agg_TYIT_bf21_IT, # aes(y = Mean, # ymin = CI_low, # ymax = CI_high), # width = 0.15, # color = &quot;red3&quot;)+ # geom_pointrange(data = emm_agg_TYIT_bf21_IT, # aes(y = Mean, # ymin = CI_low, # ymax = CI_high), # color = &quot;red3&quot;, # size = 0.7, # linewidth = 1)+ theme_bw(base_size = 16)+ scale_x_discrete(labels = c(expression(paste(italic(&quot;IT&quot;), &quot;absent&quot;)), expression(paste(italic(&quot;IT&quot;), &quot;present&quot;))))+ labs(x = &quot;&quot;, y = &quot;Rate of aggression (times/h)&quot;)+ theme(axis.title.y = element_text(family = &quot;Arial&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), strip.background = element_blank(), strip.text = element_text(hjust = 0, family = &quot;Yu Gothic&quot;), aspect.ratio = 1)+ facet_rep_wrap(~rs2, scales = &quot;free_y&quot;, labeller = as_labeller(c(`0` = &quot;非発情メス&quot;, `1` = &quot;発情メス&quot;))) -&gt; p_agg_TYIT_bf21_IT_raw p_agg_TYIT_bf21_IT_raw # ggsave(&quot;figures/p_agg_TYIT_bf21_IT_raw.png&quot;, # p_agg_TYIT_bf21_IT_raw, dpi = 600, units = &quot;mm&quot;, # width = 200, height = 100) 12.2.2 発情と非発情を分ける 12.2.2.1 全期間 + TY/ITの有無 まず、全期間のデータを用いて分析を行う。ITは2021年には移出していなかったので、TYの有無のみを考慮する。 12.2.2.1.1 データの加工 TYが3時間以上確認されたか、一度も確認されていない日だけを抽出する。 agg_daily_all_es &lt;- agg_daily_all %&gt;% filter(TY != 2 &amp; IT != 2) %&gt;% filter(rs2 == &quot;1&quot;) %&gt;% mutate(logdur = log(dur/60)) %&gt;% mutate(date = as.factor(date)) %&gt;% drop_na(CSI_TY) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), est_std = standardize(no_est), male_std = standardize(no_male), rank_std = standardize(rank_scaled), age_std = standardize(age), prop_std = standardize(prop_female), focal_std = standardize(prop_focal)) agg_daily_all_an &lt;- agg_daily_all %&gt;% filter(TY != 2 &amp; IT != 2) %&gt;% filter(rs2 == &quot;0&quot;) %&gt;% mutate(logdur = log(dur/60)) %&gt;% mutate(date = as.factor(date)) %&gt;% drop_na(CSI_TY) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), est_std = standardize(no_est), male_std = standardize(no_male), rank_std = standardize(rank_scaled), age_std = standardize(age), prop_std = standardize(prop_female), focal_std = standardize(prop_focal)) 12.2.2.1.2 モデリング モデルの概要は以下の通り。データは各観察日におけるそれぞれのメスのデータである。 応答変数: オスからの被攻撃回数 説明変数: 発情の有無、TYの有無、TYとのCSI、発情の有無×TYの有無、TYとのCSI×TYの有無、発情メス数、確認オス数、調査期間、年齢、順位 オフセット項: 群れの追跡時間 分布: 負の二項分布 リンク関数: log関数 事前分布: 関数にある通り弱情報分布 m_agg_TYIT_es &lt;- brm(no_agg ~ TY*CSI_TY_std + IT*CSI_IT_std + est_std + male_std + rank_std + prop_std + focal_std + age_std + study_period + offset(logdur) + (1|femaleID) + (1|date), family = negbinomial, iter = 11000, warmup = 1000, seed = 13, prior = c(prior(student_t(4,0,5), class = &quot;b&quot;), prior(student_t(4,0,10), class = &quot;Intercept&quot;), prior(student_t(4,0,10), class = &quot;sd&quot;), prior(gamma(0.01,0.01), class = &quot;shape&quot;)), control=list(adapt_delta = 0.99, max_treedepth = 20), backend = &quot;cmdstanr&quot;, data = agg_daily_all_es, file = &quot;model/m_agg_TYIT_es.rds&quot;) m_agg_TYIT_an &lt;- brm(no_agg ~ TY*CSI_TY_std + IT*CSI_IT_std + est_std + male_std + rank_std + prop_std + focal_std + age_std + study_period + offset(logdur) + (1|femaleID) + (1|date), family = &quot;negbinomial&quot;, iter = 11000, warmup = 1000, seed = 13, prior = c(prior(student_t(4,0,5), class = &quot;b&quot;), prior(student_t(4,0,10), class = &quot;Intercept&quot;), prior(student_t(4,0,10), class = &quot;sd&quot;), prior(gamma(0.01,0.01), class = &quot;shape&quot;)), control=list(adapt_delta = 0.99, max_treedepth = 20), backend = &quot;cmdstanr&quot;, data = agg_daily_all_an, file = &quot;model/m_agg_TYIT_an.rds&quot;) 12.2.2.1.2.1 モデルのチェック DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。どちらのモデルも特に問題はないよう。 dh_check_brms(m_agg_TYIT_es, quantreg = TRUE) dh_check_brms(m_agg_TYIT_an, quantreg = TRUE) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## 全個体への攻撃 pp_check(m_agg_TYIT_es, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) pp_check(m_agg_TYIT_an, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) 多重共線性のチェックも行ったが、VIFに問題はない。 check_collinearity(m_agg_TYIT_es) check_collinearity(m_agg_TYIT_an) 12.2.2.1.2.2 結果の確認 結果は以下の通り。太字になっている変数は95%確信区間が0をまたいでおらず、有意な影響があるといえる。まずは発情メスについては、発情メス数のみが有意な影響を持っていた。 .cl-bbd64428{table-layout:auto;width:90%;}.cl-bbcf18f6{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-bbcf190a{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-bbcf1914{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-bbcf1915{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-bbd1fe4a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-bbd1fe5e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-bbd20f3e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f3f{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f48{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f49{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f4a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f52{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f53{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f54{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f5c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f5d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f66{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f70{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f71{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f7a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f7b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f84{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f85{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f86{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f8e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f8f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f98{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20f99{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fa2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fa3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fac{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fad{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fb6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fb7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fc0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fc1{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fca{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fcb{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fd4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fd5{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fd6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fd7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fde{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fe8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20fe9{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20ff2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20ff3{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20ff4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20ff5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20ffc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bbd20ffd{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-0.49[-1.10,0.12]1.0018,629.80TYの在否 (在 vs 否)-0.35[-0.84,0.15]1.0026,358.65ITの在否 (在 vs 否)-1.20[-2.03,-0.43]1.0036,512.98TYとの親密度(CSI)0.34[-0.07,0.76]1.0019,158.94ITとの親密度(CSI)0.11[-0.16,0.43]1.0017,442.72TYの在否 ×TYとの親密度(CSI)-0.23[-0.55,0.10]1.0029,769.46ITの在否 ×ITとの親密度(CSI)0.12[-0.23,0.48]1.0044,531.27確認オス数-0.01[-0.18,0.18]1.0029,829.50発情メス数0.39[0.06,0.72]1.0022,300.07確認メス割合-0.10[-0.29,0.08]1.0024,720.84個体追跡時間割合0.31[0.14,0.49]1.0026,551.79順位-0.23[-0.56,0.12]1.0017,464.32年齢-0.13[-0.46,0.12]1.0017,423.14調査期間(m20 vs m19)-1.05[-1.71,-0.39]1.0032,720.37調査期間(m21 vs m19)-1.95[-2.64,-1.30]1.0021,577.58 続いて、非発情メスについては以下のとおりである。 .cl-c6688d74{table-layout:auto;width:90%;}.cl-c661395c{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c6613970{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c6613971{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c6613972{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c664197e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c6641988{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c66429e6{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c66429f0{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c66429f1{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c66429fa{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c66429fb{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c66429fc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a04{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a05{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a0e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a0f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a10{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a18{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a19{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a1a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a22{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a23{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a2c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a2d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a2e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a36{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a37{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a40{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a41{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a42{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a4a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a4b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a4c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a54{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a55{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a5e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a68{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a69{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a6a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a6b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a72{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a73{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a74{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a75{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a7c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a7d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a7e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a7f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a86{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a87{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c6642a88{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-2.48[-2.80,-2.17]1.0016,955.95TYの在否 (在 vs 否)-0.53[-0.85,-0.23]1.0026,058.15ITの在否 (在 vs 否)-1.13[-1.56,-0.71]1.0021,243.44TYとの親密度(CSI)0.00[-0.20,0.18]1.0020,771.59ITとの親密度(CSI)-0.05[-0.20,0.11]1.0022,177.98TYの在否 ×TYとの親密度(CSI)-0.09[-0.26,0.08]1.0071,080.57ITの在否 ×ITとの親密度(CSI)-0.07[-0.34,0.16]1.0059,916.75確認オス数0.32[0.13,0.51]1.0028,108.04発情メス数0.31[0.19,0.44]1.0031,684.91確認メス割合-0.20[-0.32,-0.07]1.0015,859.81個体追跡時間割合0.20[0.13,0.27]1.0060,701.04順位-0.19[-0.40,-0.01]1.0020,100.86年齢-0.08[-0.23,0.07]1.0027,317.15調査期間(m20 vs m19)-1.64[-2.03,-1.27]1.0021,924.02調査期間(m21 vs m19)-1.89[-2.27,-1.51]1.0018,354.88 続いて、交互作用がある変数について検討する。 TYとのCSIと発情状態によってTYの有無による被攻撃頻度の違いがどのように変わるかを示したのが以下である。まず発情メスについては、CSIに関わらずTYの有無は有意に影響していない。 estimate_contrasts(m_agg_TYIT_es, contrast = &quot;TY = c(0,1)&quot;, at = c(&quot;CSI_TY_std = seq(-1,1.5, 0.2)&quot;), transform = &quot;none&quot;, offset = log(1)) %&gt;% data.frame() %&gt;% select(-.offset.) %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(agg_daily_all_es$CSI_TY)*CSI_TY + mean(agg_daily_all_es$CSI_TY)) %&gt;% select(1:7) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 続いて非発情メスについては、CSIの関わらずTYがいると攻撃を受ける頻度が低下することが分かる。 estimate_contrasts(m_agg_TYIT_an, contrast = &quot;TY = c(0,1)&quot;, at = c(&quot;CSI_TY_std = seq(-1,1.5, 0.2)&quot;), transform = &quot;none&quot;, offset = log(1)) %&gt;% data.frame() %&gt;% select(-.offset.) %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(agg_daily_all_an$CSI_TY)*CSI_TY + mean(agg_daily_all_an$CSI_TY)) %&gt;% select(1:7) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 同様の分析をITについても行う。まず、発情メスについてはCSIに関わらずITがいない日の方が攻撃を受けやすい。 estimate_contrasts(m_agg_TYIT_es, contrast = &quot;IT = c(0,1)&quot;, at = c(&quot;CSI_IT_std = seq(-1,1.5, 0.2)&quot;), transform = &quot;none&quot;, offset = log(1)) %&gt;% data.frame() %&gt;% select(-.offset.) %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(agg_daily_all_es$CSI_IT)*CSI_IT + mean(agg_daily_all_es$CSI_IT)) %&gt;% select(1:7) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 非発情メスについても同様の傾向があるようだ。 estimate_contrasts(m_agg_TYIT_an, contrast = &quot;IT = c(0,1)&quot;, at = c(&quot;CSI_IT_std = seq(-1,1.5, 0.2)&quot;), transform = &quot;none&quot;, offset = log(1)) %&gt;% data.frame() %&gt;% select(-.offset.) %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(agg_daily_all_es$CSI_IT)*CSI_IT + mean(agg_daily_all_es$CSI_IT)) %&gt;% select(1:7) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 12.2.2.1.2.3 結果の図示 交互作用項の結果について図示する。先ほど見たように、 # cont_agg_TY_es &lt;- estimate_contrasts(m_agg_TYIT_es, # contrast = &quot;TY = c(0,1)&quot;, # at = c(&quot;CSI_TY_std&quot;), # transform = &quot;response&quot;, # offset = log(1), # length = 100) # saveRDS(cont_agg_TY_es, &quot;model/cont_agg_TY_es.rds&quot;) cont_agg_TY_es &lt;- readRDS(&quot;model/cont_agg_TY_es.rds&quot;) # cont_agg_TY_an &lt;- estimate_contrasts(m_agg_TYIT_an, # contrast = &quot;TY = c(0,1)&quot;, # at = c(&quot;CSI_TY_std&quot;), # transform = &quot;response&quot;, # offset = log(1), # length = 100) # saveRDS(cont_agg_TY_an, &quot;model/cont_agg_TY_an.rds&quot;) cont_agg_TY_an &lt;- readRDS(&quot;model/cont_agg_TY_an.rds&quot;) cont_agg_TY_es %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(agg_daily_all_es$CSI_TY)*CSI_TY + mean(agg_daily_all_es$CSI_TY)) %&gt;% ggplot(aes(x = CSI_TY, y = Difference))+ geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 1), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = expression(frac(mu[TY不在],mu[TY在])), x = expression(paste(&quot;CSI with &quot;,italic(&quot;TY&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,1))+ scale_y_continuous(breaks = seq(1,9,2))+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;, angle = 0, vjust = 0.5, hjust = -0.5), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0), title = element_text(family = &quot;Yu Gothic&quot;, size = 12))+ labs(title = &quot;発情メス&quot;) -&gt; p_cont_agg_TY_es cont_agg_TY_an %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(agg_daily_all_an$CSI_TY)*CSI_TY + mean(agg_daily_all_an$CSI_TY)) %&gt;% ggplot(aes(x = CSI_TY, y = Difference))+ geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 1), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = expression(frac(mu[TY不在],mu[TY在])), x = expression(paste(&quot;CSI with &quot;,italic(&quot;TY&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,1))+ scale_y_continuous(breaks = seq(1,9,1))+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;, angle = 0, vjust = 0.5, hjust = -0.5), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0), title = element_text(family = &quot;Yu Gothic&quot;, size = 12))+ labs(title = &quot;非発情メス&quot;) -&gt; p_cont_agg_TY_an p_cont_agg_TY_esan &lt;- p_cont_agg_TY_an + p_cont_agg_TY_es p_cont_agg_TY_esan # ggsave(&quot;figures/p_cont_agg_TY_esan.png&quot;,p_cont_agg_TY_esan, dpi = 600, units = &quot;mm&quot;, # width = 200, height = 100) # cont_agg_IT_es &lt;- estimate_contrasts(m_agg_TYIT_es, # contrast = &quot;IT = c(0,1)&quot;, # at = c(&quot;CSI_IT_std&quot;), # transform = &quot;response&quot;, # offset = log(1), # length = 100) # # saveRDS(cont_agg_IT_es, &quot;model/cont_agg_IT_es.rds&quot;) cont_agg_IT_es &lt;- readRDS(&quot;model/cont_agg_IT_es.rds&quot;) # cont_agg_IT_an &lt;- estimate_contrasts(m_agg_TYIT_an, # contrast = &quot;IT = c(0,1)&quot;, # at = c(&quot;CSI_IT_std&quot;), # transform = &quot;response&quot;, # offset = log(1), # length = 100) # # saveRDS(cont_agg_IT_an, &quot;model/cont_agg_IT_an.rds&quot;) cont_agg_IT_an &lt;- readRDS(&quot;model/cont_agg_IT_an.rds&quot;) cont_agg_IT_es %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(agg_daily_all_es$CSI_IT)*CSI_IT + mean(agg_daily_all_es$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference))+ geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 1), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = expression(frac(mu[IT不在],mu[IT在])), x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,7,1))+ scale_y_continuous(breaks = seq(1,12,2))+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;, angle = 0, vjust = 0.5, hjust = -0.5), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0), title = element_text(family = &quot;Yu Gothic&quot;, size = 12))+ labs(title = &quot;発情メス&quot;)-&gt; p_cont_agg_IT_es cont_agg_IT_an %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(agg_daily_all_an$CSI_IT)*CSI_IT + mean(agg_daily_all_an$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference))+ geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 1), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = expression(frac(mu[IT不在],mu[IT在])), x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,7,1))+ scale_y_continuous(breaks = seq(1,12,2))+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;, angle = 0, vjust = 0.5, hjust = -0.5), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0), title = element_text(family = &quot;Yu Gothic&quot;, size = 12)) + labs(title = &quot;非発情メス&quot;) -&gt; p_cont_agg_IT_an p_cont_agg_IT_esan &lt;- p_cont_agg_IT_an + p_cont_agg_IT_es p_cont_agg_IT_esan # ggsave(&quot;figures/p_cont_agg_IT_esan.png&quot;,p_cont_agg_IT_esan, dpi = 600, units = &quot;mm&quot;, # width = 200, height = 100) 12.2.2.2 2019~2020交尾期 + TYの有無 + ITの有無 続いて2019~2020交尾期のデータを用い、TYとITの有無両方を考慮したモデルを考える。 12.2.2.2.1 データの加工 TYとITが3時間以上確認されたか、一度も確認されていない日だけを抽出する。 agg_daily_all_bf21_es &lt;- agg_daily_all %&gt;% filter(TY != 2 &amp; IT != 2) %&gt;% filter(study_period != &quot;m21&quot;) %&gt;% filter(rs2 == &quot;1&quot;) %&gt;% mutate(logdur = log(dur/60)) %&gt;% mutate(date = as.factor(date)) %&gt;% drop_na(CSI_TY) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), est_std = standardize(no_est), male_std = standardize(no_male), rank_std = standardize(rank_scaled), age_std = standardize(age), prop_std = standardize(prop_female), focal_std = standardize(prop_focal)) agg_daily_all_bf21_an &lt;- agg_daily_all %&gt;% filter(TY != 2 &amp; IT != 2) %&gt;% filter(study_period != &quot;m21&quot;) %&gt;% filter(rs2 == &quot;0&quot;) %&gt;% mutate(logdur = log(dur/60)) %&gt;% mutate(date = as.factor(date)) %&gt;% drop_na(CSI_TY) %&gt;% mutate(CSI_TY_std = standardize(CSI_TY), CSI_IT_std = standardize(CSI_IT), est_std = standardize(no_est), male_std = standardize(no_male), rank_std = standardize(rank_scaled), age_std = standardize(age), prop_std = standardize(prop_female), focal_std = standardize(prop_focal)) 12.2.2.2.2 モデリング モデルの概要は以下の通り。データは各観察日におけるそれぞれのメスのデータである。 応答変数: オスからの被攻撃回数 説明変数: 発情の有無、TYの有無、TYとのCSI、発情の有無×TYの有無、TYとのCSI×TYの有無、発情メス数、確認オス数、調査期間、年齢、順位 オフセット項: 群れの追跡時間 分布: 負の二項分布 リンク関数: log関数 事前分布: 関数にある通り弱情報分布 m_agg_TYIT_bf21_es &lt;- brm(no_agg ~ TY*CSI_TY_std + IT*CSI_IT_std + est_std + male_std + rank_std + prop_std + focal_std + age_std + study_period + offset(logdur) + (1|femaleID) + (1|date), family = negbinomial, iter = 11000, warmup = 1000, seed = 133, prior = c(prior(student_t(4,0,5), class = &quot;b&quot;), prior(student_t(4,0,10), class = &quot;Intercept&quot;), prior(student_t(4,0,10), class = &quot;sd&quot;), prior(gamma(0.01,0.01), class = &quot;shape&quot;)), control=list(adapt_delta = 0.999, max_treedepth = 20), backend = &quot;cmdstanr&quot;, data = agg_daily_all_bf21_es, file = &quot;model/m_agg_TYIT_bf21_es.rds&quot;) m_agg_TYIT_bf21_an &lt;- brm(no_agg ~ TY*CSI_TY_std + IT*CSI_IT_std + est_std + male_std + rank_std + prop_std + focal_std + age_std + study_period + offset(logdur) + (1|femaleID) + (1|date), family = &quot;negbinomial&quot;, iter = 11000, warmup = 1000, seed = 13, prior = c(prior(student_t(4,0,5), class = &quot;b&quot;), prior(student_t(4,0,10), class = &quot;Intercept&quot;), prior(student_t(4,0,10), class = &quot;sd&quot;), prior(gamma(0.01,0.01), class = &quot;shape&quot;)), control=list(adapt_delta = 0.99, max_treedepth = 20), backend = &quot;cmdstanr&quot;, data = agg_daily_all_bf21_an, file = &quot;model/m_agg_TYIT_bf21_an.rds&quot;) 12.2.2.2.2.1 モデルのチェック DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。どちらのモデルも特に問題はないよう。 dh_check_brms(m_agg_TYIT_bf21_es, quantreg = TRUE) dh_check_brms(m_agg_TYIT_bf21_an, quantreg = TRUE) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない。 ## 全個体への攻撃 pp_check(m_agg_TYIT_bf21_es, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) pp_check(m_agg_TYIT_bf21_an, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) 多重共線性のチェックも行ったが、VIFに問題はない。 check_collinearity(m_agg_TYIT_bf21_es) check_collinearity(m_agg_TYIT_bf21_an) 12.2.2.2.2.2 結果の確認 結果は以下の通り。太字になっている変数は95%確信区間が0をまたいでおらず、有意な影響があるといえる。まずは発情メスについては、ITの在否のみが有意な影響を持っていた。 .cl-def8813c{table-layout:auto;width:90%;}.cl-def1dfc6{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-def1dfda{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-def1dfe4{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-def1dfe5{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-def48eba{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-def48ec4{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-def4a058{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a059{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a062{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a063{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a064{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a065{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a066{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a06c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a06d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a076{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a077{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a078{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a080{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a08a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a08b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a08c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a094{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a095{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a09e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a09f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0a8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0a9{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0b2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0b3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0b4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0bc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0bd{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0c6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0c7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0c8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0d0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0d1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0d2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0d3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0da{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0db{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0e4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0ee{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0ef{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-def4a0f0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-1.19[-1.76,-0.62]1.0018,936.61TYの在否 (在 vs 否)-0.46[-1.23,0.29]1.0025,397.32ITの在否 (在 vs 否)-1.15[-2.06,-0.28]1.0030,586.57TYとの親密度(CSI)0.19[-0.32,0.66]1.0017,308.86ITとの親密度(CSI)0.20[-0.31,0.77]1.0018,851.56TYの在否 ×TYとの親密度(CSI)-0.15[-0.62,0.34]1.0023,951.98ITの在否 ×ITとの親密度(CSI)0.10[-0.42,0.60]1.0025,803.95確認オス数0.34[-0.02,0.73]1.0027,375.77発情メス数-0.01[-0.32,0.29]1.0028,807.28確認メス割合-0.11[-0.48,0.24]1.0021,565.71個体追跡時間割合0.27[-0.05,0.60]1.0032,505.45順位-0.07[-0.44,0.30]1.0018,621.99年齢-0.24[-0.67,0.14]1.0015,667.66調査期間(m20 vs m19)-0.55[-1.47,0.33]1.0028,055.73 続いて、非発情メスについては以下のとおりである。 .cl-e68f2d06{table-layout:auto;width:90%;}.cl-e68886d6{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e68886e0{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e68886ea{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e68886eb{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e68b33f4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e68b33fe{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e68b45f6{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b45f7{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4600{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4601{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4602{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b460a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b460b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b460c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b460d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4614{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b461e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b461f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4620{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4621{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4628{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4629{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b462a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4632{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4633{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4634{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b463c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b463d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b463e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b463f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4646{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4647{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4648{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4650{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4651{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4652{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4653{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4654{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b465a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b465b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b465c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b466e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b466f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4670{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4678{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e68b4682{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-2.71[-3.10,-2.34]1.0020,805.52TYの在否 (在 vs 否)-0.34[-0.80,0.10]1.0022,125.52ITの在否 (在 vs 否)-1.18[-1.64,-0.75]1.0020,602.07TYとの親密度(CSI)-0.00[-0.27,0.25]1.0019,736.93ITとの親密度(CSI)-0.08[-0.29,0.13]1.0025,592.40TYの在否 ×TYとの親密度(CSI)-0.07[-0.28,0.14]1.0060,898.83ITの在否 ×ITとの親密度(CSI)-0.02[-0.30,0.22]1.0054,843.58確認オス数0.28[0.01,0.56]1.0021,481.27発情メス数0.07[-0.13,0.26]1.0018,525.83確認メス割合-0.28[-0.45,-0.12]1.0016,600.82個体追跡時間割合0.18[0.10,0.26]1.0056,997.58順位-0.14[-0.42,0.11]1.0017,601.94年齢-0.08[-0.29,0.13]1.0023,613.24調査期間(m20 vs m19)-1.71[-2.15,-1.30]1.0022,416.78 続いて、交互作用がある変数について検討する。 TYとのCSIと発情状態によってTYの有無による被攻撃頻度の違いがどのように変わるかを示したのが以下である。まず発情メスについては、いずれのCSIでも有意な差はないことが分かる。 estimate_contrasts(m_agg_TYIT_bf21_es, contrast = &quot;TY = c(0,1)&quot;, at = c(&quot;CSI_TY_std = seq(-1,1.5, 0.2)&quot;), transform = &quot;none&quot;, offset = log(1)) %&gt;% data.frame() %&gt;% select(-.offset.) %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(agg_daily_all_es$CSI_TY)*CSI_TY + mean(agg_daily_all_es$CSI_TY)) %&gt;% select(1:7) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 非発情メスについても同様である。 estimate_contrasts(m_agg_TYIT_bf21_an, contrast = &quot;TY = c(0,1)&quot;, at = c(&quot;CSI_TY_std = seq(-1,1.5, 0.2)&quot;), transform = &quot;none&quot;, offset = log(1)) %&gt;% data.frame() %&gt;% select(-.offset.) %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(agg_daily_all_an$CSI_TY)*CSI_TY + mean(agg_daily_all_an$CSI_TY)) %&gt;% select(1:7) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 同様の分析をITについても行う。まず、発情メスについてはCSIが3.5くらいまではITがいない日の方が攻撃を受けやすい。 estimate_contrasts(m_agg_TYIT_bf21_es, contrast = &quot;IT = c(0,1)&quot;, at = c(&quot;CSI_IT_std = seq(-1,3, 0.2)&quot;), transform = &quot;none&quot;, offset = log(1)) %&gt;% data.frame() %&gt;% select(-.offset.) %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(agg_daily_all_es$CSI_IT)*CSI_IT + mean(agg_daily_all_es$CSI_IT)) %&gt;% select(1:7) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 非発情メスについてはCSIに関わらず同様の傾向があるようだ。 estimate_contrasts(m_agg_TYIT_bf21_an, contrast = &quot;IT = c(0,1)&quot;, at = c(&quot;CSI_IT_std = seq(-1,1.5, 0.2)&quot;), transform = &quot;none&quot;, offset = log(1)) %&gt;% data.frame() %&gt;% select(-.offset.) %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(agg_daily_all_es$CSI_IT)*CSI_IT + mean(agg_daily_all_es$CSI_IT)) %&gt;% select(1:7) %&gt;% mutate(across(where(is.numeric), ~round(.,2))) 12.2.2.2.2.3 結果の図示 交互作用項の結果について図示する。 # cont_agg_TY_bf21_es &lt;- estimate_contrasts(m_agg_TYIT_bf21_es, # contrast = &quot;TY = c(0,1)&quot;, # at = c(&quot;CSI_TY_std&quot;), # transform = &quot;none&quot;, # offset = log(1), # length = 100) # saveRDS(cont_agg_TY_bf21_es, &quot;model/cont_agg_TY_bf21_es.rds&quot;) cont_agg_TY_bf21_es &lt;- readRDS(&quot;model/cont_agg_TY_bf21_es.rds&quot;) # cont_agg_TY_bf21_an &lt;- estimate_contrasts(m_agg_TYIT_bf21_an, # contrast = &quot;TY = c(0,1)&quot;, # at = c(&quot;CSI_TY_std&quot;), # transform = &quot;none&quot;, # offset = log(1), # length = 100) # # saveRDS(cont_agg_TY_bf21_an, &quot;model/cont_agg_TY_bf21_an.rds&quot;) cont_agg_TY_bf21_an &lt;- readRDS(&quot;model/cont_agg_TY_bf21_an.rds&quot;) cont_agg_TY_bf21_es %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(agg_daily_all_bf21_es$CSI_TY)*CSI_TY + mean(agg_daily_all_bf21_es$CSI_TY)) %&gt;% ggplot(aes(x = CSI_TY, y = Difference))+ geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = expression(frac(mu[TY不在],mu[TY在])), x = expression(paste(&quot;CSI with &quot;,italic(&quot;TY&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,1))+ scale_y_continuous(breaks = seq(-10,50,2))+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;, angle = 0, vjust = 0.5, hjust = -0.5), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0), title = element_text(family = &quot;Yu Gothic&quot;, size = 12))+ labs(title = &quot;発情メス&quot;) -&gt; p_cont_agg_TY_bf21_es cont_agg_TY_bf21_an %&gt;% data.frame() %&gt;% rename(CSI_TY = CSI_TY_std) %&gt;% mutate(CSI_TY = sd(agg_daily_all_bf21_an$CSI_TY)*CSI_TY + mean(agg_daily_all_bf21_an$CSI_TY)) %&gt;% ggplot(aes(x = CSI_TY, y = Difference))+ geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 0), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = expression(frac(mu[TY不在],mu[TY在])), x = expression(paste(&quot;CSI with &quot;,italic(&quot;TY&quot;)))) + scale_x_continuous(breaks = seq(0,3.5,1))+ scale_y_continuous(breaks = seq(-0,9,1))+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;, angle = 0, vjust = 0.5, hjust = -0.5), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0), title = element_text(family = &quot;Yu Gothic&quot;, size = 12))+ labs(title = &quot;非発情メス&quot;) -&gt; p_cont_agg_TY_bf21_an p_cont_agg_TY_bf21_esan &lt;- p_cont_agg_TY_bf21_an + p_cont_agg_TY_bf21_es p_cont_agg_TY_bf21_esan # ggsave(&quot;figures/p_cont_agg_TY_bf21_esan.png&quot;,p_cont_agg_TY_bf21_esan, # dpi = 600, units = &quot;mm&quot;, # width = 200, height = 100) ITについても同様に図示する。 # cont_agg_IT_bf21_es &lt;- estimate_contrasts(m_agg_TYIT_bf21_es, # contrast = &quot;IT = c(0,1)&quot;, # at = c(&quot;CSI_IT_std&quot;), # transform = &quot;response&quot;, # offset = log(1), # length = 100) # # saveRDS(cont_agg_IT_bf21_es, &quot;model/cont_agg_IT_bf21_es.rds&quot;) cont_agg_IT_bf21_es &lt;- readRDS(&quot;model/cont_agg_IT_bf21_es.rds&quot;) # cont_agg_IT_bf21_an &lt;- estimate_contrasts(m_agg_TYIT_bf21_an, # contrast = &quot;IT = c(0,1)&quot;, # at = c(&quot;CSI_IT_std&quot;), # transform = &quot;response&quot;, # offset = log(1), # length = 100) # # saveRDS(cont_agg_IT_bf21_an, &quot;model/cont_agg_IT_bf21_an.rds&quot;) cont_agg_IT_bf21_an &lt;- readRDS(&quot;model/cont_agg_IT_bf21_an.rds&quot;) cont_agg_IT_bf21_es %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(agg_daily_all_bf21_es$CSI_IT)*CSI_IT + mean(agg_daily_all_bf21_es$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference))+ geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 1), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = expression(frac(mu[IT不在],mu[IT在])), x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,7,1))+ scale_y_continuous(breaks = seq(1,12,2))+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;, angle = 0, vjust = 0.5, hjust = -0.5), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0), title = element_text(family = &quot;Yu Gothic&quot;, size = 12))+ labs(title = &quot;発情メス&quot;)-&gt; p_cont_agg_IT_bf21_es cont_agg_IT_bf21_an %&gt;% data.frame() %&gt;% rename(CSI_IT = CSI_IT_std) %&gt;% mutate(CSI_IT = sd(agg_daily_all_an$CSI_IT)*CSI_IT + mean(agg_daily_all_an$CSI_IT)) %&gt;% ggplot(aes(x = CSI_IT, y = Difference))+ geom_line()+ geom_ribbon(aes(ymin = CI_low, ymax = CI_high), alpha = 0.1)+ geom_hline(aes(yintercept = 1), linetype = &quot;dashed&quot;, color = &quot;grey30&quot;, linewidth = 1)+ theme_bw(base_size = 18)+ theme(aspect.ratio = 1) + labs(y = expression(frac(mu[IT不在],mu[IT在])), x = expression(paste(&quot;CSI with &quot;,italic(&quot;IT&quot;)))) + scale_x_continuous(breaks = seq(0,7,1))+ scale_y_continuous(breaks = seq(1,12,2))+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;, angle = 0, vjust = 0.5, hjust = -0.5), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0), title = element_text(family = &quot;Yu Gothic&quot;, size = 12)) + labs(title = &quot;非発情メス&quot;) -&gt; p_cont_agg_IT_bf21_an p_cont_agg_IT_bf21_esan &lt;- p_cont_agg_IT_bf21_an + p_cont_agg_IT_bf21_es p_cont_agg_IT_bf21_esan # ggsave(&quot;figures/p_cont_agg_IT_bf21_esan.png&quot;,p_cont_agg_IT_bf21_esan, # dpi = 600, units = &quot;mm&quot;, # width = 200, height = 100) References Gabry, J., &amp; Mahr, T. (2022). Bayesplot: Plotting for bayesian models. https://mc-stan.org/bayesplot Hartig, F. (2022). DHARMa: Residual diagnostics for hierarchical (multi-level / mixed) regression models. https://CRAN.R-project.org/package=DHARMa Rodríguez-Sánchez, F. (2023). DHARMa.helpers: Helper functions to check models not (yet) directly supported by DHARMa. Yamaguchi, T., &amp; Kazahari, N. (2022). Fission–fusion dynamics in a wild group of japanese macaques (macaca fuscata) on kinkazan island caused by the repeated separation of an alpha male being followed by females. Primates, 63(6), 575–582. 2つの群の平均の比、\\(log(\\mu_1) - log(\\mu_2) = log(\\frac{\\mu_1}{\\mu_2})\\)を推定したのちにlogを外す変換を行うためこうなるようだ。詳しくは、emmeansパッケージのviganettesを参照。type = \"none\"とすると、線形予測子の状態での差が出力されるので、\\(log(\\mu_1) - log(\\mu_2) = log(\\frac{\\mu_1}{\\mu_2})\\)の結果が出力される。↩︎ "],["14_female_presence_aggression.html", "13 群れ本体で確認された日数割合と被攻撃頻度 13.1 データの加工 13.2 モデリング", " 13 群れ本体で確認された日数割合と被攻撃頻度 第9章で 13.1 データの加工 まず2019年~2021年の交尾期について、各メスの確認日数割合、発情日数割合、平均被攻撃頻度を調査期間ごとに算出する。前章で各観察日の群れ本体における各メスの被攻撃頻度と発情の有無については算出していたので(agg_daily_each)、これをそのまま利用できる。 ## 日ごとの被攻撃頻度と発情日数割合の算出 agg_daily_each %&gt;% filter(presence == &quot;1&quot;) %&gt;% group_by(study_period, femaleID) %&gt;% summarise(mean_agg = mean(rate_agg), prop_rs = mean(rs2), sum_agg = sum(rate_agg), N = n()) -&gt; mean_agg_each ## 各個体が観察された日の群れ観察時間 no_female_over0.5 %&gt;% select(groupID, dur) %&gt;% left_join(group_all %&gt;% select(-c(TY,IT,KR,LK,KM,TG))) %&gt;% select(-(start:fin)) %&gt;% ## 縦型にする pivot_longer(Kur:Yun, names_to = &quot;femaleID&quot;, values_to = &quot;presence&quot;) %&gt;% left_join(att, by = c(&quot;femaleID&quot;, &quot;study_period&quot;)) %&gt;% ## 2019~2021の交尾期のみ filter(study_period != &quot;m18&quot; &amp; !str_detect(study_period, &quot;nm&quot;)) %&gt;% ## 6歳以上のメスのみを抽出 filter(age &gt;= 6) %&gt;% filter(presence == 1) %&gt;% group_by(study_period, femaleID) %&gt;% summarise(dur_sum = sum(dur)) %&gt;% ungroup() -&gt; dur_sum ## 確認日数割合と結合 no_female_over0.5 %&gt;% select(groupID, dur) %&gt;% left_join(group_all %&gt;% select(-c(TY,IT,KR,LK,KM,TG))) %&gt;% select(-(start:fin)) %&gt;% ## 縦型にする pivot_longer(Kur:Yun, names_to = &quot;femaleID&quot;, values_to = &quot;presence&quot;) %&gt;% left_join(att, by = c(&quot;femaleID&quot;, &quot;study_period&quot;)) %&gt;% ## 2019~2021の交尾期のみ filter(study_period != &quot;m18&quot; &amp; !str_detect(study_period, &quot;nm&quot;)) %&gt;% ## 6歳以上のメスのみを抽出 filter(age &gt;= 6) %&gt;% ## 個体追跡情報を結合 left_join(focal_summary, by = c(&quot;date&quot;, &quot;femaleID&quot;)) %&gt;% replace_na(list(dur_focal = 0)) %&gt;% group_by(study_period, femaleID) %&gt;% summarise(sum_presence = sum(presence), prop_presence = mean(presence), rank = mean(rank), age = mean(age), sum_dur = sum(dur), sum_focal = sum(dur_focal)) %&gt;% ungroup() %&gt;% ## 途中で死亡したKurは除く filter(femaleID != &quot;Kur&quot;) %&gt;% ## 攻撃頻度と発情日数割合を結合 left_join(mean_agg_each, by = c(&quot;study_period&quot;,&quot;femaleID&quot;)) %&gt;% left_join(dur_sum, by = c(&quot;study_period&quot;,&quot;femaleID&quot;)) %&gt;% mutate(prop_focal = sum_focal/dur_sum) %&gt;% group_by(study_period) %&gt;% mutate(rank_scaled = rank/max(rank)) %&gt;% ungroup() %&gt;% mutate(rs_std = standardize(prop_rs), prop_std = standardize(prop_presence), age_std = standardize(age), rank_std = standardize(rank_scaled), focal_std = standardize(prop_focal)) -&gt; female_presence_agg データは以下の通り。 datatable(female_presence_agg %&gt;% mutate(across(where(is.numeric), ~round(.x, 2)))) 13.2 モデリング モデルは以下の通り。応答変数の分布としてはガンマ分布を用いる。ガンマ分布については、 Dunn &amp; Smyth (2018) に詳しい。 \\(i\\)はデータ番号、\\(j\\)はメスIDを表す。 mean_agg: 調査期間ごとの平均被攻撃頻度(回/h) prop_presence: 確認日数割合 prop_rs: 調査期間ごとの発情日数割合 rank_scaled: 0~1に変換された順位 age: 年齢 m20: 2020年交尾期かを表すダミー変数 m21: 2021年交尾期化を表すダミー変数 \\[ \\begin{aligned} &amp; mean_agg_i \\sim Gamma(\\mu_i, \\phi) \\\\ &amp;log(\\mu_i) = \\beta_0 + \\beta_1 \\times prop\\_presence_i + \\beta_2 \\times prop\\_rs_i + \\beta_3 \\times rank\\_scaled_i + \\beta_4 \\times age_i + \\beta_5 \\times m20 + \\beta_6 \\times m21 + r_j\\\\ &amp;r_j \\sim Normal(0, \\sigma)\\\\ &amp;\\beta_{0,1,2,3,4} \\sim student_t(4,0,10)\\\\ &amp;\\sigma \\sim student\\_t(0,4,5)\\\\ &amp;\\phi \\sim student_t \\end{aligned} \\] 13.2.1 モデルの実行 Rでは以下のように実行する。 m_presence_agg &lt;- brm(data = female_presence_agg, sum_agg ~ prop_std + rs_std + age_std + rank_std + focal_std + study_period+ offset(log(N)) + (1|femaleID), family = Gamma(link = &quot;log&quot;), prior = c(prior(student_t(4,0,10),class = Intercept), prior(student_t(4,0,10), class = b), prior(student_t(4,0,5), class = sd), prior(gamma(0.01,0.01), class = shape)), iter = 11000, warmup = 1000, seed = 13, control=list(adapt_delta = 0.999, max_treedepth = 15), backend = &quot;cmdstanr&quot;, file = &quot;model/m_presence_agg&quot;) 13.2.2 モデルチェック DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。特に問題はないよう。 ## 全個体への攻撃 dh_check_brms(m_presence_agg) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない? ## 全個体への攻撃 pp_check(m_presence_agg, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) 多重共線性のチェックもお個あったが、VIFに問題はない。 check_collinearity(m_presence_agg) Rhatにも問題はなく、収束の問題はないよう。 ## 全個体への攻撃 data.frame(Rhat = brms::rhat(m_presence_agg)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) -&gt; p_rhat_female_out_an p_rhat_female_out_an 13.2.3 結果の確認 結果は以下の通り。太字になっている変数は95%確信区間が0をまたいでおらず、有意な影響があるといえる。 .cl-f46a1256{table-layout:auto;width:90%;}.cl-f4617a6a{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f4617a74{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f4617a7e{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f4617a7f{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f465234a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f465235e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f4653dc6{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653dda{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653ddb{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653ddc{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653de4{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653dee{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653def{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653df0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653df8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653df9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653dfa{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e02{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e0c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e16{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e17{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e18{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e20{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e2a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e2b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e34{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e3e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e3f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e48{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e52{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f4653e53{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-2.32[-2.54,-2.09]1.0025,541.47確認日数割合0.17[0.03,0.32]1.0016,089.21発情日数割合0.38[0.23,0.54]1.0016,799.93年齢-0.04[-0.18,0.13]1.0017,435.24順位-0.15[-0.29,-0.00]1.0025,610.04追跡時間割合0.28[0.14,0.41]1.0019,403.32調査期間(m20 vs m19)-1.87[-2.15,-1.59]1.0032,645.69調査期間(m21 vs m19)-1.35[-1.66,-1.04]1.0025,114.15 13.2.4 結果の図示 nd_presence_agg &lt;- tidyr::crossing(age_std = mean(female_presence_agg$age_std), rank_std = mean(female_presence_agg$rank_std), rs_std = mean(female_presence_agg$rs_std), study_period = c(&quot;m19&quot;,&quot;m20&quot;,&quot;m21&quot;), prop_presence = seq(0,1,length = 50), focal_std = mean(female_presence_agg$focal_std), N = 1) %&gt;% mutate(prop_std = (prop_presence - mean(female_presence_agg$prop_presence))/sd(female_presence_agg$prop_presence)) fitted(m_presence_agg, newdata = nd_presence_agg, re_formula = NA) %&gt;% bind_cols(nd_presence_agg) %&gt;% data.frame() %&gt;% ggplot(aes(x = prop_presence))+ geom_point(data = female_presence_agg, aes(y = mean_agg), alpha = 0.5, size = 3)+ facet_rep_wrap(~study_period, scales = &quot;free&quot;)+ coord_cartesian(xlim = c(0.4,1))+ geom_line(aes(y = Estimate))+ geom_ribbon(aes(y = Estimate, ymin = Q2.5, ymax = Q97.5), alpha = 0.2)+ labs(x = &quot;Proportion of confirmed days&quot;, y = &quot;Mean frequency of \\ndaily aggression&quot;)+ theme_bw(base_size = 15)+ theme(axis.title.y = element_text(family = &quot;Yu Gothic&quot;), axis.title.x = element_text(family = &quot;Arial&quot;, size = 15), axis.text.x = element_text(family = &quot;Arial&quot;), axis.text.y = element_text(family = &quot;Arial&quot;), aspect.ratio = 1, strip.background = element_blank(), strip.text = element_text(family = &quot;Arial&quot;, hjust = 0)) -&gt; p_presence_agg p_presence_agg # ggsave(&quot;figures/p_presence_agg.png&quot;,p_presence_agg, dpi = 600, units = &quot;mm&quot;, # width = 240, height = 100) References Dunn, P. K., &amp; Smyth, G. K. (2018). Generalized linear models with examples in R. Springer New York. Gabry, J., &amp; Mahr, T. (2022). Bayesplot: Plotting for bayesian models. https://mc-stan.org/bayesplot Hartig, F. (2022). DHARMa: Residual diagnostics for hierarchical (multi-level / mixed) regression models. https://CRAN.R-project.org/package=DHARMa Rodríguez-Sánchez, F. (2023). DHARMa.helpers: Helper functions to check models not (yet) directly supported by DHARMa. "],["15_aggression_injury.html", "14 オスの攻撃と怪我の関連 14.1 データの加工 14.2 分析", " 14 オスの攻撃と怪我の関連 本章では、オスから受けた攻撃の頻度と怪我の有無の関連について検討する。 14.1 データの加工 まず怪我のデータを読み込み、その他のデータと結合する。 ## 怪我データの読み込み injury18 &lt;- read_excel(&quot;../Data/data/2018mating/2018mating_raw.xlsx&quot;, sheet = &quot;injury&quot;) injury19 &lt;- read_excel(&quot;../Data/data/2019mating/2019mating_raw.xlsx&quot;, sheet = &quot;injury&quot;) injury20 &lt;- read_excel(&quot;../Data/data/2020mating/2020mating_raw.xlsx&quot;,sheet = &quot;injury&quot;) injury21 &lt;- read_excel(&quot;../Data/data/2021mating/2021mating_raw.xlsx&quot;,sheet = &quot;injury&quot;) injury_all &lt;- bind_rows(injury18,injury19,injury20,injury21) %&gt;% pivot_longer(Kur:Har, names_to = &quot;femaleID&quot;, values_to = &quot;injury&quot;) %&gt;% mutate(injury01 = ifelse(injury &gt;= 1, 1, 0)) %&gt;% mutate(date = as_date(date)) ## データを結合 injury_final &lt;- agg_rate_each %&gt;% filter(presence == &quot;1&quot;) %&gt;% filter(age &gt;= 6) %&gt;% left_join(injury_all, by = c(&quot;date&quot;, &quot;femaleID&quot;)) %&gt;% left_join(female_all %&gt;% select(date, femaleID, rs2), by = c(&quot;date&quot;, &quot;femaleID&quot;)) %&gt;% drop_na(injury01, rs2) %&gt;% mutate(rate_agg_std = standardize(rate_agg)) 14.2 分析 14.2.1 モデリング それでは、モデリングを行う。モデルの詳細は以下のとおりである。 事前分布には弱情報事前分布を用いた。 分布: ベルヌーイ分布 リンク関数: ロジット関数 応答変数: 怪我が確認されたか否か(injury01) 説明変数: オスからの攻撃頻度(rate_agg)、メスの発情の有無(rs2)、調査期間(study_period) ランダム切片: メスID(femaleID) m_agginj &lt;- brm(injury01 ~ rate_agg_std*rs2 + study_period + (1|femaleID), family = bernoulli, iter = 11000, warmup = 6000, seed = 13, prior = c(prior(student_t(4,0,10), class = &quot;b&quot;), prior(student_t(4,0,10), class = &quot;Intercept&quot;), prior(student_t(4,0,5), class = &quot;sd&quot;)), control=list(adapt_delta = 0.9999, max_treedepth = 20), backend = &quot;cmdstanr&quot;, data = injury_final, file = &quot;model/m_agginj.rds&quot;) 14.2.2 モデルチェック DHARMaパッケージ(Hartig, 2022)とDHARMa.helperパッケージ(Rodríguez-Sánchez, 2023)でモデルの前提が満たされているかを確認する。特に問題はないよう。 ## 全個体への攻撃 dh_check_brms(m_agginj) bayesplotパッケージ(Gabry &amp; Mahr, 2022)のpp_check関数で、事後分布からの予測分布と実測値の分布を比較しても大きな乖離はない? ## 全個体への攻撃 pp_check(m_agginj, ndraws = 100)+ theme_bw()+ theme(aspect.ratio = 0.9) 多重共線性のチェックもお個あったが、VIFに問題はない。 check_collinearity(m_agginj) Rhatにも問題はなく、収束の問題はないよう。 ## 全個体への攻撃 data.frame(Rhat = brms::rhat(m_agginj)) %&gt;% ggplot(aes(x = Rhat))+ geom_histogram(fill = &quot;white&quot;, color = &quot;black&quot;)+ theme_bw()+ theme(aspect.ratio = 1) -&gt; p_rhat_agginj p_rhat_agginj 14.2.3 結果の確認 結果は以下の通り。太字になっている変数は95%確信区間が0をまたいでおらず、有意な影響があるといえる。 .cl-f88369a0{table-layout:auto;width:90%;}.cl-f87c4d28{font-family:'Segoe UI';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f87c4d32{font-family:'Yu Gothic';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f87c4d33{font-family:'Segoe UI';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f87c4d3c{font-family:'Yu Gothic';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f87f27aa{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f87f27b4{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f87f3934{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f3935{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f393e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f393f{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f3948{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f3952{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f395c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f395d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f3966{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f3967{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f3970{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f3971{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f3972{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f397a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f397b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f3984{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f398e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f3998{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f39a2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f39ac{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f39ad{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f39b6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f39b7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f39c0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f39c1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f39ca{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f39cb{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f39d4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f39d5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f87f39d6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Explanatory variablesMedian95%CIRhatESS切片-3.12[-3.55,-2.72]1.009,232.10被攻撃頻度0.31[0.10,0.50]1.0013,090.27発情の有無(vs 無)1.26[0.91,1.60]1.0019,855.67被攻撃頻度× 発情の有無(vs 無)-0.10[-0.32,0.13]1.0012,949.76調査期間(m19 vs m18)0.12[-0.32,0.55]1.0015,885.44調査期間(m20 vs m18)-0.47[-0.95,0.00]1.0017,082.59調査期間(m21 vs m18)-0.13[-0.51,0.25]1.0015,535.94 交互作用項について検討する。非発情メス、発情メスのいずれについても被攻撃頻度は怪我をする確率と関連しているよう。 estimate_slopes(m_agginj, trend = &quot;rate_agg_std&quot;, at = &quot;rs2 = c(0,1)&quot;) 14.2.4 結果の図示 nd_agginj &lt;- tidyr::crossing(rate_agg = seq(0, 2, length.out =100), study_period = c(&quot;m18&quot;,&quot;m19&quot;,&quot;m20&quot;,&quot;m21&quot;), rs2 = c(0,1)) %&gt;% mutate(rate_agg_std = (rate_agg - mean(injury_final$rate_agg))/sd(injury_final$rate_agg)) fit_agginj &lt;- fitted(m_agginj, newdata = nd_agginj, re_formula = NA) %&gt;% data.frame() %&gt;% bind_cols(nd_agginj) injury_final %&gt;% ggplot(aes(x = rate_agg, y = injury01, color = study_period))+ geom_point(shape = &quot;|&quot;, size = 3)+ geom_line(data = fit_agginj, aes(y = Estimate, linetype = as.factor(rs2)), linewidth = 0.7)+ theme_bw(base_size = 14)+ scale_y_continuous(breaks = seq(0,1,by = 0.2)) + labs(x = &quot;オスからの攻撃頻度&quot;, y = &quot;新\\nた\\nに\\n怪\\n我\\nを\\nす\\nる\\n確\\n率&quot;, color = &quot;調査期間&quot;, linetype = &quot;発情の有無&quot;) + scale_color_nejm()+ theme(axis.title.y = element_text(angle = 0, vjust = 0.5, family = &quot;Yu Gothic&quot;), axis.title.x = element_text(family = &quot;Yu Gorhic&quot;), axis.text = element_text(family = &quot;Arial&quot;, size = 13), legend.title = element_text(family = &quot;Yu Gothic&quot;), aspect.ratio = 1) -&gt; p_agginj_all p_agginj_all ggsave(&quot;figures/p_agginj_all.png&quot;, p_agginj_all, width = 120, height = 100, units = &quot;mm&quot;, dpi = 600) References Gabry, J., &amp; Mahr, T. (2022). Bayesplot: Plotting for bayesian models. https://mc-stan.org/bayesplot Hartig, F. (2022). DHARMa: Residual diagnostics for hierarchical (multi-level / mixed) regression models. https://CRAN.R-project.org/package=DHARMa Rodríguez-Sánchez, F. (2023). DHARMa.helpers: Helper functions to check models not (yet) directly supported by DHARMa. "],["sessioninfo.html", "実行環境", " 実行環境 sessionInfo() ## R version 4.2.2 (2022-10-31 ucrt) ## Platform: x86_64-w64-mingw32/x64 (64-bit) ## Running under: Windows 10 x64 (build 22621) ## ## Matrix products: default ## ## locale: ## [1] LC_COLLATE=Japanese_Japan.utf8 LC_CTYPE=Japanese_Japan.utf8 ## [3] LC_MONETARY=Japanese_Japan.utf8 LC_NUMERIC=C ## [5] LC_TIME=Japanese_Japan.utf8 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] fontregisterer_0.3 systemfonts_1.0.4 ## [3] extrafont_0.18 ggsignif_0.6.4 ## [5] lemon_0.4.6 ggsci_2.9 ## [7] kableExtra_1.3.4 patchwork_1.1.2 ## [9] ggrepel_0.9.2 flextable_0.9.1 ## [11] GGally_2.1.2 ggnewscale_0.4.9 ## [13] viridis_0.6.4 viridisLite_0.4.2 ## [15] bayesplot_1.10.0 plotly_4.10.1 ## [17] ggbeeswarm_0.7.2 ggforce_0.4.1 ## [19] ggraph_2.1.0 tidygraph_1.2.2 ## [21] igraph_1.3.5 vegan_2.6-4 ## [23] lattice_0.20-45 permute_0.9-7 ## [25] aninet_0.2.0.0 asnipe_1.1.16 ## [27] ANTs_0.0.16 sna_2.7 ## [29] network_1.18.0 statnet.common_4.7.0 ## [31] DHARMa.helpers_0.0.0.9000 DHARMa_0.4.6 ## [33] ggeffects_1.1.4 cmdstanr_0.6.1 ## [35] rstanarm_2.26.1 rstan_2.32.3 ## [37] StanHeaders_2.26.28 brms_2.20.5 ## [39] Rcpp_1.0.11 scales_1.2.1 ## [41] DT_0.30 see_0.7.5.5 ## [43] report_0.5.7.4 parameters_0.20.3 ## [45] performance_0.10.3 modelbased_0.8.6.3 ## [47] insight_0.19.1.4 effectsize_0.8.3.6 ## [49] datawizard_0.7.1.1 correlation_0.8.4 ## [51] bayestestR_0.13.1 easystats_0.6.0.8 ## [53] knitr_1.45 readxl_1.4.3 ## [55] lubridate_1.9.2 forcats_1.0.0 ## [57] stringr_1.5.0 dplyr_1.1.2 ## [59] purrr_1.0.2 readr_2.1.4 ## [61] tidyr_1.3.0 tibble_3.2.1 ## [63] ggplot2_3.4.4 tidyverse_2.0.0 ## ## loaded via a namespace (and not attached): ## [1] estimability_1.4.1 coda_0.19-4 ragg_1.2.5 ## [4] dygraphs_1.1.1.6 multcomp_1.4-25 data.table_1.14.6 ## [7] inline_0.3.19 doParallel_1.0.17 generics_0.1.3 ## [10] callr_3.7.3 TH.data_1.1-2 tzdb_0.3.0 ## [13] webshot_0.5.5 xml2_1.3.5 httpuv_1.6.7 ## [16] xfun_0.39 hms_1.1.3 jquerylib_0.1.4 ## [19] evaluate_0.23 promises_1.2.0.1 fansi_1.0.3 ## [22] htmlwidgets_1.6.2 reshape_0.8.9 tensorA_0.36.2 ## [25] stats4_4.2.2 ellipsis_0.3.2 crosstalk_1.2.0 ## [28] backports_1.4.1 fontLiberation_0.1.0 V8_4.2.2 ## [31] bookdown_0.35 markdown_1.11 RcppParallel_5.1.6 ## [34] fontBitstreamVera_0.1.1 vctrs_0.6.3 abind_1.4-5 ## [37] cachem_1.0.8 withr_2.5.2 checkmate_2.1.0 ## [40] emmeans_1.8.8 xts_0.12.2 prettyunits_1.2.0 ## [43] svglite_2.1.1 cluster_2.1.4 lazyeval_0.2.2 ## [46] crayon_1.5.2 crul_1.4.0 pkgconfig_2.0.3 ## [49] labeling_0.4.3 tweenr_2.0.2 nlme_3.1-160 ## [52] vipor_0.4.5 rlang_1.1.1 lifecycle_1.0.4 ## [55] miniUI_0.1.1.1 colourpicker_1.3.0 sandwich_3.0-2 ## [58] fontquiver_0.2.1 httpcode_0.3.0 extrafontdb_1.0 ## [61] Kendall_2.2.1 cellranger_1.1.0 distributional_0.3.2 ## [64] polyclip_1.10-4 matrixStats_0.63.0 Matrix_1.6-1 ## [67] loo_2.6.0 boot_1.3-28 zoo_1.8-11 ## [70] base64enc_0.1-3 beeswarm_0.4.0 processx_3.8.0 ## [73] gap.datasets_0.0.6 splines2_0.5.1 shinystan_2.6.0 ## [76] magrittr_2.0.3 plyr_1.8.8 threejs_0.3.3 ## [79] compiler_4.2.2 rstantools_2.3.1.1 RColorBrewer_1.1-3 ## [82] lme4_1.1-34 cli_3.6.1 ps_1.7.2 ## [85] Brobdingnag_1.2-9 MASS_7.3-58.1 mgcv_1.8-41 ## [88] tidyselect_1.2.0 stringi_1.7.12 textshaping_0.3.6 ## [91] highr_0.10 yaml_2.3.7 askpass_1.2.0 ## [94] bridgesampling_1.1-2 grid_4.2.2 sass_0.4.7 ## [97] tools_4.2.2 timechange_0.1.1 parallel_4.2.2 ## [100] rstudioapi_0.15.0 uuid_1.1-0 foreach_1.5.2 ## [103] gridExtra_2.3 posterior_1.5.0 farver_2.1.1 ## [106] digest_0.6.31 shiny_1.7.5.1 qgam_1.3.4 ## [109] gfonts_0.2.0 later_1.3.0 httr_1.4.7 ## [112] gdtools_0.3.3 QuickJSR_1.0.5 Rdpack_2.5 ## [115] colorspace_2.0-3 rvest_1.0.3 splines_4.2.2 ## [118] graphlayouts_1.0.0 shinythemes_1.2.0 xtable_1.8-4 ## [121] jsonlite_1.8.4 nloptr_2.0.3 gap_1.5-3 ## [124] R6_2.5.1 pillar_1.9.0 htmltools_0.5.4 ## [127] mime_0.12 glue_1.6.2 fastmap_1.1.1 ## [130] minqa_1.2.5 codetools_0.2-18 pkgbuild_1.4.2 ## [133] mvtnorm_1.2-3 utf8_1.2.2 bslib_0.5.1 ## [136] curl_4.3.3 gtools_3.9.4 officer_0.6.2 ## [139] zip_2.2.2 shinyjs_2.1.0 openssl_2.0.5 ## [142] Rttf2pt1_1.3.12 survival_3.5-5 rmarkdown_2.25 ## [145] munsell_0.5.0 iterators_1.0.14 reshape2_1.4.4 ## [148] gtable_0.3.4 rbibutils_2.2.15 References Aguilar-Melo, A. R., Calmé, S., Pinacho-Guendulain, B., Smith-Aguilar, S. E., &amp; Ramos-Fernández, G. (2020). Ecological and social determinants of association and proximity patterns in the fission-fusion society of spider monkeys (ateles geoffroyi). Am. J. Primatol., 82(1), e23077. Aguilar-Melo, A. R., Calmé, S., Smith-Aguilar, S. E., &amp; Ramos-Fernandez, G. (2018). Fission-fusion dynamics as a temporally and spatially flexible behavioral strategy in spider monkeys. Behav. Ecol. Sociobiol., 72(9). Allison, P. D. (2014). Event history and survival analysis: Regression for longitudinal event data. SAGE Publications. Anderson, D. P., Nordheim, E. V., Boesch, C., &amp; Moermond, T. C. (2002). Factors influencing fission–fusion grouping in chimpanzees in the taı̈ national park, côte d’ivoire. In Behavioural diversity in chimpanzees and bonobos (pp. 90–101). Cambridge University Press. Asensio, N., Korstjens, A. H., &amp; Aureli, F. (2009). Fissioning minimizes ranging costs in spider monkeys: A multiple-level approach. Behav. Ecol. Sociobiol., 63(5), 649–659. Aureli, F., Schaffner, C. M., Boesch, C., Bearder, S. K., Call, J., Chapman, C. A., Connor, R., Fiore, A. D., Dunbar, R. I. M., Henzi, S. P., &amp; Others. (2008). Fission-fusion dynamics: New research frameworks. Curr. Anthropol., 49(4), 627–654. Bowler, M., &amp; Bodmer, R. (2009). Social behavior in fission-fusion groups of red uakari monkeys (cacajao calvus ucayalii). Am. J. Primatol., 71(12), 976–987. Busia, L., Schaffner, C. M., &amp; Aureli, F. (2017). Relationship quality affects fission decisions in wild spider monkeys (ateles geoffroyi). Ethology, 123(6-7), 405–411. Busia, L., Schaffner, C. M., Rothman, J. M., Aureli, F., &amp; Setchell, J. M. (2016). Do fruit nutrients affect subgrouping patterns in wild spider monkeys (ateles geoffroyi)? Int. J. Primatol., 37, 738–751. Chang, W. (2018). R graphics cookbook: Practical recipes for visualizing data. “O’Reilly Media, Inc.” Chapman, C. A., Chapman, L. J., &amp; Wrangham, R. W. (1995). Ecological constraints on group size: An analysis of spider monkey and chimpanzee subgroups. Behav. Ecol. Sociobiol., 36(1), 59–70. Chapman, C. A., White, F. J., &amp; Wrangham, R. W. (1993). Defining subgroup size in fission-fusion societies. Folia Primatol., 61(1), 31–34. Coles, R. C., Lee, P. C., &amp; Talebi, M. (2012). Fission–Fusion dynamics in southern muriquis (brachyteles arachnoides) in continuous brazilian atlantic forest. Int. J. Primatol., 33(1), 93–114. Dekker, D., Krackhardt, D., &amp; Snijders, T. A. B. (2007). Sensitivity of MRQAP tests to collinearity and autocorrelation conditions. Psychometrika, 72(4), 563–581. Dolado, R., Cooke, C., &amp; Beltran, F. S. (2016). How many for lunch today? Seasonal Fission-Fusion dynamics as a feeding strategy in wild Red-Capped mangabeys (cercocebus torquatus). Folia Primatol., 87(3), 197–212. Dunn, P. K., &amp; Smyth, G. K. (2018). Generalized linear models with examples in R. Springer New York. Gabry, J., Češnovar, R., &amp; Johnson, A. (2023). Cmdstanr: R interface to ’CmdStan’. Gabry, J., &amp; Mahr, T. (2022). Bayesplot: Plotting for bayesian models. https://mc-stan.org/bayesplot Hartig, F. (2022). DHARMa: Residual diagnostics for hierarchical (multi-level / mixed) regression models. https://CRAN.R-project.org/package=DHARMa Hartwell, K. S., Notman, H., Kalbitzer, U., Chapman, C. A., &amp; Pavelka, M. M. S. M. (2021). Fruit availability has a complex relationship with fission-fusion dynamics in spider monkeys. Primates, 62(1), 165–175. Hashimoto, C., Furuichi, T., &amp; Tashiro, Y. (2001). What factors affect the size of chimpanzee parties in the kalinzu forest, uganda? Examination of fruit abundance and number of estrous females. Int. J. Primatol., 22(6), 947–959. Hashimoto, C., Suzuki, S., Takenoshita, Y., Yamagiwa, J., Basabose, A. K., &amp; Furuichi, T. (2003). How fruit abundance affects the chimpanzee party size: A comparison between four study sites. Primates, 44(2), 77–81. Holmes, S. M., Gordon, A. D., Louis, E. E., &amp; Johnson, S. E. (2016). Fission-fusion dynamics in black-and-white ruffed lemurs may facilitate both feeding strategies and communal care of infants in a spatially and temporally variable environment. Behav. Ecol. Sociobiol., 70(11), 1949–1960. Itoh, N., &amp; Nishida, T. (2007). Chimpanzee grouping patterns and food availability in mahale mountains national park, tanzania. Primates, 48(2), 87–96. Koda, H., Shimooka, Y., &amp; Sugiura, H. (2008). Effects of caller activity and habitat visibility on contact call rate of wild japanese macaques (macaca fuscata). Am. J. Primatol., 70(11), 1055–1063. Matsumoto-Oda, A., Hosaka, K., Huffman, M. A., &amp; Kawanaka, K. (1998). Factors affecting party size in chimpanzees of the mahale mountains. Int. J. Primatol., 19(6), 999–1011. Matsuura, K. (2023). Bayesian statistical modeling with stan, r, and python. Springer Nature. Matthews, J. K., Ridley, A., Kaplin, B. A., &amp; Grueter, C. C. (2021). Ecological and reproductive drivers of fission-fusion dynamics in chimpanzees (pan troglodytes schweinfurthii) inhabiting a montane forest. Behav. Ecol. Sociobiol., 75(1), 23. Mitani, J. C., Watts, D. P., &amp; Lwanga, J. S. (2002). Ecological and social correlates of chimpanzee party size and composition. In Behavioural diversity in chimpanzees and bonobos (pp. 102–111). Cambridge University Press. Newton-Fisher, N. E., Reynolds, V., &amp; Plumptre, A. J. (2000). Food supply and chimpanzee (pan troglodytes schweinfurthii) party size in the budongo forest reserve, uganda. Int. J. Primatol. Nishikawa, M., Suzuki, M., &amp; Sprague, D. S. (2014). Activity and social factors affect cohesion among individuals in female japanese macaques: A simultaneous focal-follow study: Cohesion among individuals inM. fuscata. Am. J. Primatol., 76(7), 694–703. Pinacho-Guendulain, B., &amp; Ramos-Fernández, G. (2017). Influence of fruit availability on the fission–fusion dynamics of spider monkeys (ateles geoffroyi). Int. J. Primatol., 38(3), 466–484. Potts, K. B., Watts, D. P., &amp; Wrangham, R. W. (2011). Comparative feeding ecology of two communities of chimpanzees (pan troglodytes) in kibale national park, uganda. Int. J. Primatol., 32(3), 669–690. Ramos-Fernández, G., &amp; Morales, J. M. (2014). Unraveling fission-fusion dynamics: How subgroup properties and dyadic interactions influence individual decisions. Behav. Ecol. Sociobiol., 68(8), 1225–1235. Reynolds, V. (2005). The chimpanzees of the budongo forest: Ecology, behaviour and conservation. OUP Oxford. Rodríguez-Sánchez, F. (2023). DHARMa.helpers: Helper functions to check models not (yet) directly supported by DHARMa. Shibata, S., Furuichi, T., &amp; Hashimoto, C. (2022). Adaptive party choice of Low-Ranking males in Fission–Fusion dynamics of chimpanzees in kalinzu forest reserve, uganda. Animals, 12(17), 2240. Sugiura, H., Shimooka, Y., &amp; Tsuji, Y. (2011). Variation in spatial cohesiveness in a group of japanese macaques (macaca fuscata). Int. J. Primatol., 32(6), 1348–1366. Villioth, J., Zuberbühler, K., &amp; Newton-Fisher, N. E. (2022). Patch choice decisions by a fission–fusion forager as a test of the ecological constraints model. Behav. Ecol. Sociobiol., 76(12), 156. Wakefield, M. L. (2008). Grouping patterns and competition among female pan troglodytes schweinfurthii at ngogo, kibale national park, uganda. Int. J. Primatol., 29(4), 907–929. Weiss, M., &amp; Hart, J. (2023). Aninet: Statistical models for animal social networks. Wickham, H., &amp; Grolemund, G. (2016). R for data science: Import, tidy, transform, visualize, and model data. “O’Reilly Media, Inc.” Wittiger, L., &amp; Boesch, C. (2013). Female gregariousness in western chimpanzees (pan troglodytes verus) is influenced by resource aggregation and the number of females in estrus. Behav. Ecol. Sociobiol., 67(7), 1097–1111. Yamaguchi, T., &amp; Kazahari, N. (2022). Fission–fusion dynamics in a wild group of japanese macaques (macaca fuscata) on kinkazan island caused by the repeated separation of an alpha male being followed by females. Primates, 63(6), 575–582. 山口飛翔. (2020). 金華山の野生ニホンザル・交尾期における第一位オスの特異な行動. 宮城県のニホンザル, 34, 1–25. 山口飛翔. (2022). 金華山のサル・2020 年交尾期における B₁ 群中心オスの動向. 宮城県のニホンザル, 35, 1–12. 山口飛翔. (2023a). 金華山のサル・B₁ 群の第一位オス 「タイヨウ」 の略歴. 宮城県のニホンザル, 36, 1–5. 山口飛翔. (2023b). 金華山のサル・d 群に 2 日間以上追随した B₁ 群の特異な集団. 宮城県のニホンザル, 36, 6–13. 松村優哉., 湯谷啓明., 紀ノ定保礼., &amp; 前田和. (2021). RユーザのためのRstudio[実践]入門 tidyverseによるモダンな分析フローの世界 改訂2版. 技術評論社. 馬場真哉. (2019). R と stan ではじめるベイズ統計モデリングによるデータ分析入門. 講談社. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
